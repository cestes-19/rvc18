### Donut plot of RVC and CREMP Data

## wd may be off added "Donut" folder (FYI next run)

setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC")
extrafont::loadfonts(device="pdf")
extrafont::loadfonts(device="postscript")


library(ggplot2)
library(tidyverse)
library(vegan)
library(dygraphs)
library(rio)
library(RColorBrewer)
library(ggplot2)
library(ggpubr)
library(hrbrthemes)
library(tibble)

### All data
RVC_CREMP <- read_csv("CREMP_RVC_REEF.csv")






setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/MK")

### Data per reef for MK

### Alligator Deep

Alligator_deep <- filter(RVC_CREMP, sitename == "Alligator Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Alligator_deep_fish <- Alligator_deep$sum/max(Alligator_deep$sum)
Alligator_deep_biomass <- data.frame(Alligator_deep_fish)

Alligator_deep_biomass <- 100*Alligator_deep_biomass


Alligator_deep_Stony <- Alligator_deep$Stony_coral/max(Alligator_deep$Stony_coral)
Alligator_deep_coral <- data.frame(Alligator_deep_Stony)

Alligator_deep_stony_coral <- 100*Alligator_deep_coral

Alligator_deep_macro <- Alligator_deep$Macroalgae/max(Alligator_deep$Macroalgae)
Alligator_deep_algae <- data.frame(Alligator_deep_macro)


Alligator_deep_macroalgae <- (100*Alligator_deep_algae)


Alligator_deep_plot <- cbind(Alligator_deep_macroalgae,Alligator_deep_biomass,Alligator_deep_stony_coral)

Alligator_deep_plot$Year <- c("1999","2000","2001","2002","2003","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Alligator_deep_1999 <- filter(Alligator_deep_plot, Year == 1999)
Alligator_deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_1999_t <- t(Alligator_deep_1999)

Alligator_deep_1999_donut <- data.frame(Alligator_deep_1999_t)
colnames(Alligator_deep_1999_donut) <- c("Value")
Alligator_deep_1999_donut <- Alligator_deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_1999_donut,"Alligator_deep_1999.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_1999_donut_plot <- read.table("Alligator_deep_1999.csv", header=TRUE, sep=",")


Alligator_deep_1999_donut_plot_rounded <- Alligator_deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_1999_donut_plot_test <- cbind(Alligator_deep_1999_donut_plot_rounded,Legend)


Alligator_deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_Deep_1999.png", width = 6, height = 6)



### Alligator Deep


Alligator_deep_2000 <- filter(Alligator_deep_plot, Year == 2000)
Alligator_deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2000_t <- t(Alligator_deep_2000)

Alligator_deep_2000_donut <- data.frame(Alligator_deep_2000_t)
colnames(Alligator_deep_2000_donut) <- c("Value")
Alligator_deep_2000_donut <- Alligator_deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2000_donut,"Alligator_deep_2000.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2000_donut_plot <- read.table("Alligator_deep_2000.csv", header=TRUE, sep=",")


Alligator_deep_2000_donut_plot_rounded <- Alligator_deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2000_donut_plot_test <- cbind(Alligator_deep_2000_donut_plot_rounded,Legend)


Alligator_deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2000.png", width = 6, height = 6)




Alligator_deep_2001 <- filter(Alligator_deep_plot, Year == 2001)
Alligator_deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2001_t <- t(Alligator_deep_2001)

Alligator_deep_2001_donut <- data.frame(Alligator_deep_2001_t)
colnames(Alligator_deep_2001_donut) <- c("Value")
Alligator_deep_2001_donut <- Alligator_deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2001_donut,"Alligator_deep_2001.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2001_donut_plot <- read.table("Alligator_deep_2001.csv", header=TRUE, sep=",")


Alligator_deep_2001_donut_plot_rounded <- Alligator_deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2001_donut_plot_test <- cbind(Alligator_deep_2001_donut_plot_rounded,Legend)


Alligator_deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2001.png", width = 6, height = 6)





Alligator_deep_2002 <- filter(Alligator_deep_plot, Year == 2002)
Alligator_deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2002_t <- t(Alligator_deep_2002)

Alligator_deep_2002_donut <- data.frame(Alligator_deep_2002_t)
colnames(Alligator_deep_2002_donut) <- c("Value")
Alligator_deep_2002_donut <- Alligator_deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2002_donut,"Alligator_deep_2002.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2002_donut_plot <- read.table("Alligator_deep_2002.csv", header=TRUE, sep=",")


Alligator_deep_2002_donut_plot_rounded <- Alligator_deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2002_donut_plot_test <- cbind(Alligator_deep_2002_donut_plot_rounded,Legend)


Alligator_deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2002.png", width = 6, height = 6)



Alligator_deep_2003 <- filter(Alligator_deep_plot, Year == 2003)
Alligator_deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2003_t <- t(Alligator_deep_2003)

Alligator_deep_2003_donut <- data.frame(Alligator_deep_2003_t)
colnames(Alligator_deep_2003_donut) <- c("Value")
Alligator_deep_2003_donut <- Alligator_deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2003_donut,"Alligator_deep_2003.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2003_donut_plot <- read.table("Alligator_deep_2003.csv", header=TRUE, sep=",")


Alligator_deep_2003_donut_plot_rounded <- Alligator_deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2003_donut_plot_test <- cbind(Alligator_deep_2003_donut_plot_rounded,Legend)


Alligator_deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2003.png", width = 6, height = 6)




Alligator_deep_2004 <- filter(Alligator_deep_plot, Year == 2004)
Alligator_deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2004_t <- t(Alligator_deep_2004)

Alligator_deep_2004_donut <- data.frame(Alligator_deep_2004_t)
colnames(Alligator_deep_2004_donut) <- c("Value")
Alligator_deep_2004_donut <- Alligator_deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2004_donut,"Alligator_deep_2004.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2004_donut_plot <- read.table("Alligator_deep_2004.csv", header=TRUE, sep=",")


Alligator_deep_2004_donut_plot_rounded <- Alligator_deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2004_donut_plot_test <- cbind(Alligator_deep_2004_donut_plot_rounded,Legend)


Alligator_deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Alligator_deep_2004.png", width = 6, height = 6)




Alligator_deep_2005 <- filter(Alligator_deep_plot, Year == 2005)
Alligator_deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2005_t <- t(Alligator_deep_2005)

Alligator_deep_2005_donut <- data.frame(Alligator_deep_2005_t)
colnames(Alligator_deep_2005_donut) <- c("Value")
Alligator_deep_2005_donut <- Alligator_deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2005_donut,"Alligator_deep_2005.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2005_donut_plot <- read.table("Alligator_deep_2005.csv", header=TRUE, sep=",")


Alligator_deep_2005_donut_plot_rounded <- Alligator_deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2005_donut_plot_test <- cbind(Alligator_deep_2005_donut_plot_rounded,Legend)


Alligator_deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2005.png", width = 6, height = 6)





Alligator_deep_2006 <- filter(Alligator_deep_plot, Year == 2006)
Alligator_deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2006_t <- t(Alligator_deep_2006)

Alligator_deep_2006_donut <- data.frame(Alligator_deep_2006_t)
colnames(Alligator_deep_2006_donut) <- c("Value")
Alligator_deep_2006_donut <- Alligator_deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2006_donut,"Alligator_deep_2006.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2006_donut_plot <- read.table("Alligator_deep_2006.csv", header=TRUE, sep=",")


Alligator_deep_2006_donut_plot_rounded <- Alligator_deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2006_donut_plot_test <- cbind(Alligator_deep_2006_donut_plot_rounded,Legend)


Alligator_deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2006.png", width = 6, height = 6)




Alligator_deep_2007 <- filter(Alligator_deep_plot, Year == 2007)
Alligator_deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2007_t <- t(Alligator_deep_2007)

Alligator_deep_2007_donut <- data.frame(Alligator_deep_2007_t)
colnames(Alligator_deep_2007_donut) <- c("Value")
Alligator_deep_2007_donut <- Alligator_deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2007_donut,"Alligator_deep_2007.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2007_donut_plot <- read.table("Alligator_deep_2007.csv", header=TRUE, sep=",")


Alligator_deep_2007_donut_plot_rounded <- Alligator_deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2007_donut_plot_test <- cbind(Alligator_deep_2007_donut_plot_rounded,Legend)


Alligator_deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2007.png", width = 6, height = 6)




Alligator_deep_2008 <- filter(Alligator_deep_plot, Year == 2008)
Alligator_deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2008_t <- t(Alligator_deep_2008)

Alligator_deep_2008_donut <- data.frame(Alligator_deep_2008_t)
colnames(Alligator_deep_2008_donut) <- c("Value")
Alligator_deep_2008_donut <- Alligator_deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2008_donut,"Alligator_deep_2008.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2008_donut_plot <- read.table("Alligator_deep_2008.csv", header=TRUE, sep=",")


Alligator_deep_2008_donut_plot_rounded <- Alligator_deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2008_donut_plot_test <- cbind(Alligator_deep_2008_donut_plot_rounded,Legend)


Alligator_deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2008.png", width = 6, height = 6)




Alligator_deep_2009 <- filter(Alligator_deep_plot, Year == 2009)
Alligator_deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2009_t <- t(Alligator_deep_2009)

Alligator_deep_2009_donut <- data.frame(Alligator_deep_2009_t)
colnames(Alligator_deep_2009_donut) <- c("Value")
Alligator_deep_2009_donut <- Alligator_deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2009_donut,"Alligator_deep_2009.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2009_donut_plot <- read.table("Alligator_deep_2009.csv", header=TRUE, sep=",")


Alligator_deep_2009_donut_plot_rounded <- Alligator_deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2009_donut_plot_test <- cbind(Alligator_deep_2009_donut_plot_rounded,Legend)


Alligator_deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2009.png", width = 6, height = 6)




Alligator_deep_2010 <- filter(Alligator_deep_plot, Year == 2010)
Alligator_deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2010_t <- t(Alligator_deep_2010)

Alligator_deep_2010_donut <- data.frame(Alligator_deep_2010_t)
colnames(Alligator_deep_2010_donut) <- c("Value")
Alligator_deep_2010_donut <- Alligator_deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2010_donut,"Alligator_deep_2010.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2010_donut_plot <- read.table("Alligator_deep_2010.csv", header=TRUE, sep=",")


Alligator_deep_2010_donut_plot_rounded <- Alligator_deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2010_donut_plot_test <- cbind(Alligator_deep_2010_donut_plot_rounded,Legend)


Alligator_deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Alligator_deep_2010.png", width = 6, height = 6)




Alligator_deep_2011 <- filter(Alligator_deep_plot, Year == 2011)
Alligator_deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2011_t <- t(Alligator_deep_2011)

Alligator_deep_2011_donut <- data.frame(Alligator_deep_2011_t)
colnames(Alligator_deep_2011_donut) <- c("Value")
Alligator_deep_2011_donut <- Alligator_deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2011_donut,"Alligator_deep_2011.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2011_donut_plot <- read.table("Alligator_deep_2011.csv", header=TRUE, sep=",")


Alligator_deep_2011_donut_plot_rounded <- Alligator_deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2011_donut_plot_test <- cbind(Alligator_deep_2011_donut_plot_rounded,Legend)


Alligator_deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2011.png", width = 6, height = 6)





Alligator_deep_2012 <- filter(Alligator_deep_plot, Year == 2012)
Alligator_deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2012_t <- t(Alligator_deep_2012)

Alligator_deep_2012_donut <- data.frame(Alligator_deep_2012_t)
colnames(Alligator_deep_2012_donut) <- c("Value")
Alligator_deep_2012_donut <- Alligator_deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2012_donut,"Alligator_deep_2012.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2012_donut_plot <- read.table("Alligator_deep_2012.csv", header=TRUE, sep=",")


Alligator_deep_2012_donut_plot_rounded <- Alligator_deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2012_donut_plot_test <- cbind(Alligator_deep_2012_donut_plot_rounded,Legend)


Alligator_deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2012.png", width = 6, height = 6)






Alligator_deep_2014 <- filter(Alligator_deep_plot, Year == 2014)
Alligator_deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2014_t <- t(Alligator_deep_2014)

Alligator_deep_2014_donut <- data.frame(Alligator_deep_2014_t)
colnames(Alligator_deep_2014_donut) <- c("Value")
Alligator_deep_2014_donut <- Alligator_deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2014_donut,"Alligator_deep_2014.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2014_donut_plot <- read.table("Alligator_deep_2014.csv", header=TRUE, sep=",")


Alligator_deep_2014_donut_plot_rounded <- Alligator_deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2014_donut_plot_test <- cbind(Alligator_deep_2014_donut_plot_rounded,Legend)


Alligator_deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2014.png", width = 6, height = 6)





Alligator_deep_2016 <- filter(Alligator_deep_plot, Year == 2016)
Alligator_deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2016_t <- t(Alligator_deep_2016)

Alligator_deep_2016_donut <- data.frame(Alligator_deep_2016_t)
colnames(Alligator_deep_2016_donut) <- c("Value")
Alligator_deep_2016_donut <- Alligator_deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_deep_2016_donut,"Alligator_deep_2016.csv")


### import as csv (change category and value to the two column names)

Alligator_deep_2016_donut_plot <- read.table("Alligator_deep_2016.csv", header=TRUE, sep=",")


Alligator_deep_2016_donut_plot_rounded <- Alligator_deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_deep_2016_donut_plot_test <- cbind(Alligator_deep_2016_donut_plot_rounded,Legend)


Alligator_deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_deep_2016.png", width = 6, height = 6)




### Alligator Shallow

Alligator_shallow <- filter(RVC_CREMP, sitename == "Alligator Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Alligator_shallow_fish <- Alligator_shallow$sum/max(Alligator_shallow$sum)
Alligator_shallow_biomass <- data.frame(Alligator_shallow_fish)

Alligator_shallow_biomass <- 100*Alligator_shallow_biomass


Alligator_shallow_Stony <- Alligator_shallow$Stony_coral/max(Alligator_shallow$Stony_coral)
Alligator_shallow_coral <- data.frame(Alligator_shallow_Stony)

Alligator_shallow_stony_coral <- 100*Alligator_shallow_coral

Alligator_shallow_macro <- Alligator_shallow$Macroalgae/max(Alligator_shallow$Macroalgae)
Alligator_shallow_algae <- data.frame(Alligator_shallow_macro)


Alligator_shallow_macroalgae <- (100*Alligator_shallow_algae)


Alligator_shallow_plot <- cbind(Alligator_shallow_macroalgae,Alligator_shallow_biomass,Alligator_shallow_stony_coral)

Alligator_shallow_plot$Year <- c("1999","2000","2001","2002","2003","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Alligator_shallow_1999 <- filter(Alligator_shallow_plot, Year == 1999)
Alligator_shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_1999_t <- t(Alligator_shallow_1999)

Alligator_shallow_1999_donut <- data.frame(Alligator_shallow_1999_t)
colnames(Alligator_shallow_1999_donut) <- c("Value")
Alligator_shallow_1999_donut <- Alligator_shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_1999_donut,"Alligator_shallow_1999.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_1999_donut_plot <- read.table("Alligator_shallow_1999.csv", header=TRUE, sep=",")


Alligator_shallow_1999_donut_plot_rounded <- Alligator_shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_1999_donut_plot_test <- cbind(Alligator_shallow_1999_donut_plot_rounded,Legend)


Alligator_shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_1999.png", width = 6, height = 6)



### Alligator Shallow


Alligator_shallow_2000 <- filter(Alligator_shallow_plot, Year == 2000)
Alligator_shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2000_t <- t(Alligator_shallow_2000)

Alligator_shallow_2000_donut <- data.frame(Alligator_shallow_2000_t)
colnames(Alligator_shallow_2000_donut) <- c("Value")
Alligator_shallow_2000_donut <- Alligator_shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2000_donut,"Alligator_shallow_2000.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2000_donut_plot <- read.table("Alligator_shallow_2000.csv", header=TRUE, sep=",")


Alligator_shallow_2000_donut_plot_rounded <- Alligator_shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2000_donut_plot_test <- cbind(Alligator_shallow_2000_donut_plot_rounded,Legend)


Alligator_shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2000.png", width = 6, height = 6)




Alligator_shallow_2001 <- filter(Alligator_shallow_plot, Year == 2001)
Alligator_shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2001_t <- t(Alligator_shallow_2001)

Alligator_shallow_2001_donut <- data.frame(Alligator_shallow_2001_t)
colnames(Alligator_shallow_2001_donut) <- c("Value")
Alligator_shallow_2001_donut <- Alligator_shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2001_donut,"Alligator_shallow_2001.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2001_donut_plot <- read.table("Alligator_shallow_2001.csv", header=TRUE, sep=",")


Alligator_shallow_2001_donut_plot_rounded <- Alligator_shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2001_donut_plot_test <- cbind(Alligator_shallow_2001_donut_plot_rounded,Legend)


Alligator_shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2001.png", width = 6, height = 6)





Alligator_shallow_2002 <- filter(Alligator_shallow_plot, Year == 2002)
Alligator_shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2002_t <- t(Alligator_shallow_2002)

Alligator_shallow_2002_donut <- data.frame(Alligator_shallow_2002_t)
colnames(Alligator_shallow_2002_donut) <- c("Value")
Alligator_shallow_2002_donut <- Alligator_shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2002_donut,"Alligator_shallow_2002.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2002_donut_plot <- read.table("Alligator_shallow_2002.csv", header=TRUE, sep=",")


Alligator_shallow_2002_donut_plot_rounded <- Alligator_shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2002_donut_plot_test <- cbind(Alligator_shallow_2002_donut_plot_rounded,Legend)


Alligator_shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2002.png", width = 6, height = 6)



Alligator_shallow_2003 <- filter(Alligator_shallow_plot, Year == 2003)
Alligator_shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2003_t <- t(Alligator_shallow_2003)

Alligator_shallow_2003_donut <- data.frame(Alligator_shallow_2003_t)
colnames(Alligator_shallow_2003_donut) <- c("Value")
Alligator_shallow_2003_donut <- Alligator_shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2003_donut,"Alligator_shallow_2003.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2003_donut_plot <- read.table("Alligator_shallow_2003.csv", header=TRUE, sep=",")


Alligator_shallow_2003_donut_plot_rounded <- Alligator_shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2003_donut_plot_test <- cbind(Alligator_shallow_2003_donut_plot_rounded,Legend)


Alligator_shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2003.png", width = 6, height = 6)




Alligator_shallow_2004 <- filter(Alligator_shallow_plot, Year == 2004)
Alligator_shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2004_t <- t(Alligator_shallow_2004)

Alligator_shallow_2004_donut <- data.frame(Alligator_shallow_2004_t)
colnames(Alligator_shallow_2004_donut) <- c("Value")
Alligator_shallow_2004_donut <- Alligator_shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2004_donut,"Alligator_shallow_2004.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2004_donut_plot <- read.table("Alligator_shallow_2004.csv", header=TRUE, sep=",")


Alligator_shallow_2004_donut_plot_rounded <- Alligator_shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2004_donut_plot_test <- cbind(Alligator_shallow_2004_donut_plot_rounded,Legend)


Alligator_shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Alligator_shallow_2004.png", width = 6, height = 6)




Alligator_shallow_2005 <- filter(Alligator_shallow_plot, Year == 2005)
Alligator_shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2005_t <- t(Alligator_shallow_2005)

Alligator_shallow_2005_donut <- data.frame(Alligator_shallow_2005_t)
colnames(Alligator_shallow_2005_donut) <- c("Value")
Alligator_shallow_2005_donut <- Alligator_shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2005_donut,"Alligator_shallow_2005.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2005_donut_plot <- read.table("Alligator_shallow_2005.csv", header=TRUE, sep=",")


Alligator_shallow_2005_donut_plot_rounded <- Alligator_shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2005_donut_plot_test <- cbind(Alligator_shallow_2005_donut_plot_rounded,Legend)


Alligator_shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2005.png", width = 6, height = 6)





Alligator_shallow_2006 <- filter(Alligator_shallow_plot, Year == 2006)
Alligator_shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2006_t <- t(Alligator_shallow_2006)

Alligator_shallow_2006_donut <- data.frame(Alligator_shallow_2006_t)
colnames(Alligator_shallow_2006_donut) <- c("Value")
Alligator_shallow_2006_donut <- Alligator_shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2006_donut,"Alligator_shallow_2006.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2006_donut_plot <- read.table("Alligator_shallow_2006.csv", header=TRUE, sep=",")


Alligator_shallow_2006_donut_plot_rounded <- Alligator_shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2006_donut_plot_test <- cbind(Alligator_shallow_2006_donut_plot_rounded,Legend)


Alligator_shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2006.png", width = 6, height = 6)




Alligator_shallow_2007 <- filter(Alligator_shallow_plot, Year == 2007)
Alligator_shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2007_t <- t(Alligator_shallow_2007)

Alligator_shallow_2007_donut <- data.frame(Alligator_shallow_2007_t)
colnames(Alligator_shallow_2007_donut) <- c("Value")
Alligator_shallow_2007_donut <- Alligator_shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2007_donut,"Alligator_shallow_2007.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2007_donut_plot <- read.table("Alligator_shallow_2007.csv", header=TRUE, sep=",")


Alligator_shallow_2007_donut_plot_rounded <- Alligator_shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2007_donut_plot_test <- cbind(Alligator_shallow_2007_donut_plot_rounded,Legend)


Alligator_shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2007.png", width = 6, height = 6)




Alligator_shallow_2008 <- filter(Alligator_shallow_plot, Year == 2008)
Alligator_shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2008_t <- t(Alligator_shallow_2008)

Alligator_shallow_2008_donut <- data.frame(Alligator_shallow_2008_t)
colnames(Alligator_shallow_2008_donut) <- c("Value")
Alligator_shallow_2008_donut <- Alligator_shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2008_donut,"Alligator_shallow_2008.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2008_donut_plot <- read.table("Alligator_shallow_2008.csv", header=TRUE, sep=",")


Alligator_shallow_2008_donut_plot_rounded <- Alligator_shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2008_donut_plot_test <- cbind(Alligator_shallow_2008_donut_plot_rounded,Legend)


Alligator_shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2008.png", width = 6, height = 6)




Alligator_shallow_2009 <- filter(Alligator_shallow_plot, Year == 2009)
Alligator_shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2009_t <- t(Alligator_shallow_2009)

Alligator_shallow_2009_donut <- data.frame(Alligator_shallow_2009_t)
colnames(Alligator_shallow_2009_donut) <- c("Value")
Alligator_shallow_2009_donut <- Alligator_shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2009_donut,"Alligator_shallow_2009.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2009_donut_plot <- read.table("Alligator_shallow_2009.csv", header=TRUE, sep=",")


Alligator_shallow_2009_donut_plot_rounded <- Alligator_shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2009_donut_plot_test <- cbind(Alligator_shallow_2009_donut_plot_rounded,Legend)


Alligator_shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2009.png", width = 6, height = 6)




Alligator_shallow_2010 <- filter(Alligator_shallow_plot, Year == 2010)
Alligator_shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2010_t <- t(Alligator_shallow_2010)

Alligator_shallow_2010_donut <- data.frame(Alligator_shallow_2010_t)
colnames(Alligator_shallow_2010_donut) <- c("Value")
Alligator_shallow_2010_donut <- Alligator_shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2010_donut,"Alligator_shallow_2010.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2010_donut_plot <- read.table("Alligator_shallow_2010.csv", header=TRUE, sep=",")


Alligator_shallow_2010_donut_plot_rounded <- Alligator_shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2010_donut_plot_test <- cbind(Alligator_shallow_2010_donut_plot_rounded,Legend)


Alligator_shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Alligator_shallow_2010.png", width = 6, height = 6)




Alligator_shallow_2011 <- filter(Alligator_shallow_plot, Year == 2011)
Alligator_shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2011_t <- t(Alligator_shallow_2011)

Alligator_shallow_2011_donut <- data.frame(Alligator_shallow_2011_t)
colnames(Alligator_shallow_2011_donut) <- c("Value")
Alligator_shallow_2011_donut <- Alligator_shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2011_donut,"Alligator_shallow_2011.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2011_donut_plot <- read.table("Alligator_shallow_2011.csv", header=TRUE, sep=",")


Alligator_shallow_2011_donut_plot_rounded <- Alligator_shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2011_donut_plot_test <- cbind(Alligator_shallow_2011_donut_plot_rounded,Legend)


Alligator_shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2011.png", width = 6, height = 6)





Alligator_shallow_2012 <- filter(Alligator_shallow_plot, Year == 2012)
Alligator_shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2012_t <- t(Alligator_shallow_2012)

Alligator_shallow_2012_donut <- data.frame(Alligator_shallow_2012_t)
colnames(Alligator_shallow_2012_donut) <- c("Value")
Alligator_shallow_2012_donut <- Alligator_shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2012_donut,"Alligator_shallow_2012.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2012_donut_plot <- read.table("Alligator_shallow_2012.csv", header=TRUE, sep=",")


Alligator_shallow_2012_donut_plot_rounded <- Alligator_shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2012_donut_plot_test <- cbind(Alligator_shallow_2012_donut_plot_rounded,Legend)


Alligator_shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2012.png", width = 6, height = 6)






Alligator_shallow_2014 <- filter(Alligator_shallow_plot, Year == 2014)
Alligator_shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2014_t <- t(Alligator_shallow_2014)

Alligator_shallow_2014_donut <- data.frame(Alligator_shallow_2014_t)
colnames(Alligator_shallow_2014_donut) <- c("Value")
Alligator_shallow_2014_donut <- Alligator_shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2014_donut,"Alligator_shallow_2014.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2014_donut_plot <- read.table("Alligator_shallow_2014.csv", header=TRUE, sep=",")


Alligator_shallow_2014_donut_plot_rounded <- Alligator_shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2014_donut_plot_test <- cbind(Alligator_shallow_2014_donut_plot_rounded,Legend)


Alligator_shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2014.png", width = 6, height = 6)





Alligator_shallow_2016 <- filter(Alligator_shallow_plot, Year == 2016)
Alligator_shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Alligator_shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2016_t <- t(Alligator_shallow_2016)

Alligator_shallow_2016_donut <- data.frame(Alligator_shallow_2016_t)
colnames(Alligator_shallow_2016_donut) <- c("Value")
Alligator_shallow_2016_donut <- Alligator_shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Alligator_shallow_2016_donut,"Alligator_shallow_2016.csv")


### import as csv (change category and value to the two column names)

Alligator_shallow_2016_donut_plot <- read.table("Alligator_shallow_2016.csv", header=TRUE, sep=",")


Alligator_shallow_2016_donut_plot_rounded <- Alligator_shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Alligator_shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Alligator_shallow_2016_donut_plot_test <- cbind(Alligator_shallow_2016_donut_plot_rounded,Legend)


Alligator_shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Alligator Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Alligator_shallow_2016.png", width = 6, height = 6)


#
#
#
#
#
#
#
#
# setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/MK")
#
#
#
#
# ### Dustan Rocks
#
# Dustan_rocks <- filter(RVC_CREMP, sitename == "Dustan Rocks")
#
# ## Make percentages of sum, stony coral cover, and macroalgae
#
# Dustan_rocks_fish <- Dustan_rocks$sum/max(Dustan_rocks$sum)
# Dustan_rocks_biomass <- data.frame(Dustan_rocks_fish)
#
# Dustan_rocks_biomass <- 100*Dustan_rocks_biomass
#
#
# Dustan_rocks_Stony <- Dustan_rocks$Stony_coral/max(Dustan_rocks$Stony_coral)
# Dustan_rocks_coral <- data.frame(Dustan_rocks_Stony)
#
# Dustan_rocks_stony_coral <- 100*Dustan_rocks_coral
#
# Dustan_rocks_macro <- Dustan_rocks$Macroalgae/max(Dustan_rocks$Macroalgae)
# Dustan_rocks_algae <- data.frame(Dustan_rocks_macro)
#
#
# Dustan_rocks_macroalgae <- (100*Dustan_rocks_algae)
#
#
# Dustan_rocks_plot <- cbind(Dustan_rocks_macroalgae,Dustan_rocks_biomass,Dustan_rocks_stony_coral)
#
# Dustan_rocks_plot$Year <- c("1999","2000","2001","2002","2003","2005","2006","2007","2008","2009","2011","2012","2014","2016")
#
# ### Filter per year
#
# Dustan_rocks_1999 <- filter(Dustan_rocks_plot, Year == 1999)
# Dustan_rocks_1999$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_1999_t <- t(Dustan_rocks_1999)
#
# Dustan_rocks_1999_donut <- data.frame(Dustan_rocks_1999_t)
# colnames(Dustan_rocks_1999_donut) <- c("Value")
# Dustan_rocks_1999_donut <- Dustan_rocks_1999_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_1999_donut,"Dustan_rocks_1999.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_1999_donut_plot <- read.table("Dustan_rocks_1999.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_1999_donut_plot_rounded <- Dustan_rocks_1999_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_1999_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_1999_donut_plot_test <- cbind(Dustan_rocks_1999_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_1999_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 1999") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_1999.png", width = 6, height = 6)
#
#
#
# ### Dustan Rocks
#
#
# Dustan_rocks_2000 <- filter(Dustan_rocks_plot, Year == 2000)
# Dustan_rocks_2000$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2000_t <- t(Dustan_rocks_2000)
#
# Dustan_rocks_2000_donut <- data.frame(Dustan_rocks_2000_t)
# colnames(Dustan_rocks_2000_donut) <- c("Value")
# Dustan_rocks_2000_donut <- Dustan_rocks_2000_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2000_donut,"Dustan_rocks_2000.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2000_donut_plot <- read.table("Dustan_rocks_2000.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2000_donut_plot_rounded <- Dustan_rocks_2000_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2000_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2000_donut_plot_test <- cbind(Dustan_rocks_2000_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2000_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2000") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2000.png", width = 6, height = 6)
#
#
#
#
# Dustan_rocks_2001 <- filter(Dustan_rocks_plot, Year == 2001)
# Dustan_rocks_2001$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2001_t <- t(Dustan_rocks_2001)
#
# Dustan_rocks_2001_donut <- data.frame(Dustan_rocks_2001_t)
# colnames(Dustan_rocks_2001_donut) <- c("Value")
# Dustan_rocks_2001_donut <- Dustan_rocks_2001_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2001_donut,"Dustan_rocks_2001.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2001_donut_plot <- read.table("Dustan_rocks_2001.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2001_donut_plot_rounded <- Dustan_rocks_2001_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2001_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2001_donut_plot_test <- cbind(Dustan_rocks_2001_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2001_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2001") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2001.png", width = 6, height = 6)
#
#
#
#
#
# Dustan_rocks_2002 <- filter(Dustan_rocks_plot, Year == 2002)
# Dustan_rocks_2002$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2002_t <- t(Dustan_rocks_2002)
#
# Dustan_rocks_2002_donut <- data.frame(Dustan_rocks_2002_t)
# colnames(Dustan_rocks_2002_donut) <- c("Value")
# Dustan_rocks_2002_donut <- Dustan_rocks_2002_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2002_donut,"Dustan_rocks_2002.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2002_donut_plot <- read.table("Dustan_rocks_2002.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2002_donut_plot_rounded <- Dustan_rocks_2002_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2002_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2002_donut_plot_test <- cbind(Dustan_rocks_2002_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2002_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2002") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2002.png", width = 6, height = 6)
#
#
#
# Dustan_rocks_2003 <- filter(Dustan_rocks_plot, Year == 2003)
# Dustan_rocks_2003$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2003_t <- t(Dustan_rocks_2003)
#
# Dustan_rocks_2003_donut <- data.frame(Dustan_rocks_2003_t)
# colnames(Dustan_rocks_2003_donut) <- c("Value")
# Dustan_rocks_2003_donut <- Dustan_rocks_2003_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2003_donut,"Dustan_rocks_2003.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2003_donut_plot <- read.table("Dustan_rocks_2003.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2003_donut_plot_rounded <- Dustan_rocks_2003_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2003_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2003_donut_plot_test <- cbind(Dustan_rocks_2003_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2003_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2003") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2003.png", width = 6, height = 6)
#
#
#
#
# Dustan_rocks_2004 <- filter(Dustan_rocks_plot, Year == 2004)
# Dustan_rocks_2004$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2004_t <- t(Dustan_rocks_2004)
#
# Dustan_rocks_2004_donut <- data.frame(Dustan_rocks_2004_t)
# colnames(Dustan_rocks_2004_donut) <- c("Value")
# Dustan_rocks_2004_donut <- Dustan_rocks_2004_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2004_donut,"Dustan_rocks_2004.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2004_donut_plot <- read.table("Dustan_rocks_2004.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2004_donut_plot_rounded <- Dustan_rocks_2004_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2004_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2004_donut_plot_test <- cbind(Dustan_rocks_2004_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2004_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2004") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# #ggsave ("plots/Dustan_rocks_2004.png", width = 6, height = 6)
#
#
#
#
# Dustan_rocks_2005 <- filter(Dustan_rocks_plot, Year == 2005)
# Dustan_rocks_2005$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2005_t <- t(Dustan_rocks_2005)
#
# Dustan_rocks_2005_donut <- data.frame(Dustan_rocks_2005_t)
# colnames(Dustan_rocks_2005_donut) <- c("Value")
# Dustan_rocks_2005_donut <- Dustan_rocks_2005_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2005_donut,"Dustan_rocks_2005.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2005_donut_plot <- read.table("Dustan_rocks_2005.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2005_donut_plot_rounded <- Dustan_rocks_2005_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2005_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2005_donut_plot_test <- cbind(Dustan_rocks_2005_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2005_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2005") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2005.png", width = 6, height = 6)
#
#
#
#
#
# Dustan_rocks_2006 <- filter(Dustan_rocks_plot, Year == 2006)
# Dustan_rocks_2006$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2006_t <- t(Dustan_rocks_2006)
#
# Dustan_rocks_2006_donut <- data.frame(Dustan_rocks_2006_t)
# colnames(Dustan_rocks_2006_donut) <- c("Value")
# Dustan_rocks_2006_donut <- Dustan_rocks_2006_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2006_donut,"Dustan_rocks_2006.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2006_donut_plot <- read.table("Dustan_rocks_2006.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2006_donut_plot_rounded <- Dustan_rocks_2006_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2006_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2006_donut_plot_test <- cbind(Dustan_rocks_2006_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2006_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2006") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2006.png", width = 6, height = 6)
#
#
#
#
# Dustan_rocks_2007 <- filter(Dustan_rocks_plot, Year == 2007)
# Dustan_rocks_2007$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2007_t <- t(Dustan_rocks_2007)
#
# Dustan_rocks_2007_donut <- data.frame(Dustan_rocks_2007_t)
# colnames(Dustan_rocks_2007_donut) <- c("Value")
# Dustan_rocks_2007_donut <- Dustan_rocks_2007_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2007_donut,"Dustan_rocks_2007.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2007_donut_plot <- read.table("Dustan_rocks_2007.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2007_donut_plot_rounded <- Dustan_rocks_2007_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2007_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2007_donut_plot_test <- cbind(Dustan_rocks_2007_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2007_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2007") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2007.png", width = 6, height = 6)
#
#
#
#
# Dustan_rocks_2008 <- filter(Dustan_rocks_plot, Year == 2008)
# Dustan_rocks_2008$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2008_t <- t(Dustan_rocks_2008)
#
# Dustan_rocks_2008_donut <- data.frame(Dustan_rocks_2008_t)
# colnames(Dustan_rocks_2008_donut) <- c("Value")
# Dustan_rocks_2008_donut <- Dustan_rocks_2008_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2008_donut,"Dustan_rocks_2008.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2008_donut_plot <- read.table("Dustan_rocks_2008.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2008_donut_plot_rounded <- Dustan_rocks_2008_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2008_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2008_donut_plot_test <- cbind(Dustan_rocks_2008_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2008_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2008") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2008.png", width = 6, height = 6)
#
#
#
#
# Dustan_rocks_2009 <- filter(Dustan_rocks_plot, Year == 2009)
# Dustan_rocks_2009$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2009_t <- t(Dustan_rocks_2009)
#
# Dustan_rocks_2009_donut <- data.frame(Dustan_rocks_2009_t)
# colnames(Dustan_rocks_2009_donut) <- c("Value")
# Dustan_rocks_2009_donut <- Dustan_rocks_2009_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2009_donut,"Dustan_rocks_2009.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2009_donut_plot <- read.table("Dustan_rocks_2009.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2009_donut_plot_rounded <- Dustan_rocks_2009_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2009_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2009_donut_plot_test <- cbind(Dustan_rocks_2009_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2009_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2009") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2009.png", width = 6, height = 6)
#
#
#
#
# Dustan_rocks_2010 <- filter(Dustan_rocks_plot, Year == 2010)
# Dustan_rocks_2010$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2010_t <- t(Dustan_rocks_2010)
#
# Dustan_rocks_2010_donut <- data.frame(Dustan_rocks_2010_t)
# colnames(Dustan_rocks_2010_donut) <- c("Value")
# Dustan_rocks_2010_donut <- Dustan_rocks_2010_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2010_donut,"Dustan_rocks_2010.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2010_donut_plot <- read.table("Dustan_rocks_2010.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2010_donut_plot_rounded <- Dustan_rocks_2010_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2010_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2010_donut_plot_test <- cbind(Dustan_rocks_2010_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2010_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2010") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# #ggsave ("plots/Dustan_rocks_2010.png", width = 6, height = 6)
#
#
#
#
# Dustan_rocks_2011 <- filter(Dustan_rocks_plot, Year == 2011)
# Dustan_rocks_2011$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2011_t <- t(Dustan_rocks_2011)
#
# Dustan_rocks_2011_donut <- data.frame(Dustan_rocks_2011_t)
# colnames(Dustan_rocks_2011_donut) <- c("Value")
# Dustan_rocks_2011_donut <- Dustan_rocks_2011_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2011_donut,"Dustan_rocks_2011.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2011_donut_plot <- read.table("Dustan_rocks_2011.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2011_donut_plot_rounded <- Dustan_rocks_2011_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2011_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2011_donut_plot_test <- cbind(Dustan_rocks_2011_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2011_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2011") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2011.png", width = 6, height = 6)
#
#
#
#
#
# Dustan_rocks_2012 <- filter(Dustan_rocks_plot, Year == 2012)
# Dustan_rocks_2012$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2012_t <- t(Dustan_rocks_2012)
#
# Dustan_rocks_2012_donut <- data.frame(Dustan_rocks_2012_t)
# colnames(Dustan_rocks_2012_donut) <- c("Value")
# Dustan_rocks_2012_donut <- Dustan_rocks_2012_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2012_donut,"Dustan_rocks_2012.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2012_donut_plot <- read.table("Dustan_rocks_2012.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2012_donut_plot_rounded <- Dustan_rocks_2012_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2012_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2012_donut_plot_test <- cbind(Dustan_rocks_2012_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2012_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2012") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2012.png", width = 6, height = 6)
#
#
#
#
#
#
# Dustan_rocks_2014 <- filter(Dustan_rocks_plot, Year == 2014)
# Dustan_rocks_2014$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2014_t <- t(Dustan_rocks_2014)
#
# Dustan_rocks_2014_donut <- data.frame(Dustan_rocks_2014_t)
# colnames(Dustan_rocks_2014_donut) <- c("Value")
# Dustan_rocks_2014_donut <- Dustan_rocks_2014_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2014_donut,"Dustan_rocks_2014.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2014_donut_plot <- read.table("Dustan_rocks_2014.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2014_donut_plot_rounded <- Dustan_rocks_2014_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2014_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2014_donut_plot_test <- cbind(Dustan_rocks_2014_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2014_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2014") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2014.png", width = 6, height = 6)
#
#
#
#
#
# Dustan_rocks_2016 <- filter(Dustan_rocks_plot, Year == 2016)
# Dustan_rocks_2016$Year <- NULL
#
#
# ### Donut Plot
#
# ## manipulate data
#
# colnames(Dustan_rocks_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2016_t <- t(Dustan_rocks_2016)
#
# Dustan_rocks_2016_donut <- data.frame(Dustan_rocks_2016_t)
# colnames(Dustan_rocks_2016_donut) <- c("Value")
# Dustan_rocks_2016_donut <- Dustan_rocks_2016_donut %>%
#   rownames_to_column(var = "Category")
#
#
# export(Dustan_rocks_2016_donut,"Dustan_rocks_2016.csv")
#
#
# ### import as csv (change category and value to the two column names)
#
# Dustan_rocks_2016_donut_plot <- read.table("Dustan_rocks_2016.csv", header=TRUE, sep=",")
#
#
# Dustan_rocks_2016_donut_plot_rounded <- Dustan_rocks_2016_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Dustan_rocks_2016_donut_plot_rounded
#
#
# # plot
#
# ## This allows the columns to be different colors and the legend variables
#
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Dustan_rocks_2016_donut_plot_test <- cbind(Dustan_rocks_2016_donut_plot_rounded,Legend)
#
#
# Dustan_rocks_2016_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dustan Rocks 2016") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     legend.text = element_text(size = 10),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
#
# ggsave ("plots/Dustan_rocks_2016.png", width = 6, height = 6)


### No Dustan rocks, long key, or Rawa Reef due to lack of data



setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/MK")


Sombrero_deep <- filter(RVC_CREMP, sitename == "Sombrero Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Sombrero_deep_fish <- Sombrero_deep$sum/max(Sombrero_deep$sum)
Sombrero_deep_biomass <- data.frame(Sombrero_deep_fish)

Sombrero_deep_biomass <- 100*Sombrero_deep_biomass


Sombrero_deep_Stony <- Sombrero_deep$Stony_coral/max(Sombrero_deep$Stony_coral)
Sombrero_deep_coral <- data.frame(Sombrero_deep_Stony)

Sombrero_deep_stony_coral <- 100*Sombrero_deep_coral

Sombrero_deep_macro <- Sombrero_deep$Macroalgae/max(Sombrero_deep$Macroalgae)
Sombrero_deep_algae <- data.frame(Sombrero_deep_macro)


Sombrero_deep_macroalgae <- (100*Sombrero_deep_algae)


Sombrero_deep_plot <- cbind(Sombrero_deep_macroalgae,Sombrero_deep_biomass,Sombrero_deep_stony_coral)

Sombrero_deep_plot$Year <- c("1999","2000","2001","2002","2003","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Sombrero_deep_1999 <- filter(Sombrero_deep_plot, Year == 1999)
Sombrero_deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_1999_t <- t(Sombrero_deep_1999)

Sombrero_deep_1999_donut <- data.frame(Sombrero_deep_1999_t)
colnames(Sombrero_deep_1999_donut) <- c("Value")
Sombrero_deep_1999_donut <- Sombrero_deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_1999_donut,"Sombrero_deep_1999.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_1999_donut_plot <- read.table("Sombrero_deep_1999.csv", header=TRUE, sep=",")


Sombrero_deep_1999_donut_plot_rounded <- Sombrero_deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_1999_donut_plot_test <- cbind(Sombrero_deep_1999_donut_plot_rounded,Legend)


Sombrero_deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_1999.png", width = 6, height = 6)



### Sombrero Deep


Sombrero_deep_2000 <- filter(Sombrero_deep_plot, Year == 2000)
Sombrero_deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2000_t <- t(Sombrero_deep_2000)

Sombrero_deep_2000_donut <- data.frame(Sombrero_deep_2000_t)
colnames(Sombrero_deep_2000_donut) <- c("Value")
Sombrero_deep_2000_donut <- Sombrero_deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2000_donut,"Sombrero_deep_2000.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2000_donut_plot <- read.table("Sombrero_deep_2000.csv", header=TRUE, sep=",")


Sombrero_deep_2000_donut_plot_rounded <- Sombrero_deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2000_donut_plot_test <- cbind(Sombrero_deep_2000_donut_plot_rounded,Legend)


Sombrero_deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2000.png", width = 6, height = 6)




Sombrero_deep_2001 <- filter(Sombrero_deep_plot, Year == 2001)
Sombrero_deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2001_t <- t(Sombrero_deep_2001)

Sombrero_deep_2001_donut <- data.frame(Sombrero_deep_2001_t)
colnames(Sombrero_deep_2001_donut) <- c("Value")
Sombrero_deep_2001_donut <- Sombrero_deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2001_donut,"Sombrero_deep_2001.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2001_donut_plot <- read.table("Sombrero_deep_2001.csv", header=TRUE, sep=",")


Sombrero_deep_2001_donut_plot_rounded <- Sombrero_deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2001_donut_plot_test <- cbind(Sombrero_deep_2001_donut_plot_rounded,Legend)


Sombrero_deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2001.png", width = 6, height = 6)





Sombrero_deep_2002 <- filter(Sombrero_deep_plot, Year == 2002)
Sombrero_deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2002_t <- t(Sombrero_deep_2002)

Sombrero_deep_2002_donut <- data.frame(Sombrero_deep_2002_t)
colnames(Sombrero_deep_2002_donut) <- c("Value")
Sombrero_deep_2002_donut <- Sombrero_deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2002_donut,"Sombrero_deep_2002.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2002_donut_plot <- read.table("Sombrero_deep_2002.csv", header=TRUE, sep=",")


Sombrero_deep_2002_donut_plot_rounded <- Sombrero_deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2002_donut_plot_test <- cbind(Sombrero_deep_2002_donut_plot_rounded,Legend)


Sombrero_deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2002.png", width = 6, height = 6)



Sombrero_deep_2003 <- filter(Sombrero_deep_plot, Year == 2003)
Sombrero_deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2003_t <- t(Sombrero_deep_2003)

Sombrero_deep_2003_donut <- data.frame(Sombrero_deep_2003_t)
colnames(Sombrero_deep_2003_donut) <- c("Value")
Sombrero_deep_2003_donut <- Sombrero_deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2003_donut,"Sombrero_deep_2003.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2003_donut_plot <- read.table("Sombrero_deep_2003.csv", header=TRUE, sep=",")


Sombrero_deep_2003_donut_plot_rounded <- Sombrero_deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2003_donut_plot_test <- cbind(Sombrero_deep_2003_donut_plot_rounded,Legend)


Sombrero_deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2003.png", width = 6, height = 6)




Sombrero_deep_2004 <- filter(Sombrero_deep_plot, Year == 2004)
Sombrero_deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2004_t <- t(Sombrero_deep_2004)

Sombrero_deep_2004_donut <- data.frame(Sombrero_deep_2004_t)
colnames(Sombrero_deep_2004_donut) <- c("Value")
Sombrero_deep_2004_donut <- Sombrero_deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2004_donut,"Sombrero_deep_2004.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2004_donut_plot <- read.table("Sombrero_deep_2004.csv", header=TRUE, sep=",")


Sombrero_deep_2004_donut_plot_rounded <- Sombrero_deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2004_donut_plot_test <- cbind(Sombrero_deep_2004_donut_plot_rounded,Legend)


Sombrero_deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Sombrero_deep_2004.png", width = 6, height = 6)




Sombrero_deep_2005 <- filter(Sombrero_deep_plot, Year == 2005)
Sombrero_deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2005_t <- t(Sombrero_deep_2005)

Sombrero_deep_2005_donut <- data.frame(Sombrero_deep_2005_t)
colnames(Sombrero_deep_2005_donut) <- c("Value")
Sombrero_deep_2005_donut <- Sombrero_deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2005_donut,"Sombrero_deep_2005.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2005_donut_plot <- read.table("Sombrero_deep_2005.csv", header=TRUE, sep=",")


Sombrero_deep_2005_donut_plot_rounded <- Sombrero_deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2005_donut_plot_test <- cbind(Sombrero_deep_2005_donut_plot_rounded,Legend)


Sombrero_deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2005.png", width = 6, height = 6)





Sombrero_deep_2006 <- filter(Sombrero_deep_plot, Year == 2006)
Sombrero_deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2006_t <- t(Sombrero_deep_2006)

Sombrero_deep_2006_donut <- data.frame(Sombrero_deep_2006_t)
colnames(Sombrero_deep_2006_donut) <- c("Value")
Sombrero_deep_2006_donut <- Sombrero_deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2006_donut,"Sombrero_deep_2006.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2006_donut_plot <- read.table("Sombrero_deep_2006.csv", header=TRUE, sep=",")


Sombrero_deep_2006_donut_plot_rounded <- Sombrero_deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2006_donut_plot_test <- cbind(Sombrero_deep_2006_donut_plot_rounded,Legend)


Sombrero_deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2006.png", width = 6, height = 6)




Sombrero_deep_2007 <- filter(Sombrero_deep_plot, Year == 2007)
Sombrero_deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2007_t <- t(Sombrero_deep_2007)

Sombrero_deep_2007_donut <- data.frame(Sombrero_deep_2007_t)
colnames(Sombrero_deep_2007_donut) <- c("Value")
Sombrero_deep_2007_donut <- Sombrero_deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2007_donut,"Sombrero_deep_2007.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2007_donut_plot <- read.table("Sombrero_deep_2007.csv", header=TRUE, sep=",")


Sombrero_deep_2007_donut_plot_rounded <- Sombrero_deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2007_donut_plot_test <- cbind(Sombrero_deep_2007_donut_plot_rounded,Legend)


Sombrero_deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2007.png", width = 6, height = 6)




Sombrero_deep_2008 <- filter(Sombrero_deep_plot, Year == 2008)
Sombrero_deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2008_t <- t(Sombrero_deep_2008)

Sombrero_deep_2008_donut <- data.frame(Sombrero_deep_2008_t)
colnames(Sombrero_deep_2008_donut) <- c("Value")
Sombrero_deep_2008_donut <- Sombrero_deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2008_donut,"Sombrero_deep_2008.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2008_donut_plot <- read.table("Sombrero_deep_2008.csv", header=TRUE, sep=",")


Sombrero_deep_2008_donut_plot_rounded <- Sombrero_deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2008_donut_plot_test <- cbind(Sombrero_deep_2008_donut_plot_rounded,Legend)


Sombrero_deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2008.png", width = 6, height = 6)




Sombrero_deep_2009 <- filter(Sombrero_deep_plot, Year == 2009)
Sombrero_deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2009_t <- t(Sombrero_deep_2009)

Sombrero_deep_2009_donut <- data.frame(Sombrero_deep_2009_t)
colnames(Sombrero_deep_2009_donut) <- c("Value")
Sombrero_deep_2009_donut <- Sombrero_deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2009_donut,"Sombrero_deep_2009.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2009_donut_plot <- read.table("Sombrero_deep_2009.csv", header=TRUE, sep=",")


Sombrero_deep_2009_donut_plot_rounded <- Sombrero_deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2009_donut_plot_test <- cbind(Sombrero_deep_2009_donut_plot_rounded,Legend)


Sombrero_deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2009.png", width = 6, height = 6)




Sombrero_deep_2010 <- filter(Sombrero_deep_plot, Year == 2010)
Sombrero_deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2010_t <- t(Sombrero_deep_2010)

Sombrero_deep_2010_donut <- data.frame(Sombrero_deep_2010_t)
colnames(Sombrero_deep_2010_donut) <- c("Value")
Sombrero_deep_2010_donut <- Sombrero_deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2010_donut,"Sombrero_deep_2010.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2010_donut_plot <- read.table("Sombrero_deep_2010.csv", header=TRUE, sep=",")


Sombrero_deep_2010_donut_plot_rounded <- Sombrero_deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2010_donut_plot_test <- cbind(Sombrero_deep_2010_donut_plot_rounded,Legend)


Sombrero_deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Sombrero_deep_2010.png", width = 6, height = 6)




Sombrero_deep_2011 <- filter(Sombrero_deep_plot, Year == 2011)
Sombrero_deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2011_t <- t(Sombrero_deep_2011)

Sombrero_deep_2011_donut <- data.frame(Sombrero_deep_2011_t)
colnames(Sombrero_deep_2011_donut) <- c("Value")
Sombrero_deep_2011_donut <- Sombrero_deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2011_donut,"Sombrero_deep_2011.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2011_donut_plot <- read.table("Sombrero_deep_2011.csv", header=TRUE, sep=",")


Sombrero_deep_2011_donut_plot_rounded <- Sombrero_deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2011_donut_plot_test <- cbind(Sombrero_deep_2011_donut_plot_rounded,Legend)


Sombrero_deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2011.png", width = 6, height = 6)





Sombrero_deep_2012 <- filter(Sombrero_deep_plot, Year == 2012)
Sombrero_deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2012_t <- t(Sombrero_deep_2012)

Sombrero_deep_2012_donut <- data.frame(Sombrero_deep_2012_t)
colnames(Sombrero_deep_2012_donut) <- c("Value")
Sombrero_deep_2012_donut <- Sombrero_deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2012_donut,"Sombrero_deep_2012.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2012_donut_plot <- read.table("Sombrero_deep_2012.csv", header=TRUE, sep=",")


Sombrero_deep_2012_donut_plot_rounded <- Sombrero_deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2012_donut_plot_test <- cbind(Sombrero_deep_2012_donut_plot_rounded,Legend)


Sombrero_deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2012.png", width = 6, height = 6)






Sombrero_deep_2014 <- filter(Sombrero_deep_plot, Year == 2014)
Sombrero_deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2014_t <- t(Sombrero_deep_2014)

Sombrero_deep_2014_donut <- data.frame(Sombrero_deep_2014_t)
colnames(Sombrero_deep_2014_donut) <- c("Value")
Sombrero_deep_2014_donut <- Sombrero_deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2014_donut,"Sombrero_deep_2014.csv")


### import as csv (change category and value to the two column names)

Sombrero_deep_2014_donut_plot <- read.table("Sombrero_deep_2014.csv", header=TRUE, sep=",")


Sombrero_deep_2014_donut_plot_rounded <- Sombrero_deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2014_donut_plot_test <- cbind(Sombrero_deep_2014_donut_plot_rounded,Legend)


Sombrero_deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2014.png", width = 6, height = 6)





Sombrero_deep_2016 <- filter(Sombrero_deep_plot, Year == 2016)
Sombrero_deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2016_t <- t(Sombrero_deep_2016)

Sombrero_deep_2016_donut <- data.frame(Sombrero_deep_2016_t)
colnames(Sombrero_deep_2016_donut) <- c("Value")
Sombrero_deep_2016_donut <- Sombrero_deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_deep_2016_donut,"Sombrero_deep_2016.csv")


### import as csv (change category and value to the two column names)
Sombrero_deep_2016_donut_plot <- read.table("Sombrero_deep_2016.csv", header=TRUE, sep=",")


Sombrero_deep_2016_donut_plot_rounded <- Sombrero_deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_deep_2016_donut_plot_test <- cbind(Sombrero_deep_2016_donut_plot_rounded,Legend)


Sombrero_deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_deep_2016.png", width = 6, height = 6)





Sombrero_shallow <- filter(RVC_CREMP, sitename == "Sombrero Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Sombrero_shallow_fish <- Sombrero_shallow$sum/max(Sombrero_shallow$sum)
Sombrero_shallow_biomass <- data.frame(Sombrero_shallow_fish)

Sombrero_shallow_biomass <- 100*Sombrero_shallow_biomass


Sombrero_shallow_Stony <- Sombrero_shallow$Stony_coral/max(Sombrero_shallow$Stony_coral)
Sombrero_shallow_coral <- data.frame(Sombrero_shallow_Stony)

Sombrero_shallow_stony_coral <- 100*Sombrero_shallow_coral

Sombrero_shallow_macro <- Sombrero_shallow$Macroalgae/max(Sombrero_shallow$Macroalgae)
Sombrero_shallow_algae <- data.frame(Sombrero_shallow_macro)


Sombrero_shallow_macroalgae <- (100*Sombrero_shallow_algae)


Sombrero_shallow_plot <- cbind(Sombrero_shallow_macroalgae,Sombrero_shallow_biomass,Sombrero_shallow_stony_coral)

Sombrero_shallow_plot$Year <- c("1999","2000","2001","2002","2003","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Sombrero_shallow_1999 <- filter(Sombrero_shallow_plot, Year == 1999)
Sombrero_shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_1999_t <- t(Sombrero_shallow_1999)

Sombrero_shallow_1999_donut <- data.frame(Sombrero_shallow_1999_t)
colnames(Sombrero_shallow_1999_donut) <- c("Value")
Sombrero_shallow_1999_donut <- Sombrero_shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_1999_donut,"Sombrero_shallow_1999.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_1999_donut_plot <- read.table("Sombrero_shallow_1999.csv", header=TRUE, sep=",")


Sombrero_shallow_1999_donut_plot_rounded <- Sombrero_shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_1999_donut_plot_test <- cbind(Sombrero_shallow_1999_donut_plot_rounded,Legend)


Sombrero_shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_1999.png", width = 6, height = 6)



### Sombrero Shallow


Sombrero_shallow_2000 <- filter(Sombrero_shallow_plot, Year == 2000)
Sombrero_shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2000_t <- t(Sombrero_shallow_2000)

Sombrero_shallow_2000_donut <- data.frame(Sombrero_shallow_2000_t)
colnames(Sombrero_shallow_2000_donut) <- c("Value")
Sombrero_shallow_2000_donut <- Sombrero_shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2000_donut,"Sombrero_shallow_2000.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2000_donut_plot <- read.table("Sombrero_shallow_2000.csv", header=TRUE, sep=",")


Sombrero_shallow_2000_donut_plot_rounded <- Sombrero_shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2000_donut_plot_test <- cbind(Sombrero_shallow_2000_donut_plot_rounded,Legend)


Sombrero_shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2000.png", width = 6, height = 6)




Sombrero_shallow_2001 <- filter(Sombrero_shallow_plot, Year == 2001)
Sombrero_shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2001_t <- t(Sombrero_shallow_2001)

Sombrero_shallow_2001_donut <- data.frame(Sombrero_shallow_2001_t)
colnames(Sombrero_shallow_2001_donut) <- c("Value")
Sombrero_shallow_2001_donut <- Sombrero_shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2001_donut,"Sombrero_shallow_2001.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2001_donut_plot <- read.table("Sombrero_shallow_2001.csv", header=TRUE, sep=",")


Sombrero_shallow_2001_donut_plot_rounded <- Sombrero_shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2001_donut_plot_test <- cbind(Sombrero_shallow_2001_donut_plot_rounded,Legend)


Sombrero_shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2001.png", width = 6, height = 6)





Sombrero_shallow_2002 <- filter(Sombrero_shallow_plot, Year == 2002)
Sombrero_shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2002_t <- t(Sombrero_shallow_2002)

Sombrero_shallow_2002_donut <- data.frame(Sombrero_shallow_2002_t)
colnames(Sombrero_shallow_2002_donut) <- c("Value")
Sombrero_shallow_2002_donut <- Sombrero_shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2002_donut,"Sombrero_shallow_2002.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2002_donut_plot <- read.table("Sombrero_shallow_2002.csv", header=TRUE, sep=",")


Sombrero_shallow_2002_donut_plot_rounded <- Sombrero_shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2002_donut_plot_test <- cbind(Sombrero_shallow_2002_donut_plot_rounded,Legend)


Sombrero_shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2002.png", width = 6, height = 6)



Sombrero_shallow_2003 <- filter(Sombrero_shallow_plot, Year == 2003)
Sombrero_shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2003_t <- t(Sombrero_shallow_2003)

Sombrero_shallow_2003_donut <- data.frame(Sombrero_shallow_2003_t)
colnames(Sombrero_shallow_2003_donut) <- c("Value")
Sombrero_shallow_2003_donut <- Sombrero_shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2003_donut,"Sombrero_shallow_2003.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2003_donut_plot <- read.table("Sombrero_shallow_2003.csv", header=TRUE, sep=",")


Sombrero_shallow_2003_donut_plot_rounded <- Sombrero_shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2003_donut_plot_test <- cbind(Sombrero_shallow_2003_donut_plot_rounded,Legend)


Sombrero_shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2003.png", width = 6, height = 6)




Sombrero_shallow_2004 <- filter(Sombrero_shallow_plot, Year == 2004)
Sombrero_shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2004_t <- t(Sombrero_shallow_2004)

Sombrero_shallow_2004_donut <- data.frame(Sombrero_shallow_2004_t)
colnames(Sombrero_shallow_2004_donut) <- c("Value")
Sombrero_shallow_2004_donut <- Sombrero_shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2004_donut,"Sombrero_shallow_2004.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2004_donut_plot <- read.table("Sombrero_shallow_2004.csv", header=TRUE, sep=",")


Sombrero_shallow_2004_donut_plot_rounded <- Sombrero_shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2004_donut_plot_test <- cbind(Sombrero_shallow_2004_donut_plot_rounded,Legend)


Sombrero_shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Sombrero_shallow_2004.png", width = 6, height = 6)




Sombrero_shallow_2005 <- filter(Sombrero_shallow_plot, Year == 2005)
Sombrero_shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2005_t <- t(Sombrero_shallow_2005)

Sombrero_shallow_2005_donut <- data.frame(Sombrero_shallow_2005_t)
colnames(Sombrero_shallow_2005_donut) <- c("Value")
Sombrero_shallow_2005_donut <- Sombrero_shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2005_donut,"Sombrero_shallow_2005.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2005_donut_plot <- read.table("Sombrero_shallow_2005.csv", header=TRUE, sep=",")


Sombrero_shallow_2005_donut_plot_rounded <- Sombrero_shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2005_donut_plot_test <- cbind(Sombrero_shallow_2005_donut_plot_rounded,Legend)


Sombrero_shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2005.png", width = 6, height = 6)





Sombrero_shallow_2006 <- filter(Sombrero_shallow_plot, Year == 2006)
Sombrero_shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2006_t <- t(Sombrero_shallow_2006)

Sombrero_shallow_2006_donut <- data.frame(Sombrero_shallow_2006_t)
colnames(Sombrero_shallow_2006_donut) <- c("Value")
Sombrero_shallow_2006_donut <- Sombrero_shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2006_donut,"Sombrero_shallow_2006.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2006_donut_plot <- read.table("Sombrero_shallow_2006.csv", header=TRUE, sep=",")


Sombrero_shallow_2006_donut_plot_rounded <- Sombrero_shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2006_donut_plot_test <- cbind(Sombrero_shallow_2006_donut_plot_rounded,Legend)


Sombrero_shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2006.png", width = 6, height = 6)




Sombrero_shallow_2007 <- filter(Sombrero_shallow_plot, Year == 2007)
Sombrero_shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2007_t <- t(Sombrero_shallow_2007)

Sombrero_shallow_2007_donut <- data.frame(Sombrero_shallow_2007_t)
colnames(Sombrero_shallow_2007_donut) <- c("Value")
Sombrero_shallow_2007_donut <- Sombrero_shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2007_donut,"Sombrero_shallow_2007.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2007_donut_plot <- read.table("Sombrero_shallow_2007.csv", header=TRUE, sep=",")


Sombrero_shallow_2007_donut_plot_rounded <- Sombrero_shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2007_donut_plot_test <- cbind(Sombrero_shallow_2007_donut_plot_rounded,Legend)


Sombrero_shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2007.png", width = 6, height = 6)




Sombrero_shallow_2008 <- filter(Sombrero_shallow_plot, Year == 2008)
Sombrero_shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2008_t <- t(Sombrero_shallow_2008)

Sombrero_shallow_2008_donut <- data.frame(Sombrero_shallow_2008_t)
colnames(Sombrero_shallow_2008_donut) <- c("Value")
Sombrero_shallow_2008_donut <- Sombrero_shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2008_donut,"Sombrero_shallow_2008.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2008_donut_plot <- read.table("Sombrero_shallow_2008.csv", header=TRUE, sep=",")


Sombrero_shallow_2008_donut_plot_rounded <- Sombrero_shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2008_donut_plot_test <- cbind(Sombrero_shallow_2008_donut_plot_rounded,Legend)


Sombrero_shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2008.png", width = 6, height = 6)




Sombrero_shallow_2009 <- filter(Sombrero_shallow_plot, Year == 2009)
Sombrero_shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2009_t <- t(Sombrero_shallow_2009)

Sombrero_shallow_2009_donut <- data.frame(Sombrero_shallow_2009_t)
colnames(Sombrero_shallow_2009_donut) <- c("Value")
Sombrero_shallow_2009_donut <- Sombrero_shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2009_donut,"Sombrero_shallow_2009.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2009_donut_plot <- read.table("Sombrero_shallow_2009.csv", header=TRUE, sep=",")


Sombrero_shallow_2009_donut_plot_rounded <- Sombrero_shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2009_donut_plot_test <- cbind(Sombrero_shallow_2009_donut_plot_rounded,Legend)


Sombrero_shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2009.png", width = 6, height = 6)




Sombrero_shallow_2010 <- filter(Sombrero_shallow_plot, Year == 2010)
Sombrero_shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2010_t <- t(Sombrero_shallow_2010)

Sombrero_shallow_2010_donut <- data.frame(Sombrero_shallow_2010_t)
colnames(Sombrero_shallow_2010_donut) <- c("Value")
Sombrero_shallow_2010_donut <- Sombrero_shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2010_donut,"Sombrero_shallow_2010.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2010_donut_plot <- read.table("Sombrero_shallow_2010.csv", header=TRUE, sep=",")


Sombrero_shallow_2010_donut_plot_rounded <- Sombrero_shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2010_donut_plot_test <- cbind(Sombrero_shallow_2010_donut_plot_rounded,Legend)


Sombrero_shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Sombrero_shallow_2010.png", width = 6, height = 6)




Sombrero_shallow_2011 <- filter(Sombrero_shallow_plot, Year == 2011)
Sombrero_shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2011_t <- t(Sombrero_shallow_2011)

Sombrero_shallow_2011_donut <- data.frame(Sombrero_shallow_2011_t)
colnames(Sombrero_shallow_2011_donut) <- c("Value")
Sombrero_shallow_2011_donut <- Sombrero_shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2011_donut,"Sombrero_shallow_2011.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2011_donut_plot <- read.table("Sombrero_shallow_2011.csv", header=TRUE, sep=",")


Sombrero_shallow_2011_donut_plot_rounded <- Sombrero_shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2011_donut_plot_test <- cbind(Sombrero_shallow_2011_donut_plot_rounded,Legend)


Sombrero_shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2011.png", width = 6, height = 6)





Sombrero_shallow_2012 <- filter(Sombrero_shallow_plot, Year == 2012)
Sombrero_shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2012_t <- t(Sombrero_shallow_2012)

Sombrero_shallow_2012_donut <- data.frame(Sombrero_shallow_2012_t)
colnames(Sombrero_shallow_2012_donut) <- c("Value")
Sombrero_shallow_2012_donut <- Sombrero_shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2012_donut,"Sombrero_shallow_2012.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2012_donut_plot <- read.table("Sombrero_shallow_2012.csv", header=TRUE, sep=",")


Sombrero_shallow_2012_donut_plot_rounded <- Sombrero_shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2012_donut_plot_test <- cbind(Sombrero_shallow_2012_donut_plot_rounded,Legend)


Sombrero_shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2012.png", width = 6, height = 6)






Sombrero_shallow_2014 <- filter(Sombrero_shallow_plot, Year == 2014)
Sombrero_shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2014_t <- t(Sombrero_shallow_2014)

Sombrero_shallow_2014_donut <- data.frame(Sombrero_shallow_2014_t)
colnames(Sombrero_shallow_2014_donut) <- c("Value")
Sombrero_shallow_2014_donut <- Sombrero_shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2014_donut,"Sombrero_shallow_2014.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2014_donut_plot <- read.table("Sombrero_shallow_2014.csv", header=TRUE, sep=",")


Sombrero_shallow_2014_donut_plot_rounded <- Sombrero_shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2014_donut_plot_test <- cbind(Sombrero_shallow_2014_donut_plot_rounded,Legend)


Sombrero_shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2014.png", width = 6, height = 6)





Sombrero_shallow_2016 <- filter(Sombrero_shallow_plot, Year == 2016)
Sombrero_shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sombrero_shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2016_t <- t(Sombrero_shallow_2016)

Sombrero_shallow_2016_donut <- data.frame(Sombrero_shallow_2016_t)
colnames(Sombrero_shallow_2016_donut) <- c("Value")
Sombrero_shallow_2016_donut <- Sombrero_shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Sombrero_shallow_2016_donut,"Sombrero_shallow_2016.csv")


### import as csv (change category and value to the two column names)

Sombrero_shallow_2016_donut_plot <- read.table("Sombrero_shallow_2016.csv", header=TRUE, sep=",")


Sombrero_shallow_2016_donut_plot_rounded <- Sombrero_shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sombrero_shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sombrero_shallow_2016_donut_plot_test <- cbind(Sombrero_shallow_2016_donut_plot_rounded,Legend)


Sombrero_shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sombrero Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sombrero_shallow_2016.png", width = 6, height = 6)








Tennessee_deep <- filter(RVC_CREMP, sitename == "Tennessee Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Tennessee_deep_fish <- Tennessee_deep$sum/max(Tennessee_deep$sum)
Tennessee_deep_biomass <- data.frame(Tennessee_deep_fish)

Tennessee_deep_biomass <- 100*Tennessee_deep_biomass


Tennessee_deep_Stony <- Tennessee_deep$Stony_coral/max(Tennessee_deep$Stony_coral)
Tennessee_deep_coral <- data.frame(Tennessee_deep_Stony)

Tennessee_deep_stony_coral <- 100*Tennessee_deep_coral

Tennessee_deep_macro <- Tennessee_deep$Macroalgae/max(Tennessee_deep$Macroalgae)
Tennessee_deep_algae <- data.frame(Tennessee_deep_macro)


Tennessee_deep_macroalgae <- (100*Tennessee_deep_algae)


Tennessee_deep_plot <- cbind(Tennessee_deep_macroalgae,Tennessee_deep_biomass,Tennessee_deep_stony_coral)

Tennessee_deep_plot$Year <- c("1999","2000","2001","2002","2003","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Tennessee_deep_1999 <- filter(Tennessee_deep_plot, Year == 1999)
Tennessee_deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_1999_t <- t(Tennessee_deep_1999)

Tennessee_deep_1999_donut <- data.frame(Tennessee_deep_1999_t)
colnames(Tennessee_deep_1999_donut) <- c("Value")
Tennessee_deep_1999_donut <- Tennessee_deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_1999_donut,"Tennessee_deep_1999.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_1999_donut_plot <- read.table("Tennessee_deep_1999.csv", header=TRUE, sep=",")


Tennessee_deep_1999_donut_plot_rounded <- Tennessee_deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_1999_donut_plot_test <- cbind(Tennessee_deep_1999_donut_plot_rounded,Legend)


Tennessee_deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_1999.png", width = 6, height = 6)



### Tennessee Deep


Tennessee_deep_2000 <- filter(Tennessee_deep_plot, Year == 2000)
Tennessee_deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2000_t <- t(Tennessee_deep_2000)

Tennessee_deep_2000_donut <- data.frame(Tennessee_deep_2000_t)
colnames(Tennessee_deep_2000_donut) <- c("Value")
Tennessee_deep_2000_donut <- Tennessee_deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2000_donut,"Tennessee_deep_2000.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2000_donut_plot <- read.table("Tennessee_deep_2000.csv", header=TRUE, sep=",")


Tennessee_deep_2000_donut_plot_rounded <- Tennessee_deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2000_donut_plot_test <- cbind(Tennessee_deep_2000_donut_plot_rounded,Legend)


Tennessee_deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2000.png", width = 6, height = 6)




Tennessee_deep_2001 <- filter(Tennessee_deep_plot, Year == 2001)
Tennessee_deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2001_t <- t(Tennessee_deep_2001)

Tennessee_deep_2001_donut <- data.frame(Tennessee_deep_2001_t)
colnames(Tennessee_deep_2001_donut) <- c("Value")
Tennessee_deep_2001_donut <- Tennessee_deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2001_donut,"Tennessee_deep_2001.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2001_donut_plot <- read.table("Tennessee_deep_2001.csv", header=TRUE, sep=",")


Tennessee_deep_2001_donut_plot_rounded <- Tennessee_deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2001_donut_plot_test <- cbind(Tennessee_deep_2001_donut_plot_rounded,Legend)


Tennessee_deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2001.png", width = 6, height = 6)





Tennessee_deep_2002 <- filter(Tennessee_deep_plot, Year == 2002)
Tennessee_deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2002_t <- t(Tennessee_deep_2002)

Tennessee_deep_2002_donut <- data.frame(Tennessee_deep_2002_t)
colnames(Tennessee_deep_2002_donut) <- c("Value")
Tennessee_deep_2002_donut <- Tennessee_deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2002_donut,"Tennessee_deep_2002.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2002_donut_plot <- read.table("Tennessee_deep_2002.csv", header=TRUE, sep=",")


Tennessee_deep_2002_donut_plot_rounded <- Tennessee_deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2002_donut_plot_test <- cbind(Tennessee_deep_2002_donut_plot_rounded,Legend)


Tennessee_deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2002.png", width = 6, height = 6)



Tennessee_deep_2003 <- filter(Tennessee_deep_plot, Year == 2003)
Tennessee_deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2003_t <- t(Tennessee_deep_2003)

Tennessee_deep_2003_donut <- data.frame(Tennessee_deep_2003_t)
colnames(Tennessee_deep_2003_donut) <- c("Value")
Tennessee_deep_2003_donut <- Tennessee_deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2003_donut,"Tennessee_deep_2003.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2003_donut_plot <- read.table("Tennessee_deep_2003.csv", header=TRUE, sep=",")


Tennessee_deep_2003_donut_plot_rounded <- Tennessee_deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2003_donut_plot_test <- cbind(Tennessee_deep_2003_donut_plot_rounded,Legend)


Tennessee_deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2003.png", width = 6, height = 6)




Tennessee_deep_2004 <- filter(Tennessee_deep_plot, Year == 2004)
Tennessee_deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2004_t <- t(Tennessee_deep_2004)

Tennessee_deep_2004_donut <- data.frame(Tennessee_deep_2004_t)
colnames(Tennessee_deep_2004_donut) <- c("Value")
Tennessee_deep_2004_donut <- Tennessee_deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2004_donut,"Tennessee_deep_2004.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2004_donut_plot <- read.table("Tennessee_deep_2004.csv", header=TRUE, sep=",")


Tennessee_deep_2004_donut_plot_rounded <- Tennessee_deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2004_donut_plot_test <- cbind(Tennessee_deep_2004_donut_plot_rounded,Legend)


Tennessee_deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Tennessee_deep_2004.png", width = 6, height = 6)




Tennessee_deep_2005 <- filter(Tennessee_deep_plot, Year == 2005)
Tennessee_deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2005_t <- t(Tennessee_deep_2005)

Tennessee_deep_2005_donut <- data.frame(Tennessee_deep_2005_t)
colnames(Tennessee_deep_2005_donut) <- c("Value")
Tennessee_deep_2005_donut <- Tennessee_deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2005_donut,"Tennessee_deep_2005.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2005_donut_plot <- read.table("Tennessee_deep_2005.csv", header=TRUE, sep=",")


Tennessee_deep_2005_donut_plot_rounded <- Tennessee_deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2005_donut_plot_test <- cbind(Tennessee_deep_2005_donut_plot_rounded,Legend)


Tennessee_deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2005.png", width = 6, height = 6)





Tennessee_deep_2006 <- filter(Tennessee_deep_plot, Year == 2006)
Tennessee_deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2006_t <- t(Tennessee_deep_2006)

Tennessee_deep_2006_donut <- data.frame(Tennessee_deep_2006_t)
colnames(Tennessee_deep_2006_donut) <- c("Value")
Tennessee_deep_2006_donut <- Tennessee_deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2006_donut,"Tennessee_deep_2006.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2006_donut_plot <- read.table("Tennessee_deep_2006.csv", header=TRUE, sep=",")


Tennessee_deep_2006_donut_plot_rounded <- Tennessee_deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2006_donut_plot_test <- cbind(Tennessee_deep_2006_donut_plot_rounded,Legend)


Tennessee_deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2006.png", width = 6, height = 6)




Tennessee_deep_2007 <- filter(Tennessee_deep_plot, Year == 2007)
Tennessee_deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2007_t <- t(Tennessee_deep_2007)

Tennessee_deep_2007_donut <- data.frame(Tennessee_deep_2007_t)
colnames(Tennessee_deep_2007_donut) <- c("Value")
Tennessee_deep_2007_donut <- Tennessee_deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2007_donut,"Tennessee_deep_2007.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2007_donut_plot <- read.table("Tennessee_deep_2007.csv", header=TRUE, sep=",")


Tennessee_deep_2007_donut_plot_rounded <- Tennessee_deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2007_donut_plot_test <- cbind(Tennessee_deep_2007_donut_plot_rounded,Legend)


Tennessee_deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2007.png", width = 6, height = 6)




Tennessee_deep_2008 <- filter(Tennessee_deep_plot, Year == 2008)
Tennessee_deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2008_t <- t(Tennessee_deep_2008)

Tennessee_deep_2008_donut <- data.frame(Tennessee_deep_2008_t)
colnames(Tennessee_deep_2008_donut) <- c("Value")
Tennessee_deep_2008_donut <- Tennessee_deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2008_donut,"Tennessee_deep_2008.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2008_donut_plot <- read.table("Tennessee_deep_2008.csv", header=TRUE, sep=",")


Tennessee_deep_2008_donut_plot_rounded <- Tennessee_deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2008_donut_plot_test <- cbind(Tennessee_deep_2008_donut_plot_rounded,Legend)


Tennessee_deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2008.png", width = 6, height = 6)




Tennessee_deep_2009 <- filter(Tennessee_deep_plot, Year == 2009)
Tennessee_deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2009_t <- t(Tennessee_deep_2009)

Tennessee_deep_2009_donut <- data.frame(Tennessee_deep_2009_t)
colnames(Tennessee_deep_2009_donut) <- c("Value")
Tennessee_deep_2009_donut <- Tennessee_deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2009_donut,"Tennessee_deep_2009.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2009_donut_plot <- read.table("Tennessee_deep_2009.csv", header=TRUE, sep=",")


Tennessee_deep_2009_donut_plot_rounded <- Tennessee_deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2009_donut_plot_test <- cbind(Tennessee_deep_2009_donut_plot_rounded,Legend)


Tennessee_deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2009.png", width = 6, height = 6)




Tennessee_deep_2010 <- filter(Tennessee_deep_plot, Year == 2010)
Tennessee_deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2010_t <- t(Tennessee_deep_2010)

Tennessee_deep_2010_donut <- data.frame(Tennessee_deep_2010_t)
colnames(Tennessee_deep_2010_donut) <- c("Value")
Tennessee_deep_2010_donut <- Tennessee_deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2010_donut,"Tennessee_deep_2010.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2010_donut_plot <- read.table("Tennessee_deep_2010.csv", header=TRUE, sep=",")


Tennessee_deep_2010_donut_plot_rounded <- Tennessee_deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2010_donut_plot_test <- cbind(Tennessee_deep_2010_donut_plot_rounded,Legend)


Tennessee_deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Tennessee_deep_2010.png", width = 6, height = 6)




Tennessee_deep_2011 <- filter(Tennessee_deep_plot, Year == 2011)
Tennessee_deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2011_t <- t(Tennessee_deep_2011)

Tennessee_deep_2011_donut <- data.frame(Tennessee_deep_2011_t)
colnames(Tennessee_deep_2011_donut) <- c("Value")
Tennessee_deep_2011_donut <- Tennessee_deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2011_donut,"Tennessee_deep_2011.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2011_donut_plot <- read.table("Tennessee_deep_2011.csv", header=TRUE, sep=",")


Tennessee_deep_2011_donut_plot_rounded <- Tennessee_deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2011_donut_plot_test <- cbind(Tennessee_deep_2011_donut_plot_rounded,Legend)


Tennessee_deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2011.png", width = 6, height = 6)





Tennessee_deep_2012 <- filter(Tennessee_deep_plot, Year == 2012)
Tennessee_deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2012_t <- t(Tennessee_deep_2012)

Tennessee_deep_2012_donut <- data.frame(Tennessee_deep_2012_t)
colnames(Tennessee_deep_2012_donut) <- c("Value")
Tennessee_deep_2012_donut <- Tennessee_deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2012_donut,"Tennessee_deep_2012.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2012_donut_plot <- read.table("Tennessee_deep_2012.csv", header=TRUE, sep=",")


Tennessee_deep_2012_donut_plot_rounded <- Tennessee_deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2012_donut_plot_test <- cbind(Tennessee_deep_2012_donut_plot_rounded,Legend)


Tennessee_deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2012.png", width = 6, height = 6)






Tennessee_deep_2014 <- filter(Tennessee_deep_plot, Year == 2014)
Tennessee_deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2014_t <- t(Tennessee_deep_2014)

Tennessee_deep_2014_donut <- data.frame(Tennessee_deep_2014_t)
colnames(Tennessee_deep_2014_donut) <- c("Value")
Tennessee_deep_2014_donut <- Tennessee_deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2014_donut,"Tennessee_deep_2014.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2014_donut_plot <- read.table("Tennessee_deep_2014.csv", header=TRUE, sep=",")


Tennessee_deep_2014_donut_plot_rounded <- Tennessee_deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2014_donut_plot_test <- cbind(Tennessee_deep_2014_donut_plot_rounded,Legend)


Tennessee_deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2014.png", width = 6, height = 6)





Tennessee_deep_2016 <- filter(Tennessee_deep_plot, Year == 2016)
Tennessee_deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2016_t <- t(Tennessee_deep_2016)

Tennessee_deep_2016_donut <- data.frame(Tennessee_deep_2016_t)
colnames(Tennessee_deep_2016_donut) <- c("Value")
Tennessee_deep_2016_donut <- Tennessee_deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_deep_2016_donut,"Tennessee_deep_2016.csv")


### import as csv (change category and value to the two column names)

Tennessee_deep_2016_donut_plot <- read.table("Tennessee_deep_2016.csv", header=TRUE, sep=",")


Tennessee_deep_2016_donut_plot_rounded <- Tennessee_deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_deep_2016_donut_plot_test <- cbind(Tennessee_deep_2016_donut_plot_rounded,Legend)


Tennessee_deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_deep_2016.png", width = 6, height = 6)







Tennessee_shallow <- filter(RVC_CREMP, sitename == "Tennessee Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Tennessee_shallow_fish <- Tennessee_shallow$sum/max(Tennessee_shallow$sum)
Tennessee_shallow_biomass <- data.frame(Tennessee_shallow_fish)

Tennessee_shallow_biomass <- 100*Tennessee_shallow_biomass


Tennessee_shallow_Stony <- Tennessee_shallow$Stony_coral/max(Tennessee_shallow$Stony_coral)
Tennessee_shallow_coral <- data.frame(Tennessee_shallow_Stony)

Tennessee_shallow_stony_coral <- 100*Tennessee_shallow_coral

Tennessee_shallow_macro <- Tennessee_shallow$Macroalgae/max(Tennessee_shallow$Macroalgae)
Tennessee_shallow_algae <- data.frame(Tennessee_shallow_macro)


Tennessee_shallow_macroalgae <- (100*Tennessee_shallow_algae)


Tennessee_shallow_plot <- cbind(Tennessee_shallow_macroalgae,Tennessee_shallow_biomass,Tennessee_shallow_stony_coral)

Tennessee_shallow_plot$Year <- c("1999","2000","2001","2002","2003","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Tennessee_shallow_1999 <- filter(Tennessee_shallow_plot, Year == 1999)
Tennessee_shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_1999_t <- t(Tennessee_shallow_1999)

Tennessee_shallow_1999_donut <- data.frame(Tennessee_shallow_1999_t)
colnames(Tennessee_shallow_1999_donut) <- c("Value")
Tennessee_shallow_1999_donut <- Tennessee_shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_1999_donut,"Tennessee_shallow_1999.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_1999_donut_plot <- read.table("Tennessee_shallow_1999.csv", header=TRUE, sep=",")


Tennessee_shallow_1999_donut_plot_rounded <- Tennessee_shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_1999_donut_plot_test <- cbind(Tennessee_shallow_1999_donut_plot_rounded,Legend)


Tennessee_shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_1999.png", width = 6, height = 6)



### Tennessee Shallow


Tennessee_shallow_2000 <- filter(Tennessee_shallow_plot, Year == 2000)
Tennessee_shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2000_t <- t(Tennessee_shallow_2000)

Tennessee_shallow_2000_donut <- data.frame(Tennessee_shallow_2000_t)
colnames(Tennessee_shallow_2000_donut) <- c("Value")
Tennessee_shallow_2000_donut <- Tennessee_shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2000_donut,"Tennessee_shallow_2000.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2000_donut_plot <- read.table("Tennessee_shallow_2000.csv", header=TRUE, sep=",")


Tennessee_shallow_2000_donut_plot_rounded <- Tennessee_shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2000_donut_plot_test <- cbind(Tennessee_shallow_2000_donut_plot_rounded,Legend)


Tennessee_shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2000.png", width = 6, height = 6)




Tennessee_shallow_2001 <- filter(Tennessee_shallow_plot, Year == 2001)
Tennessee_shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2001_t <- t(Tennessee_shallow_2001)

Tennessee_shallow_2001_donut <- data.frame(Tennessee_shallow_2001_t)
colnames(Tennessee_shallow_2001_donut) <- c("Value")
Tennessee_shallow_2001_donut <- Tennessee_shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2001_donut,"Tennessee_shallow_2001.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2001_donut_plot <- read.table("Tennessee_shallow_2001.csv", header=TRUE, sep=",")


Tennessee_shallow_2001_donut_plot_rounded <- Tennessee_shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2001_donut_plot_test <- cbind(Tennessee_shallow_2001_donut_plot_rounded,Legend)


Tennessee_shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2001.png", width = 6, height = 6)





Tennessee_shallow_2002 <- filter(Tennessee_shallow_plot, Year == 2002)
Tennessee_shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2002_t <- t(Tennessee_shallow_2002)

Tennessee_shallow_2002_donut <- data.frame(Tennessee_shallow_2002_t)
colnames(Tennessee_shallow_2002_donut) <- c("Value")
Tennessee_shallow_2002_donut <- Tennessee_shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2002_donut,"Tennessee_shallow_2002.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2002_donut_plot <- read.table("Tennessee_shallow_2002.csv", header=TRUE, sep=",")


Tennessee_shallow_2002_donut_plot_rounded <- Tennessee_shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2002_donut_plot_test <- cbind(Tennessee_shallow_2002_donut_plot_rounded,Legend)


Tennessee_shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2002.png", width = 6, height = 6)



Tennessee_shallow_2003 <- filter(Tennessee_shallow_plot, Year == 2003)
Tennessee_shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2003_t <- t(Tennessee_shallow_2003)

Tennessee_shallow_2003_donut <- data.frame(Tennessee_shallow_2003_t)
colnames(Tennessee_shallow_2003_donut) <- c("Value")
Tennessee_shallow_2003_donut <- Tennessee_shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2003_donut,"Tennessee_shallow_2003.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2003_donut_plot <- read.table("Tennessee_shallow_2003.csv", header=TRUE, sep=",")


Tennessee_shallow_2003_donut_plot_rounded <- Tennessee_shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2003_donut_plot_test <- cbind(Tennessee_shallow_2003_donut_plot_rounded,Legend)


Tennessee_shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2003.png", width = 6, height = 6)




Tennessee_shallow_2004 <- filter(Tennessee_shallow_plot, Year == 2004)
Tennessee_shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2004_t <- t(Tennessee_shallow_2004)

Tennessee_shallow_2004_donut <- data.frame(Tennessee_shallow_2004_t)
colnames(Tennessee_shallow_2004_donut) <- c("Value")
Tennessee_shallow_2004_donut <- Tennessee_shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2004_donut,"Tennessee_shallow_2004.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2004_donut_plot <- read.table("Tennessee_shallow_2004.csv", header=TRUE, sep=",")


Tennessee_shallow_2004_donut_plot_rounded <- Tennessee_shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2004_donut_plot_test <- cbind(Tennessee_shallow_2004_donut_plot_rounded,Legend)


Tennessee_shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Tennessee_shallow_2004.png", width = 6, height = 6)




Tennessee_shallow_2005 <- filter(Tennessee_shallow_plot, Year == 2005)
Tennessee_shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2005_t <- t(Tennessee_shallow_2005)

Tennessee_shallow_2005_donut <- data.frame(Tennessee_shallow_2005_t)
colnames(Tennessee_shallow_2005_donut) <- c("Value")
Tennessee_shallow_2005_donut <- Tennessee_shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2005_donut,"Tennessee_shallow_2005.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2005_donut_plot <- read.table("Tennessee_shallow_2005.csv", header=TRUE, sep=",")


Tennessee_shallow_2005_donut_plot_rounded <- Tennessee_shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2005_donut_plot_test <- cbind(Tennessee_shallow_2005_donut_plot_rounded,Legend)


Tennessee_shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2005.png", width = 6, height = 6)





Tennessee_shallow_2006 <- filter(Tennessee_shallow_plot, Year == 2006)
Tennessee_shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2006_t <- t(Tennessee_shallow_2006)

Tennessee_shallow_2006_donut <- data.frame(Tennessee_shallow_2006_t)
colnames(Tennessee_shallow_2006_donut) <- c("Value")
Tennessee_shallow_2006_donut <- Tennessee_shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2006_donut,"Tennessee_shallow_2006.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2006_donut_plot <- read.table("Tennessee_shallow_2006.csv", header=TRUE, sep=",")


Tennessee_shallow_2006_donut_plot_rounded <- Tennessee_shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2006_donut_plot_test <- cbind(Tennessee_shallow_2006_donut_plot_rounded,Legend)


Tennessee_shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2006.png", width = 6, height = 6)




Tennessee_shallow_2007 <- filter(Tennessee_shallow_plot, Year == 2007)
Tennessee_shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2007_t <- t(Tennessee_shallow_2007)

Tennessee_shallow_2007_donut <- data.frame(Tennessee_shallow_2007_t)
colnames(Tennessee_shallow_2007_donut) <- c("Value")
Tennessee_shallow_2007_donut <- Tennessee_shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2007_donut,"Tennessee_shallow_2007.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2007_donut_plot <- read.table("Tennessee_shallow_2007.csv", header=TRUE, sep=",")


Tennessee_shallow_2007_donut_plot_rounded <- Tennessee_shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2007_donut_plot_test <- cbind(Tennessee_shallow_2007_donut_plot_rounded,Legend)


Tennessee_shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2007.png", width = 6, height = 6)




Tennessee_shallow_2008 <- filter(Tennessee_shallow_plot, Year == 2008)
Tennessee_shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2008_t <- t(Tennessee_shallow_2008)

Tennessee_shallow_2008_donut <- data.frame(Tennessee_shallow_2008_t)
colnames(Tennessee_shallow_2008_donut) <- c("Value")
Tennessee_shallow_2008_donut <- Tennessee_shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2008_donut,"Tennessee_shallow_2008.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2008_donut_plot <- read.table("Tennessee_shallow_2008.csv", header=TRUE, sep=",")


Tennessee_shallow_2008_donut_plot_rounded <- Tennessee_shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2008_donut_plot_test <- cbind(Tennessee_shallow_2008_donut_plot_rounded,Legend)


Tennessee_shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2008.png", width = 6, height = 6)




Tennessee_shallow_2009 <- filter(Tennessee_shallow_plot, Year == 2009)
Tennessee_shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2009_t <- t(Tennessee_shallow_2009)

Tennessee_shallow_2009_donut <- data.frame(Tennessee_shallow_2009_t)
colnames(Tennessee_shallow_2009_donut) <- c("Value")
Tennessee_shallow_2009_donut <- Tennessee_shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2009_donut,"Tennessee_shallow_2009.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2009_donut_plot <- read.table("Tennessee_shallow_2009.csv", header=TRUE, sep=",")


Tennessee_shallow_2009_donut_plot_rounded <- Tennessee_shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2009_donut_plot_test <- cbind(Tennessee_shallow_2009_donut_plot_rounded,Legend)


Tennessee_shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2009.png", width = 6, height = 6)




Tennessee_shallow_2010 <- filter(Tennessee_shallow_plot, Year == 2010)
Tennessee_shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2010_t <- t(Tennessee_shallow_2010)

Tennessee_shallow_2010_donut <- data.frame(Tennessee_shallow_2010_t)
colnames(Tennessee_shallow_2010_donut) <- c("Value")
Tennessee_shallow_2010_donut <- Tennessee_shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2010_donut,"Tennessee_shallow_2010.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2010_donut_plot <- read.table("Tennessee_shallow_2010.csv", header=TRUE, sep=",")


Tennessee_shallow_2010_donut_plot_rounded <- Tennessee_shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2010_donut_plot_test <- cbind(Tennessee_shallow_2010_donut_plot_rounded,Legend)


Tennessee_shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Tennessee_shallow_2010.png", width = 6, height = 6)




Tennessee_shallow_2011 <- filter(Tennessee_shallow_plot, Year == 2011)
Tennessee_shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2011_t <- t(Tennessee_shallow_2011)

Tennessee_shallow_2011_donut <- data.frame(Tennessee_shallow_2011_t)
colnames(Tennessee_shallow_2011_donut) <- c("Value")
Tennessee_shallow_2011_donut <- Tennessee_shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2011_donut,"Tennessee_shallow_2011.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2011_donut_plot <- read.table("Tennessee_shallow_2011.csv", header=TRUE, sep=",")


Tennessee_shallow_2011_donut_plot_rounded <- Tennessee_shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2011_donut_plot_test <- cbind(Tennessee_shallow_2011_donut_plot_rounded,Legend)


Tennessee_shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2011.png", width = 6, height = 6)





Tennessee_shallow_2012 <- filter(Tennessee_shallow_plot, Year == 2012)
Tennessee_shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2012_t <- t(Tennessee_shallow_2012)

Tennessee_shallow_2012_donut <- data.frame(Tennessee_shallow_2012_t)
colnames(Tennessee_shallow_2012_donut) <- c("Value")
Tennessee_shallow_2012_donut <- Tennessee_shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2012_donut,"Tennessee_shallow_2012.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2012_donut_plot <- read.table("Tennessee_shallow_2012.csv", header=TRUE, sep=",")


Tennessee_shallow_2012_donut_plot_rounded <- Tennessee_shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2012_donut_plot_test <- cbind(Tennessee_shallow_2012_donut_plot_rounded,Legend)


Tennessee_shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2012.png", width = 6, height = 6)






Tennessee_shallow_2014 <- filter(Tennessee_shallow_plot, Year == 2014)
Tennessee_shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2014_t <- t(Tennessee_shallow_2014)

Tennessee_shallow_2014_donut <- data.frame(Tennessee_shallow_2014_t)
colnames(Tennessee_shallow_2014_donut) <- c("Value")
Tennessee_shallow_2014_donut <- Tennessee_shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2014_donut,"Tennessee_shallow_2014.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2014_donut_plot <- read.table("Tennessee_shallow_2014.csv", header=TRUE, sep=",")


Tennessee_shallow_2014_donut_plot_rounded <- Tennessee_shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2014_donut_plot_test <- cbind(Tennessee_shallow_2014_donut_plot_rounded,Legend)


Tennessee_shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2014.png", width = 6, height = 6)





Tennessee_shallow_2016 <- filter(Tennessee_shallow_plot, Year == 2016)
Tennessee_shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Tennessee_shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2016_t <- t(Tennessee_shallow_2016)

Tennessee_shallow_2016_donut <- data.frame(Tennessee_shallow_2016_t)
colnames(Tennessee_shallow_2016_donut) <- c("Value")
Tennessee_shallow_2016_donut <- Tennessee_shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Tennessee_shallow_2016_donut,"Tennessee_shallow_2016.csv")


### import as csv (change category and value to the two column names)

Tennessee_shallow_2016_donut_plot <- read.table("Tennessee_shallow_2016.csv", header=TRUE, sep=",")


Tennessee_shallow_2016_donut_plot_rounded <- Tennessee_shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Tennessee_shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Tennessee_shallow_2016_donut_plot_test <- cbind(Tennessee_shallow_2016_donut_plot_rounded,Legend)


Tennessee_shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Tennessee Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Tennessee_shallow_2016.png", width = 6, height = 6)









West_turtle_shoal <- filter(RVC_CREMP, sitename == "West Turtle Shoal")

## Make percentages of sum, stony coral cover, and macroalgae

West_turtle_shoal_fish <- West_turtle_shoal$sum/max(West_turtle_shoal$sum)
West_turtle_shoal_biomass <- data.frame(West_turtle_shoal_fish)

West_turtle_shoal_biomass <- 100*West_turtle_shoal_biomass


West_turtle_shoal_Stony <- West_turtle_shoal$Stony_coral/max(West_turtle_shoal$Stony_coral)
West_turtle_shoal_coral <- data.frame(West_turtle_shoal_Stony)

West_turtle_shoal_stony_coral <- 100*West_turtle_shoal_coral

West_turtle_shoal_macro <- West_turtle_shoal$Macroalgae/max(West_turtle_shoal$Macroalgae)
West_turtle_shoal_algae <- data.frame(West_turtle_shoal_macro)


West_turtle_shoal_macroalgae <- (100*West_turtle_shoal_algae)


West_turtle_shoal_plot <- cbind(West_turtle_shoal_macroalgae,West_turtle_shoal_biomass,West_turtle_shoal_stony_coral)

West_turtle_shoal_plot$Year <- c("1999","2000","2001","2002","2003","2005","2006","2007","2008","2009","2010","2012","2014")

### Filter per year

West_turtle_shoal_1999 <- filter(West_turtle_shoal_plot, Year == 1999)
West_turtle_shoal_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_1999_t <- t(West_turtle_shoal_1999)

West_turtle_shoal_1999_donut <- data.frame(West_turtle_shoal_1999_t)
colnames(West_turtle_shoal_1999_donut) <- c("Value")
West_turtle_shoal_1999_donut <- West_turtle_shoal_1999_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_1999_donut,"West_turtle_shoal_1999.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_1999_donut_plot <- read.table("West_turtle_shoal_1999.csv", header=TRUE, sep=",")


West_turtle_shoal_1999_donut_plot_rounded <- West_turtle_shoal_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_1999_donut_plot_test <- cbind(West_turtle_shoal_1999_donut_plot_rounded,Legend)


West_turtle_shoal_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/West_turtle_shoal_1999.png", width = 6, height = 6)



### West Turtle Shoal


West_turtle_shoal_2000 <- filter(West_turtle_shoal_plot, Year == 2000)
West_turtle_shoal_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2000_t <- t(West_turtle_shoal_2000)

West_turtle_shoal_2000_donut <- data.frame(West_turtle_shoal_2000_t)
colnames(West_turtle_shoal_2000_donut) <- c("Value")
West_turtle_shoal_2000_donut <- West_turtle_shoal_2000_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2000_donut,"West_turtle_shoal_2000.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2000_donut_plot <- read.table("West_turtle_shoal_2000.csv", header=TRUE, sep=",")


West_turtle_shoal_2000_donut_plot_rounded <- West_turtle_shoal_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2000_donut_plot_test <- cbind(West_turtle_shoal_2000_donut_plot_rounded,Legend)


West_turtle_shoal_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2000.png", width = 6, height = 6)




West_turtle_shoal_2001 <- filter(West_turtle_shoal_plot, Year == 2001)
West_turtle_shoal_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2001_t <- t(West_turtle_shoal_2001)

West_turtle_shoal_2001_donut <- data.frame(West_turtle_shoal_2001_t)
colnames(West_turtle_shoal_2001_donut) <- c("Value")
West_turtle_shoal_2001_donut <- West_turtle_shoal_2001_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2001_donut,"West_turtle_shoal_2001.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2001_donut_plot <- read.table("West_turtle_shoal_2001.csv", header=TRUE, sep=",")


West_turtle_shoal_2001_donut_plot_rounded <- West_turtle_shoal_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2001_donut_plot_test <- cbind(West_turtle_shoal_2001_donut_plot_rounded,Legend)


West_turtle_shoal_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2001.png", width = 6, height = 6)





West_turtle_shoal_2002 <- filter(West_turtle_shoal_plot, Year == 2002)
West_turtle_shoal_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2002_t <- t(West_turtle_shoal_2002)

West_turtle_shoal_2002_donut <- data.frame(West_turtle_shoal_2002_t)
colnames(West_turtle_shoal_2002_donut) <- c("Value")
West_turtle_shoal_2002_donut <- West_turtle_shoal_2002_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2002_donut,"West_turtle_shoal_2002.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2002_donut_plot <- read.table("West_turtle_shoal_2002.csv", header=TRUE, sep=",")


West_turtle_shoal_2002_donut_plot_rounded <- West_turtle_shoal_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2002_donut_plot_test <- cbind(West_turtle_shoal_2002_donut_plot_rounded,Legend)


West_turtle_shoal_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2002.png", width = 6, height = 6)



West_turtle_shoal_2003 <- filter(West_turtle_shoal_plot, Year == 2003)
West_turtle_shoal_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2003_t <- t(West_turtle_shoal_2003)

West_turtle_shoal_2003_donut <- data.frame(West_turtle_shoal_2003_t)
colnames(West_turtle_shoal_2003_donut) <- c("Value")
West_turtle_shoal_2003_donut <- West_turtle_shoal_2003_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2003_donut,"West_turtle_shoal_2003.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2003_donut_plot <- read.table("West_turtle_shoal_2003.csv", header=TRUE, sep=",")


West_turtle_shoal_2003_donut_plot_rounded <- West_turtle_shoal_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2003_donut_plot_test <- cbind(West_turtle_shoal_2003_donut_plot_rounded,Legend)


West_turtle_shoal_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2003.png", width = 6, height = 6)




West_turtle_shoal_2004 <- filter(West_turtle_shoal_plot, Year == 2004)
West_turtle_shoal_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2004_t <- t(West_turtle_shoal_2004)

West_turtle_shoal_2004_donut <- data.frame(West_turtle_shoal_2004_t)
colnames(West_turtle_shoal_2004_donut) <- c("Value")
West_turtle_shoal_2004_donut <- West_turtle_shoal_2004_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2004_donut,"West_turtle_shoal_2004.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2004_donut_plot <- read.table("West_turtle_shoal_2004.csv", header=TRUE, sep=",")


West_turtle_shoal_2004_donut_plot_rounded <- West_turtle_shoal_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2004_donut_plot_test <- cbind(West_turtle_shoal_2004_donut_plot_rounded,Legend)


West_turtle_shoal_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/West_turtle_shoal_2004.png", width = 6, height = 6)




West_turtle_shoal_2005 <- filter(West_turtle_shoal_plot, Year == 2005)
West_turtle_shoal_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2005_t <- t(West_turtle_shoal_2005)

West_turtle_shoal_2005_donut <- data.frame(West_turtle_shoal_2005_t)
colnames(West_turtle_shoal_2005_donut) <- c("Value")
West_turtle_shoal_2005_donut <- West_turtle_shoal_2005_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2005_donut,"West_turtle_shoal_2005.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2005_donut_plot <- read.table("West_turtle_shoal_2005.csv", header=TRUE, sep=",")


West_turtle_shoal_2005_donut_plot_rounded <- West_turtle_shoal_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2005_donut_plot_test <- cbind(West_turtle_shoal_2005_donut_plot_rounded,Legend)


West_turtle_shoal_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2005.png", width = 6, height = 6)





West_turtle_shoal_2006 <- filter(West_turtle_shoal_plot, Year == 2006)
West_turtle_shoal_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2006_t <- t(West_turtle_shoal_2006)

West_turtle_shoal_2006_donut <- data.frame(West_turtle_shoal_2006_t)
colnames(West_turtle_shoal_2006_donut) <- c("Value")
West_turtle_shoal_2006_donut <- West_turtle_shoal_2006_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2006_donut,"West_turtle_shoal_2006.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2006_donut_plot <- read.table("West_turtle_shoal_2006.csv", header=TRUE, sep=",")


West_turtle_shoal_2006_donut_plot_rounded <- West_turtle_shoal_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2006_donut_plot_test <- cbind(West_turtle_shoal_2006_donut_plot_rounded,Legend)


West_turtle_shoal_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/West_turtle_shoal_2006.png", width = 6, height = 6)




West_turtle_shoal_2007 <- filter(West_turtle_shoal_plot, Year == 2007)
West_turtle_shoal_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2007_t <- t(West_turtle_shoal_2007)

West_turtle_shoal_2007_donut <- data.frame(West_turtle_shoal_2007_t)
colnames(West_turtle_shoal_2007_donut) <- c("Value")
West_turtle_shoal_2007_donut <- West_turtle_shoal_2007_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2007_donut,"West_turtle_shoal_2007.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2007_donut_plot <- read.table("West_turtle_shoal_2007.csv", header=TRUE, sep=",")


West_turtle_shoal_2007_donut_plot_rounded <- West_turtle_shoal_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2007_donut_plot_test <- cbind(West_turtle_shoal_2007_donut_plot_rounded,Legend)


West_turtle_shoal_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2007.png", width = 6, height = 6)




West_turtle_shoal_2008 <- filter(West_turtle_shoal_plot, Year == 2008)
West_turtle_shoal_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2008_t <- t(West_turtle_shoal_2008)

West_turtle_shoal_2008_donut <- data.frame(West_turtle_shoal_2008_t)
colnames(West_turtle_shoal_2008_donut) <- c("Value")
West_turtle_shoal_2008_donut <- West_turtle_shoal_2008_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2008_donut,"West_turtle_shoal_2008.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2008_donut_plot <- read.table("West_turtle_shoal_2008.csv", header=TRUE, sep=",")


West_turtle_shoal_2008_donut_plot_rounded <- West_turtle_shoal_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2008_donut_plot_test <- cbind(West_turtle_shoal_2008_donut_plot_rounded,Legend)


West_turtle_shoal_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2008.png", width = 6, height = 6)




West_turtle_shoal_2009 <- filter(West_turtle_shoal_plot, Year == 2009)
West_turtle_shoal_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2009_t <- t(West_turtle_shoal_2009)

West_turtle_shoal_2009_donut <- data.frame(West_turtle_shoal_2009_t)
colnames(West_turtle_shoal_2009_donut) <- c("Value")
West_turtle_shoal_2009_donut <- West_turtle_shoal_2009_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2009_donut,"West_turtle_shoal_2009.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2009_donut_plot <- read.table("West_turtle_shoal_2009.csv", header=TRUE, sep=",")


West_turtle_shoal_2009_donut_plot_rounded <- West_turtle_shoal_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2009_donut_plot_test <- cbind(West_turtle_shoal_2009_donut_plot_rounded,Legend)


West_turtle_shoal_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2009.png", width = 6, height = 6)




West_turtle_shoal_2010 <- filter(West_turtle_shoal_plot, Year == 2010)
West_turtle_shoal_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2010_t <- t(West_turtle_shoal_2010)

West_turtle_shoal_2010_donut <- data.frame(West_turtle_shoal_2010_t)
colnames(West_turtle_shoal_2010_donut) <- c("Value")
West_turtle_shoal_2010_donut <- West_turtle_shoal_2010_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2010_donut,"West_turtle_shoal_2010.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2010_donut_plot <- read.table("West_turtle_shoal_2010.csv", header=TRUE, sep=",")


West_turtle_shoal_2010_donut_plot_rounded <- West_turtle_shoal_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2010_donut_plot_test <- cbind(West_turtle_shoal_2010_donut_plot_rounded,Legend)


West_turtle_shoal_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2010.png", width = 6, height = 6)




West_turtle_shoal_2011 <- filter(West_turtle_shoal_plot, Year == 2011)
West_turtle_shoal_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2011_t <- t(West_turtle_shoal_2011)

West_turtle_shoal_2011_donut <- data.frame(West_turtle_shoal_2011_t)
colnames(West_turtle_shoal_2011_donut) <- c("Value")
West_turtle_shoal_2011_donut <- West_turtle_shoal_2011_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2011_donut,"West_turtle_shoal_2011.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2011_donut_plot <- read.table("West_turtle_shoal_2011.csv", header=TRUE, sep=",")


West_turtle_shoal_2011_donut_plot_rounded <- West_turtle_shoal_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2011_donut_plot_test <- cbind(West_turtle_shoal_2011_donut_plot_rounded,Legend)


West_turtle_shoal_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/West_turtle_shoal_2011.png", width = 6, height = 6)





West_turtle_shoal_2012 <- filter(West_turtle_shoal_plot, Year == 2012)
West_turtle_shoal_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2012_t <- t(West_turtle_shoal_2012)

West_turtle_shoal_2012_donut <- data.frame(West_turtle_shoal_2012_t)
colnames(West_turtle_shoal_2012_donut) <- c("Value")
West_turtle_shoal_2012_donut <- West_turtle_shoal_2012_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2012_donut,"West_turtle_shoal_2012.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2012_donut_plot <- read.table("West_turtle_shoal_2012.csv", header=TRUE, sep=",")


West_turtle_shoal_2012_donut_plot_rounded <- West_turtle_shoal_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2012_donut_plot_test <- cbind(West_turtle_shoal_2012_donut_plot_rounded,Legend)


West_turtle_shoal_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2012.png", width = 6, height = 6)






West_turtle_shoal_2014 <- filter(West_turtle_shoal_plot, Year == 2014)
West_turtle_shoal_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2014_t <- t(West_turtle_shoal_2014)

West_turtle_shoal_2014_donut <- data.frame(West_turtle_shoal_2014_t)
colnames(West_turtle_shoal_2014_donut) <- c("Value")
West_turtle_shoal_2014_donut <- West_turtle_shoal_2014_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2014_donut,"West_turtle_shoal_2014.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2014_donut_plot <- read.table("West_turtle_shoal_2014.csv", header=TRUE, sep=",")


West_turtle_shoal_2014_donut_plot_rounded <- West_turtle_shoal_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2014_donut_plot_test <- cbind(West_turtle_shoal_2014_donut_plot_rounded,Legend)


West_turtle_shoal_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/West_turtle_shoal_2014.png", width = 6, height = 6)





West_turtle_shoal_2016 <- filter(West_turtle_shoal_plot, Year == 2016)
West_turtle_shoal_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(West_turtle_shoal_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2016_t <- t(West_turtle_shoal_2016)

West_turtle_shoal_2016_donut <- data.frame(West_turtle_shoal_2016_t)
colnames(West_turtle_shoal_2016_donut) <- c("Value")
West_turtle_shoal_2016_donut <- West_turtle_shoal_2016_donut %>%
  rownames_to_column(var = "Category")


export(West_turtle_shoal_2016_donut,"West_turtle_shoal_2016.csv")


### import as csv (change category and value to the two column names)

West_turtle_shoal_2016_donut_plot <- read.table("West_turtle_shoal_2016.csv", header=TRUE, sep=",")


West_turtle_shoal_2016_donut_plot_rounded <- West_turtle_shoal_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
West_turtle_shoal_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
West_turtle_shoal_2016_donut_plot_test <- cbind(West_turtle_shoal_2016_donut_plot_rounded,Legend)


West_turtle_shoal_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "West Turtle Shoal 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/West_turtle_shoal_2016.png", width = 6, height = 6)





setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/MK/plots")


library(gridExtra)
library(png)
library(grid)

pdf('MK.pdf')
lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  grid.newpage()
  grid.raster(img, interpolate = FALSE)
  
})
dev.off()

plots <- lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  rasterGrob(img, interpolate = FALSE)
})

ggsave("MK_combined.pdf", marrangeGrob(grobs=plots, nrow=2, ncol=4))




















#### Lower Keys 


setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/LK")


Eastern_Sambo_Deep <- filter(RVC_CREMP, sitename == "Eastern Sambo Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Eastern_Sambo_Deep_fish <- Eastern_Sambo_Deep$sum/max(Eastern_Sambo_Deep$sum)
Eastern_Sambo_Deep_biomass <- data.frame(Eastern_Sambo_Deep_fish)

Eastern_Sambo_Deep_biomass <- 100*Eastern_Sambo_Deep_biomass


Eastern_Sambo_Deep_Stony <- Eastern_Sambo_Deep$Stony_coral/max(Eastern_Sambo_Deep$Stony_coral)
Eastern_Sambo_Deep_coral <- data.frame(Eastern_Sambo_Deep_Stony)

Eastern_Sambo_Deep_stony_coral <- 100*Eastern_Sambo_Deep_coral

Eastern_Sambo_Deep_macro <- Eastern_Sambo_Deep$Macroalgae/max(Eastern_Sambo_Deep$Macroalgae)
Eastern_Sambo_Deep_algae <- data.frame(Eastern_Sambo_Deep_macro)


Eastern_Sambo_Deep_macroalgae <- (100*Eastern_Sambo_Deep_algae)


Eastern_Sambo_Deep_plot <- cbind(Eastern_Sambo_Deep_macroalgae,Eastern_Sambo_Deep_biomass,Eastern_Sambo_Deep_stony_coral)

Eastern_Sambo_Deep_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2014","2016")

### Filter per year

Eastern_Sambo_Deep_1999 <- filter(Eastern_Sambo_Deep_plot, Year == 1999)
Eastern_Sambo_Deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_1999_t <- t(Eastern_Sambo_Deep_1999)

Eastern_Sambo_Deep_1999_donut <- data.frame(Eastern_Sambo_Deep_1999_t)
colnames(Eastern_Sambo_Deep_1999_donut) <- c("Value")
Eastern_Sambo_Deep_1999_donut <- Eastern_Sambo_Deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_1999_donut,"Eastern_Sambo_Deep_1999.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_1999_donut_plot <- read.table("Eastern_Sambo_Deep_1999.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_1999_donut_plot_rounded <- Eastern_Sambo_Deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_1999_donut_plot_test <- cbind(Eastern_Sambo_Deep_1999_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_1999.png", width = 6, height = 6)



### Eastern Sambo Deep


Eastern_Sambo_Deep_2000 <- filter(Eastern_Sambo_Deep_plot, Year == 2000)
Eastern_Sambo_Deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2000_t <- t(Eastern_Sambo_Deep_2000)

Eastern_Sambo_Deep_2000_donut <- data.frame(Eastern_Sambo_Deep_2000_t)
colnames(Eastern_Sambo_Deep_2000_donut) <- c("Value")
Eastern_Sambo_Deep_2000_donut <- Eastern_Sambo_Deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2000_donut,"Eastern_Sambo_Deep_2000.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2000_donut_plot <- read.table("Eastern_Sambo_Deep_2000.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2000_donut_plot_rounded <- Eastern_Sambo_Deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2000_donut_plot_test <- cbind(Eastern_Sambo_Deep_2000_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2000.png", width = 6, height = 6)




Eastern_Sambo_Deep_2001 <- filter(Eastern_Sambo_Deep_plot, Year == 2001)
Eastern_Sambo_Deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2001_t <- t(Eastern_Sambo_Deep_2001)

Eastern_Sambo_Deep_2001_donut <- data.frame(Eastern_Sambo_Deep_2001_t)
colnames(Eastern_Sambo_Deep_2001_donut) <- c("Value")
Eastern_Sambo_Deep_2001_donut <- Eastern_Sambo_Deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2001_donut,"Eastern_Sambo_Deep_2001.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2001_donut_plot <- read.table("Eastern_Sambo_Deep_2001.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2001_donut_plot_rounded <- Eastern_Sambo_Deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2001_donut_plot_test <- cbind(Eastern_Sambo_Deep_2001_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2001.png", width = 6, height = 6)





Eastern_Sambo_Deep_2002 <- filter(Eastern_Sambo_Deep_plot, Year == 2002)
Eastern_Sambo_Deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2002_t <- t(Eastern_Sambo_Deep_2002)

Eastern_Sambo_Deep_2002_donut <- data.frame(Eastern_Sambo_Deep_2002_t)
colnames(Eastern_Sambo_Deep_2002_donut) <- c("Value")
Eastern_Sambo_Deep_2002_donut <- Eastern_Sambo_Deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2002_donut,"Eastern_Sambo_Deep_2002.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2002_donut_plot <- read.table("Eastern_Sambo_Deep_2002.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2002_donut_plot_rounded <- Eastern_Sambo_Deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2002_donut_plot_test <- cbind(Eastern_Sambo_Deep_2002_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2002.png", width = 6, height = 6)



Eastern_Sambo_Deep_2003 <- filter(Eastern_Sambo_Deep_plot, Year == 2003)
Eastern_Sambo_Deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2003_t <- t(Eastern_Sambo_Deep_2003)

Eastern_Sambo_Deep_2003_donut <- data.frame(Eastern_Sambo_Deep_2003_t)
colnames(Eastern_Sambo_Deep_2003_donut) <- c("Value")
Eastern_Sambo_Deep_2003_donut <- Eastern_Sambo_Deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2003_donut,"Eastern_Sambo_Deep_2003.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2003_donut_plot <- read.table("Eastern_Sambo_Deep_2003.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2003_donut_plot_rounded <- Eastern_Sambo_Deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2003_donut_plot_test <- cbind(Eastern_Sambo_Deep_2003_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2003.png", width = 6, height = 6)




Eastern_Sambo_Deep_2004 <- filter(Eastern_Sambo_Deep_plot, Year == 2004)
Eastern_Sambo_Deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2004_t <- t(Eastern_Sambo_Deep_2004)

Eastern_Sambo_Deep_2004_donut <- data.frame(Eastern_Sambo_Deep_2004_t)
colnames(Eastern_Sambo_Deep_2004_donut) <- c("Value")
Eastern_Sambo_Deep_2004_donut <- Eastern_Sambo_Deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2004_donut,"Eastern_Sambo_Deep_2004.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2004_donut_plot <- read.table("Eastern_Sambo_Deep_2004.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2004_donut_plot_rounded <- Eastern_Sambo_Deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2004_donut_plot_test <- cbind(Eastern_Sambo_Deep_2004_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2004.png", width = 6, height = 6)




Eastern_Sambo_Deep_2005 <- filter(Eastern_Sambo_Deep_plot, Year == 2005)
Eastern_Sambo_Deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2005_t <- t(Eastern_Sambo_Deep_2005)

Eastern_Sambo_Deep_2005_donut <- data.frame(Eastern_Sambo_Deep_2005_t)
colnames(Eastern_Sambo_Deep_2005_donut) <- c("Value")
Eastern_Sambo_Deep_2005_donut <- Eastern_Sambo_Deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2005_donut,"Eastern_Sambo_Deep_2005.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2005_donut_plot <- read.table("Eastern_Sambo_Deep_2005.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2005_donut_plot_rounded <- Eastern_Sambo_Deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2005_donut_plot_test <- cbind(Eastern_Sambo_Deep_2005_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2005.png", width = 6, height = 6)





Eastern_Sambo_Deep_2006 <- filter(Eastern_Sambo_Deep_plot, Year == 2006)
Eastern_Sambo_Deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2006_t <- t(Eastern_Sambo_Deep_2006)

Eastern_Sambo_Deep_2006_donut <- data.frame(Eastern_Sambo_Deep_2006_t)
colnames(Eastern_Sambo_Deep_2006_donut) <- c("Value")
Eastern_Sambo_Deep_2006_donut <- Eastern_Sambo_Deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2006_donut,"Eastern_Sambo_Deep_2006.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2006_donut_plot <- read.table("Eastern_Sambo_Deep_2006.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2006_donut_plot_rounded <- Eastern_Sambo_Deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2006_donut_plot_test <- cbind(Eastern_Sambo_Deep_2006_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2006.png", width = 6, height = 6)




Eastern_Sambo_Deep_2007 <- filter(Eastern_Sambo_Deep_plot, Year == 2007)
Eastern_Sambo_Deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2007_t <- t(Eastern_Sambo_Deep_2007)

Eastern_Sambo_Deep_2007_donut <- data.frame(Eastern_Sambo_Deep_2007_t)
colnames(Eastern_Sambo_Deep_2007_donut) <- c("Value")
Eastern_Sambo_Deep_2007_donut <- Eastern_Sambo_Deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2007_donut,"Eastern_Sambo_Deep_2007.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2007_donut_plot <- read.table("Eastern_Sambo_Deep_2007.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2007_donut_plot_rounded <- Eastern_Sambo_Deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2007_donut_plot_test <- cbind(Eastern_Sambo_Deep_2007_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2007.png", width = 6, height = 6)




Eastern_Sambo_Deep_2008 <- filter(Eastern_Sambo_Deep_plot, Year == 2008)
Eastern_Sambo_Deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2008_t <- t(Eastern_Sambo_Deep_2008)

Eastern_Sambo_Deep_2008_donut <- data.frame(Eastern_Sambo_Deep_2008_t)
colnames(Eastern_Sambo_Deep_2008_donut) <- c("Value")
Eastern_Sambo_Deep_2008_donut <- Eastern_Sambo_Deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2008_donut,"Eastern_Sambo_Deep_2008.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2008_donut_plot <- read.table("Eastern_Sambo_Deep_2008.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2008_donut_plot_rounded <- Eastern_Sambo_Deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2008_donut_plot_test <- cbind(Eastern_Sambo_Deep_2008_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2008.png", width = 6, height = 6)




Eastern_Sambo_Deep_2009 <- filter(Eastern_Sambo_Deep_plot, Year == 2009)
Eastern_Sambo_Deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2009_t <- t(Eastern_Sambo_Deep_2009)

Eastern_Sambo_Deep_2009_donut <- data.frame(Eastern_Sambo_Deep_2009_t)
colnames(Eastern_Sambo_Deep_2009_donut) <- c("Value")
Eastern_Sambo_Deep_2009_donut <- Eastern_Sambo_Deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2009_donut,"Eastern_Sambo_Deep_2009.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2009_donut_plot <- read.table("Eastern_Sambo_Deep_2009.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2009_donut_plot_rounded <- Eastern_Sambo_Deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2009_donut_plot_test <- cbind(Eastern_Sambo_Deep_2009_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2009.png", width = 6, height = 6)




Eastern_Sambo_Deep_2010 <- filter(Eastern_Sambo_Deep_plot, Year == 2010)
Eastern_Sambo_Deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2010_t <- t(Eastern_Sambo_Deep_2010)

Eastern_Sambo_Deep_2010_donut <- data.frame(Eastern_Sambo_Deep_2010_t)
colnames(Eastern_Sambo_Deep_2010_donut) <- c("Value")
Eastern_Sambo_Deep_2010_donut <- Eastern_Sambo_Deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2010_donut,"Eastern_Sambo_Deep_2010.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2010_donut_plot <- read.table("Eastern_Sambo_Deep_2010.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2010_donut_plot_rounded <- Eastern_Sambo_Deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2010_donut_plot_test <- cbind(Eastern_Sambo_Deep_2010_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2010.png", width = 6, height = 6)




Eastern_Sambo_Deep_2011 <- filter(Eastern_Sambo_Deep_plot, Year == 2011)
Eastern_Sambo_Deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2011_t <- t(Eastern_Sambo_Deep_2011)

Eastern_Sambo_Deep_2011_donut <- data.frame(Eastern_Sambo_Deep_2011_t)
colnames(Eastern_Sambo_Deep_2011_donut) <- c("Value")
Eastern_Sambo_Deep_2011_donut <- Eastern_Sambo_Deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2011_donut,"Eastern_Sambo_Deep_2011.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2011_donut_plot <- read.table("Eastern_Sambo_Deep_2011.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2011_donut_plot_rounded <- Eastern_Sambo_Deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2011_donut_plot_test <- cbind(Eastern_Sambo_Deep_2011_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2011.png", width = 6, height = 6)





Eastern_Sambo_Deep_2012 <- filter(Eastern_Sambo_Deep_plot, Year == 2012)
Eastern_Sambo_Deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2012_t <- t(Eastern_Sambo_Deep_2012)

Eastern_Sambo_Deep_2012_donut <- data.frame(Eastern_Sambo_Deep_2012_t)
colnames(Eastern_Sambo_Deep_2012_donut) <- c("Value")
Eastern_Sambo_Deep_2012_donut <- Eastern_Sambo_Deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2012_donut,"Eastern_Sambo_Deep_2012.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2012_donut_plot <- read.table("Eastern_Sambo_Deep_2012.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2012_donut_plot_rounded <- Eastern_Sambo_Deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2012_donut_plot_test <- cbind(Eastern_Sambo_Deep_2012_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2012.png", width = 6, height = 6)






Eastern_Sambo_Deep_2014 <- filter(Eastern_Sambo_Deep_plot, Year == 2014)
Eastern_Sambo_Deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2014_t <- t(Eastern_Sambo_Deep_2014)

Eastern_Sambo_Deep_2014_donut <- data.frame(Eastern_Sambo_Deep_2014_t)
colnames(Eastern_Sambo_Deep_2014_donut) <- c("Value")
Eastern_Sambo_Deep_2014_donut <- Eastern_Sambo_Deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2014_donut,"Eastern_Sambo_Deep_2014.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2014_donut_plot <- read.table("Eastern_Sambo_Deep_2014.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2014_donut_plot_rounded <- Eastern_Sambo_Deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2014_donut_plot_test <- cbind(Eastern_Sambo_Deep_2014_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2014.png", width = 6, height = 6)




Eastern_Sambo_Deep_2016 <- filter(Eastern_Sambo_Deep_plot, Year == 2016)
Eastern_Sambo_Deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2016_t <- t(Eastern_Sambo_Deep_2016)

Eastern_Sambo_Deep_2016_donut <- data.frame(Eastern_Sambo_Deep_2016_t)
colnames(Eastern_Sambo_Deep_2016_donut) <- c("Value")
Eastern_Sambo_Deep_2016_donut <- Eastern_Sambo_Deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Deep_2016_donut,"Eastern_Sambo_Deep_2016.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Deep_2016_donut_plot <- read.table("Eastern_Sambo_Deep_2016.csv", header=TRUE, sep=",")


Eastern_Sambo_Deep_2016_donut_plot_rounded <- Eastern_Sambo_Deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Deep_2016_donut_plot_test <- cbind(Eastern_Sambo_Deep_2016_donut_plot_rounded,Legend)


Eastern_Sambo_Deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Deep_2016.png", width = 6, height = 6)








Eastern_Sambo_Shallow <- filter(RVC_CREMP, sitename == "Eastern Sambo Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Eastern_Sambo_Shallow_fish <- Eastern_Sambo_Shallow$sum/max(Eastern_Sambo_Shallow$sum)
Eastern_Sambo_Shallow_biomass <- data.frame(Eastern_Sambo_Shallow_fish)

Eastern_Sambo_Shallow_biomass <- 100*Eastern_Sambo_Shallow_biomass


Eastern_Sambo_Shallow_Stony <- Eastern_Sambo_Shallow$Stony_coral/max(Eastern_Sambo_Shallow$Stony_coral)
Eastern_Sambo_Shallow_coral <- data.frame(Eastern_Sambo_Shallow_Stony)

Eastern_Sambo_Shallow_stony_coral <- 100*Eastern_Sambo_Shallow_coral

Eastern_Sambo_Shallow_macro <- Eastern_Sambo_Shallow$Macroalgae/max(Eastern_Sambo_Shallow$Macroalgae)
Eastern_Sambo_Shallow_algae <- data.frame(Eastern_Sambo_Shallow_macro)


Eastern_Sambo_Shallow_macroalgae <- (100*Eastern_Sambo_Shallow_algae)


Eastern_Sambo_Shallow_plot <- cbind(Eastern_Sambo_Shallow_macroalgae,Eastern_Sambo_Shallow_biomass,Eastern_Sambo_Shallow_stony_coral)

Eastern_Sambo_Shallow_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Eastern_Sambo_Shallow_1999 <- filter(Eastern_Sambo_Shallow_plot, Year == 1999)
Eastern_Sambo_Shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_1999_t <- t(Eastern_Sambo_Shallow_1999)

Eastern_Sambo_Shallow_1999_donut <- data.frame(Eastern_Sambo_Shallow_1999_t)
colnames(Eastern_Sambo_Shallow_1999_donut) <- c("Value")
Eastern_Sambo_Shallow_1999_donut <- Eastern_Sambo_Shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_1999_donut,"Eastern_Sambo_Shallow_1999.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_1999_donut_plot <- read.table("Eastern_Sambo_Shallow_1999.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_1999_donut_plot_rounded <- Eastern_Sambo_Shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_1999_donut_plot_test <- cbind(Eastern_Sambo_Shallow_1999_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_1999.png", width = 6, height = 6)



### Eastern Sambo Shallow


Eastern_Sambo_Shallow_2000 <- filter(Eastern_Sambo_Shallow_plot, Year == 2000)
Eastern_Sambo_Shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2000_t <- t(Eastern_Sambo_Shallow_2000)

Eastern_Sambo_Shallow_2000_donut <- data.frame(Eastern_Sambo_Shallow_2000_t)
colnames(Eastern_Sambo_Shallow_2000_donut) <- c("Value")
Eastern_Sambo_Shallow_2000_donut <- Eastern_Sambo_Shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2000_donut,"Eastern_Sambo_Shallow_2000.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2000_donut_plot <- read.table("Eastern_Sambo_Shallow_2000.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2000_donut_plot_rounded <- Eastern_Sambo_Shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2000_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2000_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2000.png", width = 6, height = 6)




Eastern_Sambo_Shallow_2001 <- filter(Eastern_Sambo_Shallow_plot, Year == 2001)
Eastern_Sambo_Shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2001_t <- t(Eastern_Sambo_Shallow_2001)

Eastern_Sambo_Shallow_2001_donut <- data.frame(Eastern_Sambo_Shallow_2001_t)
colnames(Eastern_Sambo_Shallow_2001_donut) <- c("Value")
Eastern_Sambo_Shallow_2001_donut <- Eastern_Sambo_Shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2001_donut,"Eastern_Sambo_Shallow_2001.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2001_donut_plot <- read.table("Eastern_Sambo_Shallow_2001.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2001_donut_plot_rounded <- Eastern_Sambo_Shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2001_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2001_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2001.png", width = 6, height = 6)





Eastern_Sambo_Shallow_2002 <- filter(Eastern_Sambo_Shallow_plot, Year == 2002)
Eastern_Sambo_Shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2002_t <- t(Eastern_Sambo_Shallow_2002)

Eastern_Sambo_Shallow_2002_donut <- data.frame(Eastern_Sambo_Shallow_2002_t)
colnames(Eastern_Sambo_Shallow_2002_donut) <- c("Value")
Eastern_Sambo_Shallow_2002_donut <- Eastern_Sambo_Shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2002_donut,"Eastern_Sambo_Shallow_2002.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2002_donut_plot <- read.table("Eastern_Sambo_Shallow_2002.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2002_donut_plot_rounded <- Eastern_Sambo_Shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2002_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2002_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2002.png", width = 6, height = 6)



Eastern_Sambo_Shallow_2003 <- filter(Eastern_Sambo_Shallow_plot, Year == 2003)
Eastern_Sambo_Shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2003_t <- t(Eastern_Sambo_Shallow_2003)

Eastern_Sambo_Shallow_2003_donut <- data.frame(Eastern_Sambo_Shallow_2003_t)
colnames(Eastern_Sambo_Shallow_2003_donut) <- c("Value")
Eastern_Sambo_Shallow_2003_donut <- Eastern_Sambo_Shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2003_donut,"Eastern_Sambo_Shallow_2003.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2003_donut_plot <- read.table("Eastern_Sambo_Shallow_2003.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2003_donut_plot_rounded <- Eastern_Sambo_Shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2003_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2003_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2003.png", width = 6, height = 6)




Eastern_Sambo_Shallow_2004 <- filter(Eastern_Sambo_Shallow_plot, Year == 2004)
Eastern_Sambo_Shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2004_t <- t(Eastern_Sambo_Shallow_2004)

Eastern_Sambo_Shallow_2004_donut <- data.frame(Eastern_Sambo_Shallow_2004_t)
colnames(Eastern_Sambo_Shallow_2004_donut) <- c("Value")
Eastern_Sambo_Shallow_2004_donut <- Eastern_Sambo_Shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2004_donut,"Eastern_Sambo_Shallow_2004.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2004_donut_plot <- read.table("Eastern_Sambo_Shallow_2004.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2004_donut_plot_rounded <- Eastern_Sambo_Shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2004_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2004_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2004.png", width = 6, height = 6)




Eastern_Sambo_Shallow_2005 <- filter(Eastern_Sambo_Shallow_plot, Year == 2005)
Eastern_Sambo_Shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2005_t <- t(Eastern_Sambo_Shallow_2005)

Eastern_Sambo_Shallow_2005_donut <- data.frame(Eastern_Sambo_Shallow_2005_t)
colnames(Eastern_Sambo_Shallow_2005_donut) <- c("Value")
Eastern_Sambo_Shallow_2005_donut <- Eastern_Sambo_Shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2005_donut,"Eastern_Sambo_Shallow_2005.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2005_donut_plot <- read.table("Eastern_Sambo_Shallow_2005.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2005_donut_plot_rounded <- Eastern_Sambo_Shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2005_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2005_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2005.png", width = 6, height = 6)





Eastern_Sambo_Shallow_2006 <- filter(Eastern_Sambo_Shallow_plot, Year == 2006)
Eastern_Sambo_Shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2006_t <- t(Eastern_Sambo_Shallow_2006)

Eastern_Sambo_Shallow_2006_donut <- data.frame(Eastern_Sambo_Shallow_2006_t)
colnames(Eastern_Sambo_Shallow_2006_donut) <- c("Value")
Eastern_Sambo_Shallow_2006_donut <- Eastern_Sambo_Shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2006_donut,"Eastern_Sambo_Shallow_2006.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2006_donut_plot <- read.table("Eastern_Sambo_Shallow_2006.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2006_donut_plot_rounded <- Eastern_Sambo_Shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2006_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2006_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2006.png", width = 6, height = 6)




Eastern_Sambo_Shallow_2007 <- filter(Eastern_Sambo_Shallow_plot, Year == 2007)
Eastern_Sambo_Shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2007_t <- t(Eastern_Sambo_Shallow_2007)

Eastern_Sambo_Shallow_2007_donut <- data.frame(Eastern_Sambo_Shallow_2007_t)
colnames(Eastern_Sambo_Shallow_2007_donut) <- c("Value")
Eastern_Sambo_Shallow_2007_donut <- Eastern_Sambo_Shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2007_donut,"Eastern_Sambo_Shallow_2007.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2007_donut_plot <- read.table("Eastern_Sambo_Shallow_2007.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2007_donut_plot_rounded <- Eastern_Sambo_Shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2007_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2007_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2007.png", width = 6, height = 6)




Eastern_Sambo_Shallow_2008 <- filter(Eastern_Sambo_Shallow_plot, Year == 2008)
Eastern_Sambo_Shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2008_t <- t(Eastern_Sambo_Shallow_2008)

Eastern_Sambo_Shallow_2008_donut <- data.frame(Eastern_Sambo_Shallow_2008_t)
colnames(Eastern_Sambo_Shallow_2008_donut) <- c("Value")
Eastern_Sambo_Shallow_2008_donut <- Eastern_Sambo_Shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2008_donut,"Eastern_Sambo_Shallow_2008.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2008_donut_plot <- read.table("Eastern_Sambo_Shallow_2008.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2008_donut_plot_rounded <- Eastern_Sambo_Shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2008_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2008_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2008.png", width = 6, height = 6)




Eastern_Sambo_Shallow_2009 <- filter(Eastern_Sambo_Shallow_plot, Year == 2009)
Eastern_Sambo_Shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2009_t <- t(Eastern_Sambo_Shallow_2009)

Eastern_Sambo_Shallow_2009_donut <- data.frame(Eastern_Sambo_Shallow_2009_t)
colnames(Eastern_Sambo_Shallow_2009_donut) <- c("Value")
Eastern_Sambo_Shallow_2009_donut <- Eastern_Sambo_Shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2009_donut,"Eastern_Sambo_Shallow_2009.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2009_donut_plot <- read.table("Eastern_Sambo_Shallow_2009.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2009_donut_plot_rounded <- Eastern_Sambo_Shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2009_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2009_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2009.png", width = 6, height = 6)




Eastern_Sambo_Shallow_2010 <- filter(Eastern_Sambo_Shallow_plot, Year == 2010)
Eastern_Sambo_Shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2010_t <- t(Eastern_Sambo_Shallow_2010)

Eastern_Sambo_Shallow_2010_donut <- data.frame(Eastern_Sambo_Shallow_2010_t)
colnames(Eastern_Sambo_Shallow_2010_donut) <- c("Value")
Eastern_Sambo_Shallow_2010_donut <- Eastern_Sambo_Shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2010_donut,"Eastern_Sambo_Shallow_2010.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2010_donut_plot <- read.table("Eastern_Sambo_Shallow_2010.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2010_donut_plot_rounded <- Eastern_Sambo_Shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2010_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2010_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Eastern_Sambo_Shallow_2010.png", width = 6, height = 6)




Eastern_Sambo_Shallow_2011 <- filter(Eastern_Sambo_Shallow_plot, Year == 2011)
Eastern_Sambo_Shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2011_t <- t(Eastern_Sambo_Shallow_2011)

Eastern_Sambo_Shallow_2011_donut <- data.frame(Eastern_Sambo_Shallow_2011_t)
colnames(Eastern_Sambo_Shallow_2011_donut) <- c("Value")
Eastern_Sambo_Shallow_2011_donut <- Eastern_Sambo_Shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2011_donut,"Eastern_Sambo_Shallow_2011.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2011_donut_plot <- read.table("Eastern_Sambo_Shallow_2011.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2011_donut_plot_rounded <- Eastern_Sambo_Shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2011_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2011_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2011.png", width = 6, height = 6)





Eastern_Sambo_Shallow_2012 <- filter(Eastern_Sambo_Shallow_plot, Year == 2012)
Eastern_Sambo_Shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2012_t <- t(Eastern_Sambo_Shallow_2012)

Eastern_Sambo_Shallow_2012_donut <- data.frame(Eastern_Sambo_Shallow_2012_t)
colnames(Eastern_Sambo_Shallow_2012_donut) <- c("Value")
Eastern_Sambo_Shallow_2012_donut <- Eastern_Sambo_Shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2012_donut,"Eastern_Sambo_Shallow_2012.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2012_donut_plot <- read.table("Eastern_Sambo_Shallow_2012.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2012_donut_plot_rounded <- Eastern_Sambo_Shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2012_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2012_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2012.png", width = 6, height = 6)






Eastern_Sambo_Shallow_2014 <- filter(Eastern_Sambo_Shallow_plot, Year == 2014)
Eastern_Sambo_Shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2014_t <- t(Eastern_Sambo_Shallow_2014)

Eastern_Sambo_Shallow_2014_donut <- data.frame(Eastern_Sambo_Shallow_2014_t)
colnames(Eastern_Sambo_Shallow_2014_donut) <- c("Value")
Eastern_Sambo_Shallow_2014_donut <- Eastern_Sambo_Shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2014_donut,"Eastern_Sambo_Shallow_2014.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2014_donut_plot <- read.table("Eastern_Sambo_Shallow_2014.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2014_donut_plot_rounded <- Eastern_Sambo_Shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2014_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2014_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2014.png", width = 6, height = 6)





Eastern_Sambo_Shallow_2016 <- filter(Eastern_Sambo_Shallow_plot, Year == 2016)
Eastern_Sambo_Shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Eastern_Sambo_Shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2016_t <- t(Eastern_Sambo_Shallow_2016)

Eastern_Sambo_Shallow_2016_donut <- data.frame(Eastern_Sambo_Shallow_2016_t)
colnames(Eastern_Sambo_Shallow_2016_donut) <- c("Value")
Eastern_Sambo_Shallow_2016_donut <- Eastern_Sambo_Shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Eastern_Sambo_Shallow_2016_donut,"Eastern_Sambo_Shallow_2016.csv")


### import as csv (change category and value to the two column names)

Eastern_Sambo_Shallow_2016_donut_plot <- read.table("Eastern_Sambo_Shallow_2016.csv", header=TRUE, sep=",")


Eastern_Sambo_Shallow_2016_donut_plot_rounded <- Eastern_Sambo_Shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Eastern_Sambo_Shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Eastern_Sambo_Shallow_2016_donut_plot_test <- cbind(Eastern_Sambo_Shallow_2016_donut_plot_rounded,Legend)


Eastern_Sambo_Shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Eastern Sambo Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Eastern_Sambo_Shallow_2016.png", width = 6, height = 6)







Looe_Key_Deep <- filter(RVC_CREMP, sitename == "Looe Key Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Looe_Key_Deep_fish <- Looe_Key_Deep$sum/max(Looe_Key_Deep$sum)
Looe_Key_Deep_biomass <- data.frame(Looe_Key_Deep_fish)

Looe_Key_Deep_biomass <- 100*Looe_Key_Deep_biomass


Looe_Key_Deep_Stony <- Looe_Key_Deep$Stony_coral/max(Looe_Key_Deep$Stony_coral)
Looe_Key_Deep_coral <- data.frame(Looe_Key_Deep_Stony)

Looe_Key_Deep_stony_coral <- 100*Looe_Key_Deep_coral

Looe_Key_Deep_macro <- Looe_Key_Deep$Macroalgae/max(Looe_Key_Deep$Macroalgae)
Looe_Key_Deep_algae <- data.frame(Looe_Key_Deep_macro)


Looe_Key_Deep_macroalgae <- (100*Looe_Key_Deep_algae)


Looe_Key_Deep_plot <- cbind(Looe_Key_Deep_macroalgae,Looe_Key_Deep_biomass,Looe_Key_Deep_stony_coral)

Looe_Key_Deep_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Looe_Key_Deep_1999 <- filter(Looe_Key_Deep_plot, Year == 1999)
Looe_Key_Deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_1999_t <- t(Looe_Key_Deep_1999)

Looe_Key_Deep_1999_donut <- data.frame(Looe_Key_Deep_1999_t)
colnames(Looe_Key_Deep_1999_donut) <- c("Value")
Looe_Key_Deep_1999_donut <- Looe_Key_Deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_1999_donut,"Looe_Key_Deep_1999.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_1999_donut_plot <- read.table("Looe_Key_Deep_1999.csv", header=TRUE, sep=",")


Looe_Key_Deep_1999_donut_plot_rounded <- Looe_Key_Deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_1999_donut_plot_test <- cbind(Looe_Key_Deep_1999_donut_plot_rounded,Legend)


Looe_Key_Deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_1999.png", width = 6, height = 6)



### Looe Key Deep


Looe_Key_Deep_2000 <- filter(Looe_Key_Deep_plot, Year == 2000)
Looe_Key_Deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2000_t <- t(Looe_Key_Deep_2000)

Looe_Key_Deep_2000_donut <- data.frame(Looe_Key_Deep_2000_t)
colnames(Looe_Key_Deep_2000_donut) <- c("Value")
Looe_Key_Deep_2000_donut <- Looe_Key_Deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2000_donut,"Looe_Key_Deep_2000.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2000_donut_plot <- read.table("Looe_Key_Deep_2000.csv", header=TRUE, sep=",")


Looe_Key_Deep_2000_donut_plot_rounded <- Looe_Key_Deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2000_donut_plot_test <- cbind(Looe_Key_Deep_2000_donut_plot_rounded,Legend)


Looe_Key_Deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2000.png", width = 6, height = 6)




Looe_Key_Deep_2001 <- filter(Looe_Key_Deep_plot, Year == 2001)
Looe_Key_Deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2001_t <- t(Looe_Key_Deep_2001)

Looe_Key_Deep_2001_donut <- data.frame(Looe_Key_Deep_2001_t)
colnames(Looe_Key_Deep_2001_donut) <- c("Value")
Looe_Key_Deep_2001_donut <- Looe_Key_Deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2001_donut,"Looe_Key_Deep_2001.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2001_donut_plot <- read.table("Looe_Key_Deep_2001.csv", header=TRUE, sep=",")


Looe_Key_Deep_2001_donut_plot_rounded <- Looe_Key_Deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2001_donut_plot_test <- cbind(Looe_Key_Deep_2001_donut_plot_rounded,Legend)


Looe_Key_Deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2001.png", width = 6, height = 6)





Looe_Key_Deep_2002 <- filter(Looe_Key_Deep_plot, Year == 2002)
Looe_Key_Deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2002_t <- t(Looe_Key_Deep_2002)

Looe_Key_Deep_2002_donut <- data.frame(Looe_Key_Deep_2002_t)
colnames(Looe_Key_Deep_2002_donut) <- c("Value")
Looe_Key_Deep_2002_donut <- Looe_Key_Deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2002_donut,"Looe_Key_Deep_2002.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2002_donut_plot <- read.table("Looe_Key_Deep_2002.csv", header=TRUE, sep=",")


Looe_Key_Deep_2002_donut_plot_rounded <- Looe_Key_Deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2002_donut_plot_test <- cbind(Looe_Key_Deep_2002_donut_plot_rounded,Legend)


Looe_Key_Deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2002.png", width = 6, height = 6)



Looe_Key_Deep_2003 <- filter(Looe_Key_Deep_plot, Year == 2003)
Looe_Key_Deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2003_t <- t(Looe_Key_Deep_2003)

Looe_Key_Deep_2003_donut <- data.frame(Looe_Key_Deep_2003_t)
colnames(Looe_Key_Deep_2003_donut) <- c("Value")
Looe_Key_Deep_2003_donut <- Looe_Key_Deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2003_donut,"Looe_Key_Deep_2003.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2003_donut_plot <- read.table("Looe_Key_Deep_2003.csv", header=TRUE, sep=",")


Looe_Key_Deep_2003_donut_plot_rounded <- Looe_Key_Deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2003_donut_plot_test <- cbind(Looe_Key_Deep_2003_donut_plot_rounded,Legend)


Looe_Key_Deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2003.png", width = 6, height = 6)




Looe_Key_Deep_2004 <- filter(Looe_Key_Deep_plot, Year == 2004)
Looe_Key_Deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2004_t <- t(Looe_Key_Deep_2004)

Looe_Key_Deep_2004_donut <- data.frame(Looe_Key_Deep_2004_t)
colnames(Looe_Key_Deep_2004_donut) <- c("Value")
Looe_Key_Deep_2004_donut <- Looe_Key_Deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2004_donut,"Looe_Key_Deep_2004.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2004_donut_plot <- read.table("Looe_Key_Deep_2004.csv", header=TRUE, sep=",")


Looe_Key_Deep_2004_donut_plot_rounded <- Looe_Key_Deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2004_donut_plot_test <- cbind(Looe_Key_Deep_2004_donut_plot_rounded,Legend)


Looe_Key_Deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2004.png", width = 6, height = 6)




Looe_Key_Deep_2005 <- filter(Looe_Key_Deep_plot, Year == 2005)
Looe_Key_Deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2005_t <- t(Looe_Key_Deep_2005)

Looe_Key_Deep_2005_donut <- data.frame(Looe_Key_Deep_2005_t)
colnames(Looe_Key_Deep_2005_donut) <- c("Value")
Looe_Key_Deep_2005_donut <- Looe_Key_Deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2005_donut,"Looe_Key_Deep_2005.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2005_donut_plot <- read.table("Looe_Key_Deep_2005.csv", header=TRUE, sep=",")


Looe_Key_Deep_2005_donut_plot_rounded <- Looe_Key_Deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2005_donut_plot_test <- cbind(Looe_Key_Deep_2005_donut_plot_rounded,Legend)


Looe_Key_Deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2005.png", width = 6, height = 6)





Looe_Key_Deep_2006 <- filter(Looe_Key_Deep_plot, Year == 2006)
Looe_Key_Deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2006_t <- t(Looe_Key_Deep_2006)

Looe_Key_Deep_2006_donut <- data.frame(Looe_Key_Deep_2006_t)
colnames(Looe_Key_Deep_2006_donut) <- c("Value")
Looe_Key_Deep_2006_donut <- Looe_Key_Deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2006_donut,"Looe_Key_Deep_2006.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2006_donut_plot <- read.table("Looe_Key_Deep_2006.csv", header=TRUE, sep=",")


Looe_Key_Deep_2006_donut_plot_rounded <- Looe_Key_Deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2006_donut_plot_test <- cbind(Looe_Key_Deep_2006_donut_plot_rounded,Legend)


Looe_Key_Deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2006.png", width = 6, height = 6)




Looe_Key_Deep_2007 <- filter(Looe_Key_Deep_plot, Year == 2007)
Looe_Key_Deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2007_t <- t(Looe_Key_Deep_2007)

Looe_Key_Deep_2007_donut <- data.frame(Looe_Key_Deep_2007_t)
colnames(Looe_Key_Deep_2007_donut) <- c("Value")
Looe_Key_Deep_2007_donut <- Looe_Key_Deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2007_donut,"Looe_Key_Deep_2007.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2007_donut_plot <- read.table("Looe_Key_Deep_2007.csv", header=TRUE, sep=",")


Looe_Key_Deep_2007_donut_plot_rounded <- Looe_Key_Deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2007_donut_plot_test <- cbind(Looe_Key_Deep_2007_donut_plot_rounded,Legend)


Looe_Key_Deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2007.png", width = 6, height = 6)




Looe_Key_Deep_2008 <- filter(Looe_Key_Deep_plot, Year == 2008)
Looe_Key_Deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2008_t <- t(Looe_Key_Deep_2008)

Looe_Key_Deep_2008_donut <- data.frame(Looe_Key_Deep_2008_t)
colnames(Looe_Key_Deep_2008_donut) <- c("Value")
Looe_Key_Deep_2008_donut <- Looe_Key_Deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2008_donut,"Looe_Key_Deep_2008.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2008_donut_plot <- read.table("Looe_Key_Deep_2008.csv", header=TRUE, sep=",")


Looe_Key_Deep_2008_donut_plot_rounded <- Looe_Key_Deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2008_donut_plot_test <- cbind(Looe_Key_Deep_2008_donut_plot_rounded,Legend)


Looe_Key_Deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2008.png", width = 6, height = 6)




Looe_Key_Deep_2009 <- filter(Looe_Key_Deep_plot, Year == 2009)
Looe_Key_Deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2009_t <- t(Looe_Key_Deep_2009)

Looe_Key_Deep_2009_donut <- data.frame(Looe_Key_Deep_2009_t)
colnames(Looe_Key_Deep_2009_donut) <- c("Value")
Looe_Key_Deep_2009_donut <- Looe_Key_Deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2009_donut,"Looe_Key_Deep_2009.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2009_donut_plot <- read.table("Looe_Key_Deep_2009.csv", header=TRUE, sep=",")


Looe_Key_Deep_2009_donut_plot_rounded <- Looe_Key_Deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2009_donut_plot_test <- cbind(Looe_Key_Deep_2009_donut_plot_rounded,Legend)


Looe_Key_Deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2009.png", width = 6, height = 6)




Looe_Key_Deep_2010 <- filter(Looe_Key_Deep_plot, Year == 2010)
Looe_Key_Deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2010_t <- t(Looe_Key_Deep_2010)

Looe_Key_Deep_2010_donut <- data.frame(Looe_Key_Deep_2010_t)
colnames(Looe_Key_Deep_2010_donut) <- c("Value")
Looe_Key_Deep_2010_donut <- Looe_Key_Deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2010_donut,"Looe_Key_Deep_2010.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2010_donut_plot <- read.table("Looe_Key_Deep_2010.csv", header=TRUE, sep=",")


Looe_Key_Deep_2010_donut_plot_rounded <- Looe_Key_Deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2010_donut_plot_test <- cbind(Looe_Key_Deep_2010_donut_plot_rounded,Legend)


Looe_Key_Deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Looe_Key_Deep_2010.png", width = 6, height = 6)




Looe_Key_Deep_2011 <- filter(Looe_Key_Deep_plot, Year == 2011)
Looe_Key_Deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2011_t <- t(Looe_Key_Deep_2011)

Looe_Key_Deep_2011_donut <- data.frame(Looe_Key_Deep_2011_t)
colnames(Looe_Key_Deep_2011_donut) <- c("Value")
Looe_Key_Deep_2011_donut <- Looe_Key_Deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2011_donut,"Looe_Key_Deep_2011.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2011_donut_plot <- read.table("Looe_Key_Deep_2011.csv", header=TRUE, sep=",")


Looe_Key_Deep_2011_donut_plot_rounded <- Looe_Key_Deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2011_donut_plot_test <- cbind(Looe_Key_Deep_2011_donut_plot_rounded,Legend)


Looe_Key_Deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2011.png", width = 6, height = 6)





Looe_Key_Deep_2012 <- filter(Looe_Key_Deep_plot, Year == 2012)
Looe_Key_Deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2012_t <- t(Looe_Key_Deep_2012)

Looe_Key_Deep_2012_donut <- data.frame(Looe_Key_Deep_2012_t)
colnames(Looe_Key_Deep_2012_donut) <- c("Value")
Looe_Key_Deep_2012_donut <- Looe_Key_Deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2012_donut,"Looe_Key_Deep_2012.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2012_donut_plot <- read.table("Looe_Key_Deep_2012.csv", header=TRUE, sep=",")


Looe_Key_Deep_2012_donut_plot_rounded <- Looe_Key_Deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2012_donut_plot_test <- cbind(Looe_Key_Deep_2012_donut_plot_rounded,Legend)


Looe_Key_Deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2012.png", width = 6, height = 6)






Looe_Key_Deep_2014 <- filter(Looe_Key_Deep_plot, Year == 2014)
Looe_Key_Deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2014_t <- t(Looe_Key_Deep_2014)

Looe_Key_Deep_2014_donut <- data.frame(Looe_Key_Deep_2014_t)
colnames(Looe_Key_Deep_2014_donut) <- c("Value")
Looe_Key_Deep_2014_donut <- Looe_Key_Deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2014_donut,"Looe_Key_Deep_2014.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2014_donut_plot <- read.table("Looe_Key_Deep_2014.csv", header=TRUE, sep=",")


Looe_Key_Deep_2014_donut_plot_rounded <- Looe_Key_Deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2014_donut_plot_test <- cbind(Looe_Key_Deep_2014_donut_plot_rounded,Legend)


Looe_Key_Deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2014.png", width = 6, height = 6)





Looe_Key_Deep_2016 <- filter(Looe_Key_Deep_plot, Year == 2016)
Looe_Key_Deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2016_t <- t(Looe_Key_Deep_2016)

Looe_Key_Deep_2016_donut <- data.frame(Looe_Key_Deep_2016_t)
colnames(Looe_Key_Deep_2016_donut) <- c("Value")
Looe_Key_Deep_2016_donut <- Looe_Key_Deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Deep_2016_donut,"Looe_Key_Deep_2016.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Deep_2016_donut_plot <- read.table("Looe_Key_Deep_2016.csv", header=TRUE, sep=",")


Looe_Key_Deep_2016_donut_plot_rounded <- Looe_Key_Deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Deep_2016_donut_plot_test <- cbind(Looe_Key_Deep_2016_donut_plot_rounded,Legend)


Looe_Key_Deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Deep_2016.png", width = 6, height = 6)






Looe_Key_Shallow <- filter(RVC_CREMP, sitename == "Looe Key Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Looe_Key_Shallow_fish <- Looe_Key_Shallow$sum/max(Looe_Key_Shallow$sum)
Looe_Key_Shallow_biomass <- data.frame(Looe_Key_Shallow_fish)

Looe_Key_Shallow_biomass <- 100*Looe_Key_Shallow_biomass


Looe_Key_Shallow_Stony <- Looe_Key_Shallow$Stony_coral/max(Looe_Key_Shallow$Stony_coral)
Looe_Key_Shallow_coral <- data.frame(Looe_Key_Shallow_Stony)

Looe_Key_Shallow_stony_coral <- 100*Looe_Key_Shallow_coral

Looe_Key_Shallow_macro <- Looe_Key_Shallow$Macroalgae/max(Looe_Key_Shallow$Macroalgae)
Looe_Key_Shallow_algae <- data.frame(Looe_Key_Shallow_macro)


Looe_Key_Shallow_macroalgae <- (100*Looe_Key_Shallow_algae)


Looe_Key_Shallow_plot <- cbind(Looe_Key_Shallow_macroalgae,Looe_Key_Shallow_biomass,Looe_Key_Shallow_stony_coral)

Looe_Key_Shallow_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Looe_Key_Shallow_1999 <- filter(Looe_Key_Shallow_plot, Year == 1999)
Looe_Key_Shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_1999_t <- t(Looe_Key_Shallow_1999)

Looe_Key_Shallow_1999_donut <- data.frame(Looe_Key_Shallow_1999_t)
colnames(Looe_Key_Shallow_1999_donut) <- c("Value")
Looe_Key_Shallow_1999_donut <- Looe_Key_Shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_1999_donut,"Looe_Key_Shallow_1999.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_1999_donut_plot <- read.table("Looe_Key_Shallow_1999.csv", header=TRUE, sep=",")


Looe_Key_Shallow_1999_donut_plot_rounded <- Looe_Key_Shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_1999_donut_plot_test <- cbind(Looe_Key_Shallow_1999_donut_plot_rounded,Legend)


Looe_Key_Shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_1999.png", width = 6, height = 6)



### Looe Key Shallow


Looe_Key_Shallow_2000 <- filter(Looe_Key_Shallow_plot, Year == 2000)
Looe_Key_Shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2000_t <- t(Looe_Key_Shallow_2000)

Looe_Key_Shallow_2000_donut <- data.frame(Looe_Key_Shallow_2000_t)
colnames(Looe_Key_Shallow_2000_donut) <- c("Value")
Looe_Key_Shallow_2000_donut <- Looe_Key_Shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2000_donut,"Looe_Key_Shallow_2000.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2000_donut_plot <- read.table("Looe_Key_Shallow_2000.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2000_donut_plot_rounded <- Looe_Key_Shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2000_donut_plot_test <- cbind(Looe_Key_Shallow_2000_donut_plot_rounded,Legend)


Looe_Key_Shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2000.png", width = 6, height = 6)




Looe_Key_Shallow_2001 <- filter(Looe_Key_Shallow_plot, Year == 2001)
Looe_Key_Shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2001_t <- t(Looe_Key_Shallow_2001)

Looe_Key_Shallow_2001_donut <- data.frame(Looe_Key_Shallow_2001_t)
colnames(Looe_Key_Shallow_2001_donut) <- c("Value")
Looe_Key_Shallow_2001_donut <- Looe_Key_Shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2001_donut,"Looe_Key_Shallow_2001.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2001_donut_plot <- read.table("Looe_Key_Shallow_2001.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2001_donut_plot_rounded <- Looe_Key_Shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2001_donut_plot_test <- cbind(Looe_Key_Shallow_2001_donut_plot_rounded,Legend)


Looe_Key_Shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2001.png", width = 6, height = 6)





Looe_Key_Shallow_2002 <- filter(Looe_Key_Shallow_plot, Year == 2002)
Looe_Key_Shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2002_t <- t(Looe_Key_Shallow_2002)

Looe_Key_Shallow_2002_donut <- data.frame(Looe_Key_Shallow_2002_t)
colnames(Looe_Key_Shallow_2002_donut) <- c("Value")
Looe_Key_Shallow_2002_donut <- Looe_Key_Shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2002_donut,"Looe_Key_Shallow_2002.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2002_donut_plot <- read.table("Looe_Key_Shallow_2002.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2002_donut_plot_rounded <- Looe_Key_Shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2002_donut_plot_test <- cbind(Looe_Key_Shallow_2002_donut_plot_rounded,Legend)


Looe_Key_Shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2002.png", width = 6, height = 6)



Looe_Key_Shallow_2003 <- filter(Looe_Key_Shallow_plot, Year == 2003)
Looe_Key_Shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2003_t <- t(Looe_Key_Shallow_2003)

Looe_Key_Shallow_2003_donut <- data.frame(Looe_Key_Shallow_2003_t)
colnames(Looe_Key_Shallow_2003_donut) <- c("Value")
Looe_Key_Shallow_2003_donut <- Looe_Key_Shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2003_donut,"Looe_Key_Shallow_2003.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2003_donut_plot <- read.table("Looe_Key_Shallow_2003.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2003_donut_plot_rounded <- Looe_Key_Shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2003_donut_plot_test <- cbind(Looe_Key_Shallow_2003_donut_plot_rounded,Legend)


Looe_Key_Shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2003.png", width = 6, height = 6)




Looe_Key_Shallow_2004 <- filter(Looe_Key_Shallow_plot, Year == 2004)
Looe_Key_Shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2004_t <- t(Looe_Key_Shallow_2004)

Looe_Key_Shallow_2004_donut <- data.frame(Looe_Key_Shallow_2004_t)
colnames(Looe_Key_Shallow_2004_donut) <- c("Value")
Looe_Key_Shallow_2004_donut <- Looe_Key_Shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2004_donut,"Looe_Key_Shallow_2004.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2004_donut_plot <- read.table("Looe_Key_Shallow_2004.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2004_donut_plot_rounded <- Looe_Key_Shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2004_donut_plot_test <- cbind(Looe_Key_Shallow_2004_donut_plot_rounded,Legend)


Looe_Key_Shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2004.png", width = 6, height = 6)




Looe_Key_Shallow_2005 <- filter(Looe_Key_Shallow_plot, Year == 2005)
Looe_Key_Shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2005_t <- t(Looe_Key_Shallow_2005)

Looe_Key_Shallow_2005_donut <- data.frame(Looe_Key_Shallow_2005_t)
colnames(Looe_Key_Shallow_2005_donut) <- c("Value")
Looe_Key_Shallow_2005_donut <- Looe_Key_Shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2005_donut,"Looe_Key_Shallow_2005.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2005_donut_plot <- read.table("Looe_Key_Shallow_2005.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2005_donut_plot_rounded <- Looe_Key_Shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2005_donut_plot_test <- cbind(Looe_Key_Shallow_2005_donut_plot_rounded,Legend)


Looe_Key_Shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2005.png", width = 6, height = 6)





Looe_Key_Shallow_2006 <- filter(Looe_Key_Shallow_plot, Year == 2006)
Looe_Key_Shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2006_t <- t(Looe_Key_Shallow_2006)

Looe_Key_Shallow_2006_donut <- data.frame(Looe_Key_Shallow_2006_t)
colnames(Looe_Key_Shallow_2006_donut) <- c("Value")
Looe_Key_Shallow_2006_donut <- Looe_Key_Shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2006_donut,"Looe_Key_Shallow_2006.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2006_donut_plot <- read.table("Looe_Key_Shallow_2006.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2006_donut_plot_rounded <- Looe_Key_Shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2006_donut_plot_test <- cbind(Looe_Key_Shallow_2006_donut_plot_rounded,Legend)


Looe_Key_Shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2006.png", width = 6, height = 6)




Looe_Key_Shallow_2007 <- filter(Looe_Key_Shallow_plot, Year == 2007)
Looe_Key_Shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2007_t <- t(Looe_Key_Shallow_2007)

Looe_Key_Shallow_2007_donut <- data.frame(Looe_Key_Shallow_2007_t)
colnames(Looe_Key_Shallow_2007_donut) <- c("Value")
Looe_Key_Shallow_2007_donut <- Looe_Key_Shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2007_donut,"Looe_Key_Shallow_2007.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2007_donut_plot <- read.table("Looe_Key_Shallow_2007.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2007_donut_plot_rounded <- Looe_Key_Shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2007_donut_plot_test <- cbind(Looe_Key_Shallow_2007_donut_plot_rounded,Legend)


Looe_Key_Shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2007.png", width = 6, height = 6)




Looe_Key_Shallow_2008 <- filter(Looe_Key_Shallow_plot, Year == 2008)
Looe_Key_Shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2008_t <- t(Looe_Key_Shallow_2008)

Looe_Key_Shallow_2008_donut <- data.frame(Looe_Key_Shallow_2008_t)
colnames(Looe_Key_Shallow_2008_donut) <- c("Value")
Looe_Key_Shallow_2008_donut <- Looe_Key_Shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2008_donut,"Looe_Key_Shallow_2008.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2008_donut_plot <- read.table("Looe_Key_Shallow_2008.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2008_donut_plot_rounded <- Looe_Key_Shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2008_donut_plot_test <- cbind(Looe_Key_Shallow_2008_donut_plot_rounded,Legend)


Looe_Key_Shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2008.png", width = 6, height = 6)




Looe_Key_Shallow_2009 <- filter(Looe_Key_Shallow_plot, Year == 2009)
Looe_Key_Shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2009_t <- t(Looe_Key_Shallow_2009)

Looe_Key_Shallow_2009_donut <- data.frame(Looe_Key_Shallow_2009_t)
colnames(Looe_Key_Shallow_2009_donut) <- c("Value")
Looe_Key_Shallow_2009_donut <- Looe_Key_Shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2009_donut,"Looe_Key_Shallow_2009.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2009_donut_plot <- read.table("Looe_Key_Shallow_2009.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2009_donut_plot_rounded <- Looe_Key_Shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2009_donut_plot_test <- cbind(Looe_Key_Shallow_2009_donut_plot_rounded,Legend)


Looe_Key_Shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2009.png", width = 6, height = 6)




Looe_Key_Shallow_2010 <- filter(Looe_Key_Shallow_plot, Year == 2010)
Looe_Key_Shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2010_t <- t(Looe_Key_Shallow_2010)

Looe_Key_Shallow_2010_donut <- data.frame(Looe_Key_Shallow_2010_t)
colnames(Looe_Key_Shallow_2010_donut) <- c("Value")
Looe_Key_Shallow_2010_donut <- Looe_Key_Shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2010_donut,"Looe_Key_Shallow_2010.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2010_donut_plot <- read.table("Looe_Key_Shallow_2010.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2010_donut_plot_rounded <- Looe_Key_Shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2010_donut_plot_test <- cbind(Looe_Key_Shallow_2010_donut_plot_rounded,Legend)


Looe_Key_Shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Looe_Key_Shallow_2010.png", width = 6, height = 6)




Looe_Key_Shallow_2011 <- filter(Looe_Key_Shallow_plot, Year == 2011)
Looe_Key_Shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2011_t <- t(Looe_Key_Shallow_2011)

Looe_Key_Shallow_2011_donut <- data.frame(Looe_Key_Shallow_2011_t)
colnames(Looe_Key_Shallow_2011_donut) <- c("Value")
Looe_Key_Shallow_2011_donut <- Looe_Key_Shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2011_donut,"Looe_Key_Shallow_2011.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2011_donut_plot <- read.table("Looe_Key_Shallow_2011.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2011_donut_plot_rounded <- Looe_Key_Shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2011_donut_plot_test <- cbind(Looe_Key_Shallow_2011_donut_plot_rounded,Legend)


Looe_Key_Shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2011.png", width = 6, height = 6)





Looe_Key_Shallow_2012 <- filter(Looe_Key_Shallow_plot, Year == 2012)
Looe_Key_Shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2012_t <- t(Looe_Key_Shallow_2012)

Looe_Key_Shallow_2012_donut <- data.frame(Looe_Key_Shallow_2012_t)
colnames(Looe_Key_Shallow_2012_donut) <- c("Value")
Looe_Key_Shallow_2012_donut <- Looe_Key_Shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2012_donut,"Looe_Key_Shallow_2012.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2012_donut_plot <- read.table("Looe_Key_Shallow_2012.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2012_donut_plot_rounded <- Looe_Key_Shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2012_donut_plot_test <- cbind(Looe_Key_Shallow_2012_donut_plot_rounded,Legend)


Looe_Key_Shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2012.png", width = 6, height = 6)






Looe_Key_Shallow_2014 <- filter(Looe_Key_Shallow_plot, Year == 2014)
Looe_Key_Shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2014_t <- t(Looe_Key_Shallow_2014)

Looe_Key_Shallow_2014_donut <- data.frame(Looe_Key_Shallow_2014_t)
colnames(Looe_Key_Shallow_2014_donut) <- c("Value")
Looe_Key_Shallow_2014_donut <- Looe_Key_Shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2014_donut,"Looe_Key_Shallow_2014.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2014_donut_plot <- read.table("Looe_Key_Shallow_2014.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2014_donut_plot_rounded <- Looe_Key_Shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2014_donut_plot_test <- cbind(Looe_Key_Shallow_2014_donut_plot_rounded,Legend)


Looe_Key_Shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2014.png", width = 6, height = 6)





Looe_Key_Shallow_2016 <- filter(Looe_Key_Shallow_plot, Year == 2016)
Looe_Key_Shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Looe_Key_Shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2016_t <- t(Looe_Key_Shallow_2016)

Looe_Key_Shallow_2016_donut <- data.frame(Looe_Key_Shallow_2016_t)
colnames(Looe_Key_Shallow_2016_donut) <- c("Value")
Looe_Key_Shallow_2016_donut <- Looe_Key_Shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Looe_Key_Shallow_2016_donut,"Looe_Key_Shallow_2016.csv")


### import as csv (change category and value to the two column names)

Looe_Key_Shallow_2016_donut_plot <- read.table("Looe_Key_Shallow_2016.csv", header=TRUE, sep=",")


Looe_Key_Shallow_2016_donut_plot_rounded <- Looe_Key_Shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Looe_Key_Shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Looe_Key_Shallow_2016_donut_plot_test <- cbind(Looe_Key_Shallow_2016_donut_plot_rounded,Legend)


Looe_Key_Shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Looe Key Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Looe_Key_Shallow_2016.png", width = 6, height = 6)






Rock_Key_Deep <- filter(RVC_CREMP, sitename == "Rock Key Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Rock_Key_Deep_fish <- Rock_Key_Deep$sum/max(Rock_Key_Deep$sum)
Rock_Key_Deep_biomass <- data.frame(Rock_Key_Deep_fish)

Rock_Key_Deep_biomass <- 100*Rock_Key_Deep_biomass


Rock_Key_Deep_Stony <- Rock_Key_Deep$Stony_coral/max(Rock_Key_Deep$Stony_coral)
Rock_Key_Deep_coral <- data.frame(Rock_Key_Deep_Stony)

Rock_Key_Deep_stony_coral <- 100*Rock_Key_Deep_coral

Rock_Key_Deep_macro <- Rock_Key_Deep$Macroalgae/max(Rock_Key_Deep$Macroalgae)
Rock_Key_Deep_algae <- data.frame(Rock_Key_Deep_macro)


Rock_Key_Deep_macroalgae <- (100*Rock_Key_Deep_algae)


Rock_Key_Deep_plot <- cbind(Rock_Key_Deep_macroalgae,Rock_Key_Deep_biomass,Rock_Key_Deep_stony_coral)

Rock_Key_Deep_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2010","2011","2012","2014","2016")

### Filter per year

Rock_Key_Deep_1999 <- filter(Rock_Key_Deep_plot, Year == 1999)
Rock_Key_Deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_1999_t <- t(Rock_Key_Deep_1999)

Rock_Key_Deep_1999_donut <- data.frame(Rock_Key_Deep_1999_t)
colnames(Rock_Key_Deep_1999_donut) <- c("Value")
Rock_Key_Deep_1999_donut <- Rock_Key_Deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_1999_donut,"Rock_Key_Deep_1999.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_1999_donut_plot <- read.table("Rock_Key_Deep_1999.csv", header=TRUE, sep=",")


Rock_Key_Deep_1999_donut_plot_rounded <- Rock_Key_Deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_1999_donut_plot_test <- cbind(Rock_Key_Deep_1999_donut_plot_rounded,Legend)


Rock_Key_Deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_1999.png", width = 6, height = 6)



### Rock Key Deep


Rock_Key_Deep_2000 <- filter(Rock_Key_Deep_plot, Year == 2000)
Rock_Key_Deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2000_t <- t(Rock_Key_Deep_2000)

Rock_Key_Deep_2000_donut <- data.frame(Rock_Key_Deep_2000_t)
colnames(Rock_Key_Deep_2000_donut) <- c("Value")
Rock_Key_Deep_2000_donut <- Rock_Key_Deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2000_donut,"Rock_Key_Deep_2000.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2000_donut_plot <- read.table("Rock_Key_Deep_2000.csv", header=TRUE, sep=",")


Rock_Key_Deep_2000_donut_plot_rounded <- Rock_Key_Deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2000_donut_plot_test <- cbind(Rock_Key_Deep_2000_donut_plot_rounded,Legend)


Rock_Key_Deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2000.png", width = 6, height = 6)




Rock_Key_Deep_2001 <- filter(Rock_Key_Deep_plot, Year == 2001)
Rock_Key_Deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2001_t <- t(Rock_Key_Deep_2001)

Rock_Key_Deep_2001_donut <- data.frame(Rock_Key_Deep_2001_t)
colnames(Rock_Key_Deep_2001_donut) <- c("Value")
Rock_Key_Deep_2001_donut <- Rock_Key_Deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2001_donut,"Rock_Key_Deep_2001.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2001_donut_plot <- read.table("Rock_Key_Deep_2001.csv", header=TRUE, sep=",")


Rock_Key_Deep_2001_donut_plot_rounded <- Rock_Key_Deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2001_donut_plot_test <- cbind(Rock_Key_Deep_2001_donut_plot_rounded,Legend)


Rock_Key_Deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2001.png", width = 6, height = 6)





Rock_Key_Deep_2002 <- filter(Rock_Key_Deep_plot, Year == 2002)
Rock_Key_Deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2002_t <- t(Rock_Key_Deep_2002)

Rock_Key_Deep_2002_donut <- data.frame(Rock_Key_Deep_2002_t)
colnames(Rock_Key_Deep_2002_donut) <- c("Value")
Rock_Key_Deep_2002_donut <- Rock_Key_Deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2002_donut,"Rock_Key_Deep_2002.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2002_donut_plot <- read.table("Rock_Key_Deep_2002.csv", header=TRUE, sep=",")


Rock_Key_Deep_2002_donut_plot_rounded <- Rock_Key_Deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2002_donut_plot_test <- cbind(Rock_Key_Deep_2002_donut_plot_rounded,Legend)


Rock_Key_Deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2002.png", width = 6, height = 6)



Rock_Key_Deep_2003 <- filter(Rock_Key_Deep_plot, Year == 2003)
Rock_Key_Deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2003_t <- t(Rock_Key_Deep_2003)

Rock_Key_Deep_2003_donut <- data.frame(Rock_Key_Deep_2003_t)
colnames(Rock_Key_Deep_2003_donut) <- c("Value")
Rock_Key_Deep_2003_donut <- Rock_Key_Deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2003_donut,"Rock_Key_Deep_2003.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2003_donut_plot <- read.table("Rock_Key_Deep_2003.csv", header=TRUE, sep=",")


Rock_Key_Deep_2003_donut_plot_rounded <- Rock_Key_Deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2003_donut_plot_test <- cbind(Rock_Key_Deep_2003_donut_plot_rounded,Legend)


Rock_Key_Deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2003.png", width = 6, height = 6)




Rock_Key_Deep_2004 <- filter(Rock_Key_Deep_plot, Year == 2004)
Rock_Key_Deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2004_t <- t(Rock_Key_Deep_2004)

Rock_Key_Deep_2004_donut <- data.frame(Rock_Key_Deep_2004_t)
colnames(Rock_Key_Deep_2004_donut) <- c("Value")
Rock_Key_Deep_2004_donut <- Rock_Key_Deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2004_donut,"Rock_Key_Deep_2004.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2004_donut_plot <- read.table("Rock_Key_Deep_2004.csv", header=TRUE, sep=",")


Rock_Key_Deep_2004_donut_plot_rounded <- Rock_Key_Deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2004_donut_plot_test <- cbind(Rock_Key_Deep_2004_donut_plot_rounded,Legend)


Rock_Key_Deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2004.png", width = 6, height = 6)




Rock_Key_Deep_2005 <- filter(Rock_Key_Deep_plot, Year == 2005)
Rock_Key_Deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2005_t <- t(Rock_Key_Deep_2005)

Rock_Key_Deep_2005_donut <- data.frame(Rock_Key_Deep_2005_t)
colnames(Rock_Key_Deep_2005_donut) <- c("Value")
Rock_Key_Deep_2005_donut <- Rock_Key_Deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2005_donut,"Rock_Key_Deep_2005.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2005_donut_plot <- read.table("Rock_Key_Deep_2005.csv", header=TRUE, sep=",")


Rock_Key_Deep_2005_donut_plot_rounded <- Rock_Key_Deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2005_donut_plot_test <- cbind(Rock_Key_Deep_2005_donut_plot_rounded,Legend)


Rock_Key_Deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2005.png", width = 6, height = 6)





Rock_Key_Deep_2006 <- filter(Rock_Key_Deep_plot, Year == 2006)
Rock_Key_Deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2006_t <- t(Rock_Key_Deep_2006)

Rock_Key_Deep_2006_donut <- data.frame(Rock_Key_Deep_2006_t)
colnames(Rock_Key_Deep_2006_donut) <- c("Value")
Rock_Key_Deep_2006_donut <- Rock_Key_Deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2006_donut,"Rock_Key_Deep_2006.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2006_donut_plot <- read.table("Rock_Key_Deep_2006.csv", header=TRUE, sep=",")


Rock_Key_Deep_2006_donut_plot_rounded <- Rock_Key_Deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2006_donut_plot_test <- cbind(Rock_Key_Deep_2006_donut_plot_rounded,Legend)


Rock_Key_Deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2006.png", width = 6, height = 6)




Rock_Key_Deep_2007 <- filter(Rock_Key_Deep_plot, Year == 2007)
Rock_Key_Deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2007_t <- t(Rock_Key_Deep_2007)

Rock_Key_Deep_2007_donut <- data.frame(Rock_Key_Deep_2007_t)
colnames(Rock_Key_Deep_2007_donut) <- c("Value")
Rock_Key_Deep_2007_donut <- Rock_Key_Deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2007_donut,"Rock_Key_Deep_2007.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2007_donut_plot <- read.table("Rock_Key_Deep_2007.csv", header=TRUE, sep=",")


Rock_Key_Deep_2007_donut_plot_rounded <- Rock_Key_Deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2007_donut_plot_test <- cbind(Rock_Key_Deep_2007_donut_plot_rounded,Legend)


Rock_Key_Deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2007.png", width = 6, height = 6)




Rock_Key_Deep_2008 <- filter(Rock_Key_Deep_plot, Year == 2008)
Rock_Key_Deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2008_t <- t(Rock_Key_Deep_2008)

Rock_Key_Deep_2008_donut <- data.frame(Rock_Key_Deep_2008_t)
colnames(Rock_Key_Deep_2008_donut) <- c("Value")
Rock_Key_Deep_2008_donut <- Rock_Key_Deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2008_donut,"Rock_Key_Deep_2008.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2008_donut_plot <- read.table("Rock_Key_Deep_2008.csv", header=TRUE, sep=",")


Rock_Key_Deep_2008_donut_plot_rounded <- Rock_Key_Deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2008_donut_plot_test <- cbind(Rock_Key_Deep_2008_donut_plot_rounded,Legend)


Rock_Key_Deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2008.png", width = 6, height = 6)




Rock_Key_Deep_2009 <- filter(Rock_Key_Deep_plot, Year == 2009)
Rock_Key_Deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2009_t <- t(Rock_Key_Deep_2009)

Rock_Key_Deep_2009_donut <- data.frame(Rock_Key_Deep_2009_t)
colnames(Rock_Key_Deep_2009_donut) <- c("Value")
Rock_Key_Deep_2009_donut <- Rock_Key_Deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2009_donut,"Rock_Key_Deep_2009.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2009_donut_plot <- read.table("Rock_Key_Deep_2009.csv", header=TRUE, sep=",")


Rock_Key_Deep_2009_donut_plot_rounded <- Rock_Key_Deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2009_donut_plot_test <- cbind(Rock_Key_Deep_2009_donut_plot_rounded,Legend)


Rock_Key_Deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Rock_Key_Deep_2009.png", width = 6, height = 6)




Rock_Key_Deep_2010 <- filter(Rock_Key_Deep_plot, Year == 2010)
Rock_Key_Deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2010_t <- t(Rock_Key_Deep_2010)

Rock_Key_Deep_2010_donut <- data.frame(Rock_Key_Deep_2010_t)
colnames(Rock_Key_Deep_2010_donut) <- c("Value")
Rock_Key_Deep_2010_donut <- Rock_Key_Deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2010_donut,"Rock_Key_Deep_2010.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2010_donut_plot <- read.table("Rock_Key_Deep_2010.csv", header=TRUE, sep=",")


Rock_Key_Deep_2010_donut_plot_rounded <- Rock_Key_Deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2010_donut_plot_test <- cbind(Rock_Key_Deep_2010_donut_plot_rounded,Legend)


Rock_Key_Deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2010.png", width = 6, height = 6)




Rock_Key_Deep_2011 <- filter(Rock_Key_Deep_plot, Year == 2011)
Rock_Key_Deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2011_t <- t(Rock_Key_Deep_2011)

Rock_Key_Deep_2011_donut <- data.frame(Rock_Key_Deep_2011_t)
colnames(Rock_Key_Deep_2011_donut) <- c("Value")
Rock_Key_Deep_2011_donut <- Rock_Key_Deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2011_donut,"Rock_Key_Deep_2011.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2011_donut_plot <- read.table("Rock_Key_Deep_2011.csv", header=TRUE, sep=",")


Rock_Key_Deep_2011_donut_plot_rounded <- Rock_Key_Deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2011_donut_plot_test <- cbind(Rock_Key_Deep_2011_donut_plot_rounded,Legend)


Rock_Key_Deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2011.png", width = 6, height = 6)





Rock_Key_Deep_2012 <- filter(Rock_Key_Deep_plot, Year == 2012)
Rock_Key_Deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2012_t <- t(Rock_Key_Deep_2012)

Rock_Key_Deep_2012_donut <- data.frame(Rock_Key_Deep_2012_t)
colnames(Rock_Key_Deep_2012_donut) <- c("Value")
Rock_Key_Deep_2012_donut <- Rock_Key_Deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2012_donut,"Rock_Key_Deep_2012.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2012_donut_plot <- read.table("Rock_Key_Deep_2012.csv", header=TRUE, sep=",")


Rock_Key_Deep_2012_donut_plot_rounded <- Rock_Key_Deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2012_donut_plot_test <- cbind(Rock_Key_Deep_2012_donut_plot_rounded,Legend)


Rock_Key_Deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2012.png", width = 6, height = 6)






Rock_Key_Deep_2014 <- filter(Rock_Key_Deep_plot, Year == 2014)
Rock_Key_Deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2014_t <- t(Rock_Key_Deep_2014)

Rock_Key_Deep_2014_donut <- data.frame(Rock_Key_Deep_2014_t)
colnames(Rock_Key_Deep_2014_donut) <- c("Value")
Rock_Key_Deep_2014_donut <- Rock_Key_Deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2014_donut,"Rock_Key_Deep_2014.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2014_donut_plot <- read.table("Rock_Key_Deep_2014.csv", header=TRUE, sep=",")


Rock_Key_Deep_2014_donut_plot_rounded <- Rock_Key_Deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2014_donut_plot_test <- cbind(Rock_Key_Deep_2014_donut_plot_rounded,Legend)


Rock_Key_Deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2014.png", width = 6, height = 6)





Rock_Key_Deep_2016 <- filter(Rock_Key_Deep_plot, Year == 2016)
Rock_Key_Deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2016_t <- t(Rock_Key_Deep_2016)

Rock_Key_Deep_2016_donut <- data.frame(Rock_Key_Deep_2016_t)
colnames(Rock_Key_Deep_2016_donut) <- c("Value")
Rock_Key_Deep_2016_donut <- Rock_Key_Deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Deep_2016_donut,"Rock_Key_Deep_2016.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Deep_2016_donut_plot <- read.table("Rock_Key_Deep_2016.csv", header=TRUE, sep=",")


Rock_Key_Deep_2016_donut_plot_rounded <- Rock_Key_Deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Deep_2016_donut_plot_test <- cbind(Rock_Key_Deep_2016_donut_plot_rounded,Legend)


Rock_Key_Deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Deep_2016.png", width = 6, height = 6)







Rock_Key_Shallow <- filter(RVC_CREMP, sitename == "Rock Key Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Rock_Key_Shallow_fish <- Rock_Key_Shallow$sum/max(Rock_Key_Shallow$sum)
Rock_Key_Shallow_biomass <- data.frame(Rock_Key_Shallow_fish)

Rock_Key_Shallow_biomass <- 100*Rock_Key_Shallow_biomass


Rock_Key_Shallow_Stony <- Rock_Key_Shallow$Stony_coral/max(Rock_Key_Shallow$Stony_coral)
Rock_Key_Shallow_coral <- data.frame(Rock_Key_Shallow_Stony)

Rock_Key_Shallow_stony_coral <- 100*Rock_Key_Shallow_coral

Rock_Key_Shallow_macro <- Rock_Key_Shallow$Macroalgae/max(Rock_Key_Shallow$Macroalgae)
Rock_Key_Shallow_algae <- data.frame(Rock_Key_Shallow_macro)


Rock_Key_Shallow_macroalgae <- (100*Rock_Key_Shallow_algae)


Rock_Key_Shallow_plot <- cbind(Rock_Key_Shallow_macroalgae,Rock_Key_Shallow_biomass,Rock_Key_Shallow_stony_coral)

Rock_Key_Shallow_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Rock_Key_Shallow_1999 <- filter(Rock_Key_Shallow_plot, Year == 1999)
Rock_Key_Shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_1999_t <- t(Rock_Key_Shallow_1999)

Rock_Key_Shallow_1999_donut <- data.frame(Rock_Key_Shallow_1999_t)
colnames(Rock_Key_Shallow_1999_donut) <- c("Value")
Rock_Key_Shallow_1999_donut <- Rock_Key_Shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_1999_donut,"Rock_Key_Shallow_1999.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_1999_donut_plot <- read.table("Rock_Key_Shallow_1999.csv", header=TRUE, sep=",")


Rock_Key_Shallow_1999_donut_plot_rounded <- Rock_Key_Shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_1999_donut_plot_test <- cbind(Rock_Key_Shallow_1999_donut_plot_rounded,Legend)


Rock_Key_Shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_1999.png", width = 6, height = 6)



### Rock Key Shallow


Rock_Key_Shallow_2000 <- filter(Rock_Key_Shallow_plot, Year == 2000)
Rock_Key_Shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2000_t <- t(Rock_Key_Shallow_2000)

Rock_Key_Shallow_2000_donut <- data.frame(Rock_Key_Shallow_2000_t)
colnames(Rock_Key_Shallow_2000_donut) <- c("Value")
Rock_Key_Shallow_2000_donut <- Rock_Key_Shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2000_donut,"Rock_Key_Shallow_2000.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2000_donut_plot <- read.table("Rock_Key_Shallow_2000.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2000_donut_plot_rounded <- Rock_Key_Shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2000_donut_plot_test <- cbind(Rock_Key_Shallow_2000_donut_plot_rounded,Legend)


Rock_Key_Shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2000.png", width = 6, height = 6)




Rock_Key_Shallow_2001 <- filter(Rock_Key_Shallow_plot, Year == 2001)
Rock_Key_Shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2001_t <- t(Rock_Key_Shallow_2001)

Rock_Key_Shallow_2001_donut <- data.frame(Rock_Key_Shallow_2001_t)
colnames(Rock_Key_Shallow_2001_donut) <- c("Value")
Rock_Key_Shallow_2001_donut <- Rock_Key_Shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2001_donut,"Rock_Key_Shallow_2001.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2001_donut_plot <- read.table("Rock_Key_Shallow_2001.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2001_donut_plot_rounded <- Rock_Key_Shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2001_donut_plot_test <- cbind(Rock_Key_Shallow_2001_donut_plot_rounded,Legend)


Rock_Key_Shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2001.png", width = 6, height = 6)





Rock_Key_Shallow_2002 <- filter(Rock_Key_Shallow_plot, Year == 2002)
Rock_Key_Shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2002_t <- t(Rock_Key_Shallow_2002)

Rock_Key_Shallow_2002_donut <- data.frame(Rock_Key_Shallow_2002_t)
colnames(Rock_Key_Shallow_2002_donut) <- c("Value")
Rock_Key_Shallow_2002_donut <- Rock_Key_Shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2002_donut,"Rock_Key_Shallow_2002.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2002_donut_plot <- read.table("Rock_Key_Shallow_2002.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2002_donut_plot_rounded <- Rock_Key_Shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2002_donut_plot_test <- cbind(Rock_Key_Shallow_2002_donut_plot_rounded,Legend)


Rock_Key_Shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2002.png", width = 6, height = 6)



Rock_Key_Shallow_2003 <- filter(Rock_Key_Shallow_plot, Year == 2003)
Rock_Key_Shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2003_t <- t(Rock_Key_Shallow_2003)

Rock_Key_Shallow_2003_donut <- data.frame(Rock_Key_Shallow_2003_t)
colnames(Rock_Key_Shallow_2003_donut) <- c("Value")
Rock_Key_Shallow_2003_donut <- Rock_Key_Shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2003_donut,"Rock_Key_Shallow_2003.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2003_donut_plot <- read.table("Rock_Key_Shallow_2003.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2003_donut_plot_rounded <- Rock_Key_Shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2003_donut_plot_test <- cbind(Rock_Key_Shallow_2003_donut_plot_rounded,Legend)


Rock_Key_Shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2003.png", width = 6, height = 6)




Rock_Key_Shallow_2004 <- filter(Rock_Key_Shallow_plot, Year == 2004)
Rock_Key_Shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2004_t <- t(Rock_Key_Shallow_2004)

Rock_Key_Shallow_2004_donut <- data.frame(Rock_Key_Shallow_2004_t)
colnames(Rock_Key_Shallow_2004_donut) <- c("Value")
Rock_Key_Shallow_2004_donut <- Rock_Key_Shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2004_donut,"Rock_Key_Shallow_2004.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2004_donut_plot <- read.table("Rock_Key_Shallow_2004.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2004_donut_plot_rounded <- Rock_Key_Shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2004_donut_plot_test <- cbind(Rock_Key_Shallow_2004_donut_plot_rounded,Legend)


Rock_Key_Shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2004.png", width = 6, height = 6)




Rock_Key_Shallow_2005 <- filter(Rock_Key_Shallow_plot, Year == 2005)
Rock_Key_Shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2005_t <- t(Rock_Key_Shallow_2005)

Rock_Key_Shallow_2005_donut <- data.frame(Rock_Key_Shallow_2005_t)
colnames(Rock_Key_Shallow_2005_donut) <- c("Value")
Rock_Key_Shallow_2005_donut <- Rock_Key_Shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2005_donut,"Rock_Key_Shallow_2005.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2005_donut_plot <- read.table("Rock_Key_Shallow_2005.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2005_donut_plot_rounded <- Rock_Key_Shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2005_donut_plot_test <- cbind(Rock_Key_Shallow_2005_donut_plot_rounded,Legend)


Rock_Key_Shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2005.png", width = 6, height = 6)





Rock_Key_Shallow_2006 <- filter(Rock_Key_Shallow_plot, Year == 2006)
Rock_Key_Shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2006_t <- t(Rock_Key_Shallow_2006)

Rock_Key_Shallow_2006_donut <- data.frame(Rock_Key_Shallow_2006_t)
colnames(Rock_Key_Shallow_2006_donut) <- c("Value")
Rock_Key_Shallow_2006_donut <- Rock_Key_Shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2006_donut,"Rock_Key_Shallow_2006.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2006_donut_plot <- read.table("Rock_Key_Shallow_2006.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2006_donut_plot_rounded <- Rock_Key_Shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2006_donut_plot_test <- cbind(Rock_Key_Shallow_2006_donut_plot_rounded,Legend)


Rock_Key_Shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2006.png", width = 6, height = 6)




Rock_Key_Shallow_2007 <- filter(Rock_Key_Shallow_plot, Year == 2007)
Rock_Key_Shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2007_t <- t(Rock_Key_Shallow_2007)

Rock_Key_Shallow_2007_donut <- data.frame(Rock_Key_Shallow_2007_t)
colnames(Rock_Key_Shallow_2007_donut) <- c("Value")
Rock_Key_Shallow_2007_donut <- Rock_Key_Shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2007_donut,"Rock_Key_Shallow_2007.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2007_donut_plot <- read.table("Rock_Key_Shallow_2007.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2007_donut_plot_rounded <- Rock_Key_Shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2007_donut_plot_test <- cbind(Rock_Key_Shallow_2007_donut_plot_rounded,Legend)


Rock_Key_Shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2007.png", width = 6, height = 6)




Rock_Key_Shallow_2008 <- filter(Rock_Key_Shallow_plot, Year == 2008)
Rock_Key_Shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2008_t <- t(Rock_Key_Shallow_2008)

Rock_Key_Shallow_2008_donut <- data.frame(Rock_Key_Shallow_2008_t)
colnames(Rock_Key_Shallow_2008_donut) <- c("Value")
Rock_Key_Shallow_2008_donut <- Rock_Key_Shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2008_donut,"Rock_Key_Shallow_2008.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2008_donut_plot <- read.table("Rock_Key_Shallow_2008.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2008_donut_plot_rounded <- Rock_Key_Shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2008_donut_plot_test <- cbind(Rock_Key_Shallow_2008_donut_plot_rounded,Legend)


Rock_Key_Shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2008.png", width = 6, height = 6)




Rock_Key_Shallow_2009 <- filter(Rock_Key_Shallow_plot, Year == 2009)
Rock_Key_Shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2009_t <- t(Rock_Key_Shallow_2009)

Rock_Key_Shallow_2009_donut <- data.frame(Rock_Key_Shallow_2009_t)
colnames(Rock_Key_Shallow_2009_donut) <- c("Value")
Rock_Key_Shallow_2009_donut <- Rock_Key_Shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2009_donut,"Rock_Key_Shallow_2009.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2009_donut_plot <- read.table("Rock_Key_Shallow_2009.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2009_donut_plot_rounded <- Rock_Key_Shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2009_donut_plot_test <- cbind(Rock_Key_Shallow_2009_donut_plot_rounded,Legend)


Rock_Key_Shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2009.png", width = 6, height = 6)




Rock_Key_Shallow_2010 <- filter(Rock_Key_Shallow_plot, Year == 2010)
Rock_Key_Shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2010_t <- t(Rock_Key_Shallow_2010)

Rock_Key_Shallow_2010_donut <- data.frame(Rock_Key_Shallow_2010_t)
colnames(Rock_Key_Shallow_2010_donut) <- c("Value")
Rock_Key_Shallow_2010_donut <- Rock_Key_Shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2010_donut,"Rock_Key_Shallow_2010.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2010_donut_plot <- read.table("Rock_Key_Shallow_2010.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2010_donut_plot_rounded <- Rock_Key_Shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2010_donut_plot_test <- cbind(Rock_Key_Shallow_2010_donut_plot_rounded,Legend)


Rock_Key_Shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Rock_Key_Shallow_2010.png", width = 6, height = 6)




Rock_Key_Shallow_2011 <- filter(Rock_Key_Shallow_plot, Year == 2011)
Rock_Key_Shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2011_t <- t(Rock_Key_Shallow_2011)

Rock_Key_Shallow_2011_donut <- data.frame(Rock_Key_Shallow_2011_t)
colnames(Rock_Key_Shallow_2011_donut) <- c("Value")
Rock_Key_Shallow_2011_donut <- Rock_Key_Shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2011_donut,"Rock_Key_Shallow_2011.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2011_donut_plot <- read.table("Rock_Key_Shallow_2011.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2011_donut_plot_rounded <- Rock_Key_Shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2011_donut_plot_test <- cbind(Rock_Key_Shallow_2011_donut_plot_rounded,Legend)


Rock_Key_Shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2011.png", width = 6, height = 6)





Rock_Key_Shallow_2012 <- filter(Rock_Key_Shallow_plot, Year == 2012)
Rock_Key_Shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2012_t <- t(Rock_Key_Shallow_2012)

Rock_Key_Shallow_2012_donut <- data.frame(Rock_Key_Shallow_2012_t)
colnames(Rock_Key_Shallow_2012_donut) <- c("Value")
Rock_Key_Shallow_2012_donut <- Rock_Key_Shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2012_donut,"Rock_Key_Shallow_2012.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2012_donut_plot <- read.table("Rock_Key_Shallow_2012.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2012_donut_plot_rounded <- Rock_Key_Shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2012_donut_plot_test <- cbind(Rock_Key_Shallow_2012_donut_plot_rounded,Legend)


Rock_Key_Shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2012.png", width = 6, height = 6)






Rock_Key_Shallow_2014 <- filter(Rock_Key_Shallow_plot, Year == 2014)
Rock_Key_Shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2014_t <- t(Rock_Key_Shallow_2014)

Rock_Key_Shallow_2014_donut <- data.frame(Rock_Key_Shallow_2014_t)
colnames(Rock_Key_Shallow_2014_donut) <- c("Value")
Rock_Key_Shallow_2014_donut <- Rock_Key_Shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2014_donut,"Rock_Key_Shallow_2014.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2014_donut_plot <- read.table("Rock_Key_Shallow_2014.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2014_donut_plot_rounded <- Rock_Key_Shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2014_donut_plot_test <- cbind(Rock_Key_Shallow_2014_donut_plot_rounded,Legend)


Rock_Key_Shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2014.png", width = 6, height = 6)





Rock_Key_Shallow_2016 <- filter(Rock_Key_Shallow_plot, Year == 2016)
Rock_Key_Shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Rock_Key_Shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2016_t <- t(Rock_Key_Shallow_2016)

Rock_Key_Shallow_2016_donut <- data.frame(Rock_Key_Shallow_2016_t)
colnames(Rock_Key_Shallow_2016_donut) <- c("Value")
Rock_Key_Shallow_2016_donut <- Rock_Key_Shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Rock_Key_Shallow_2016_donut,"Rock_Key_Shallow_2016.csv")


### import as csv (change category and value to the two column names)

Rock_Key_Shallow_2016_donut_plot <- read.table("Rock_Key_Shallow_2016.csv", header=TRUE, sep=",")


Rock_Key_Shallow_2016_donut_plot_rounded <- Rock_Key_Shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Rock_Key_Shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Rock_Key_Shallow_2016_donut_plot_test <- cbind(Rock_Key_Shallow_2016_donut_plot_rounded,Legend)


Rock_Key_Shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Rock Key Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Rock_Key_Shallow_2016.png", width = 6, height = 6)






Sand_Key_Deep <- filter(RVC_CREMP, sitename == "Sand Key Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Sand_Key_Deep_fish <- Sand_Key_Deep$sum/max(Sand_Key_Deep$sum)
Sand_Key_Deep_biomass <- data.frame(Sand_Key_Deep_fish)

Sand_Key_Deep_biomass <- 100*Sand_Key_Deep_biomass


Sand_Key_Deep_Stony <- Sand_Key_Deep$Stony_coral/max(Sand_Key_Deep$Stony_coral)
Sand_Key_Deep_coral <- data.frame(Sand_Key_Deep_Stony)

Sand_Key_Deep_stony_coral <- 100*Sand_Key_Deep_coral

Sand_Key_Deep_macro <- Sand_Key_Deep$Macroalgae/max(Sand_Key_Deep$Macroalgae)
Sand_Key_Deep_algae <- data.frame(Sand_Key_Deep_macro)


Sand_Key_Deep_macroalgae <- (100*Sand_Key_Deep_algae)


Sand_Key_Deep_plot <- cbind(Sand_Key_Deep_macroalgae,Sand_Key_Deep_biomass,Sand_Key_Deep_stony_coral)

Sand_Key_Deep_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2010","2011","2012","2014","2016")

### Filter per year

Sand_Key_Deep_1999 <- filter(Sand_Key_Deep_plot, Year == 1999)
Sand_Key_Deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_1999_t <- t(Sand_Key_Deep_1999)

Sand_Key_Deep_1999_donut <- data.frame(Sand_Key_Deep_1999_t)
colnames(Sand_Key_Deep_1999_donut) <- c("Value")
Sand_Key_Deep_1999_donut <- Sand_Key_Deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_1999_donut,"Sand_Key_Deep_1999.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_1999_donut_plot <- read.table("Sand_Key_Deep_1999.csv", header=TRUE, sep=",")


Sand_Key_Deep_1999_donut_plot_rounded <- Sand_Key_Deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_1999_donut_plot_test <- cbind(Sand_Key_Deep_1999_donut_plot_rounded,Legend)


Sand_Key_Deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_1999.png", width = 6, height = 6)



### Sand Key Deep


Sand_Key_Deep_2000 <- filter(Sand_Key_Deep_plot, Year == 2000)
Sand_Key_Deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2000_t <- t(Sand_Key_Deep_2000)

Sand_Key_Deep_2000_donut <- data.frame(Sand_Key_Deep_2000_t)
colnames(Sand_Key_Deep_2000_donut) <- c("Value")
Sand_Key_Deep_2000_donut <- Sand_Key_Deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2000_donut,"Sand_Key_Deep_2000.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2000_donut_plot <- read.table("Sand_Key_Deep_2000.csv", header=TRUE, sep=",")


Sand_Key_Deep_2000_donut_plot_rounded <- Sand_Key_Deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2000_donut_plot_test <- cbind(Sand_Key_Deep_2000_donut_plot_rounded,Legend)


Sand_Key_Deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2000.png", width = 6, height = 6)




Sand_Key_Deep_2001 <- filter(Sand_Key_Deep_plot, Year == 2001)
Sand_Key_Deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2001_t <- t(Sand_Key_Deep_2001)

Sand_Key_Deep_2001_donut <- data.frame(Sand_Key_Deep_2001_t)
colnames(Sand_Key_Deep_2001_donut) <- c("Value")
Sand_Key_Deep_2001_donut <- Sand_Key_Deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2001_donut,"Sand_Key_Deep_2001.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2001_donut_plot <- read.table("Sand_Key_Deep_2001.csv", header=TRUE, sep=",")


Sand_Key_Deep_2001_donut_plot_rounded <- Sand_Key_Deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2001_donut_plot_test <- cbind(Sand_Key_Deep_2001_donut_plot_rounded,Legend)


Sand_Key_Deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2001.png", width = 6, height = 6)





Sand_Key_Deep_2002 <- filter(Sand_Key_Deep_plot, Year == 2002)
Sand_Key_Deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2002_t <- t(Sand_Key_Deep_2002)

Sand_Key_Deep_2002_donut <- data.frame(Sand_Key_Deep_2002_t)
colnames(Sand_Key_Deep_2002_donut) <- c("Value")
Sand_Key_Deep_2002_donut <- Sand_Key_Deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2002_donut,"Sand_Key_Deep_2002.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2002_donut_plot <- read.table("Sand_Key_Deep_2002.csv", header=TRUE, sep=",")


Sand_Key_Deep_2002_donut_plot_rounded <- Sand_Key_Deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2002_donut_plot_test <- cbind(Sand_Key_Deep_2002_donut_plot_rounded,Legend)


Sand_Key_Deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2002.png", width = 6, height = 6)



Sand_Key_Deep_2003 <- filter(Sand_Key_Deep_plot, Year == 2003)
Sand_Key_Deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2003_t <- t(Sand_Key_Deep_2003)

Sand_Key_Deep_2003_donut <- data.frame(Sand_Key_Deep_2003_t)
colnames(Sand_Key_Deep_2003_donut) <- c("Value")
Sand_Key_Deep_2003_donut <- Sand_Key_Deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2003_donut,"Sand_Key_Deep_2003.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2003_donut_plot <- read.table("Sand_Key_Deep_2003.csv", header=TRUE, sep=",")


Sand_Key_Deep_2003_donut_plot_rounded <- Sand_Key_Deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2003_donut_plot_test <- cbind(Sand_Key_Deep_2003_donut_plot_rounded,Legend)


Sand_Key_Deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2003.png", width = 6, height = 6)




Sand_Key_Deep_2004 <- filter(Sand_Key_Deep_plot, Year == 2004)
Sand_Key_Deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2004_t <- t(Sand_Key_Deep_2004)

Sand_Key_Deep_2004_donut <- data.frame(Sand_Key_Deep_2004_t)
colnames(Sand_Key_Deep_2004_donut) <- c("Value")
Sand_Key_Deep_2004_donut <- Sand_Key_Deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2004_donut,"Sand_Key_Deep_2004.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2004_donut_plot <- read.table("Sand_Key_Deep_2004.csv", header=TRUE, sep=",")


Sand_Key_Deep_2004_donut_plot_rounded <- Sand_Key_Deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2004_donut_plot_test <- cbind(Sand_Key_Deep_2004_donut_plot_rounded,Legend)


Sand_Key_Deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2004.png", width = 6, height = 6)




Sand_Key_Deep_2005 <- filter(Sand_Key_Deep_plot, Year == 2005)
Sand_Key_Deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2005_t <- t(Sand_Key_Deep_2005)

Sand_Key_Deep_2005_donut <- data.frame(Sand_Key_Deep_2005_t)
colnames(Sand_Key_Deep_2005_donut) <- c("Value")
Sand_Key_Deep_2005_donut <- Sand_Key_Deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2005_donut,"Sand_Key_Deep_2005.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2005_donut_plot <- read.table("Sand_Key_Deep_2005.csv", header=TRUE, sep=",")


Sand_Key_Deep_2005_donut_plot_rounded <- Sand_Key_Deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2005_donut_plot_test <- cbind(Sand_Key_Deep_2005_donut_plot_rounded,Legend)


Sand_Key_Deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2005.png", width = 6, height = 6)





Sand_Key_Deep_2006 <- filter(Sand_Key_Deep_plot, Year == 2006)
Sand_Key_Deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2006_t <- t(Sand_Key_Deep_2006)

Sand_Key_Deep_2006_donut <- data.frame(Sand_Key_Deep_2006_t)
colnames(Sand_Key_Deep_2006_donut) <- c("Value")
Sand_Key_Deep_2006_donut <- Sand_Key_Deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2006_donut,"Sand_Key_Deep_2006.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2006_donut_plot <- read.table("Sand_Key_Deep_2006.csv", header=TRUE, sep=",")


Sand_Key_Deep_2006_donut_plot_rounded <- Sand_Key_Deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2006_donut_plot_test <- cbind(Sand_Key_Deep_2006_donut_plot_rounded,Legend)


Sand_Key_Deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2006.png", width = 6, height = 6)




Sand_Key_Deep_2007 <- filter(Sand_Key_Deep_plot, Year == 2007)
Sand_Key_Deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2007_t <- t(Sand_Key_Deep_2007)

Sand_Key_Deep_2007_donut <- data.frame(Sand_Key_Deep_2007_t)
colnames(Sand_Key_Deep_2007_donut) <- c("Value")
Sand_Key_Deep_2007_donut <- Sand_Key_Deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2007_donut,"Sand_Key_Deep_2007.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2007_donut_plot <- read.table("Sand_Key_Deep_2007.csv", header=TRUE, sep=",")


Sand_Key_Deep_2007_donut_plot_rounded <- Sand_Key_Deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2007_donut_plot_test <- cbind(Sand_Key_Deep_2007_donut_plot_rounded,Legend)


Sand_Key_Deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2007.png", width = 6, height = 6)




Sand_Key_Deep_2008 <- filter(Sand_Key_Deep_plot, Year == 2008)
Sand_Key_Deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2008_t <- t(Sand_Key_Deep_2008)

Sand_Key_Deep_2008_donut <- data.frame(Sand_Key_Deep_2008_t)
colnames(Sand_Key_Deep_2008_donut) <- c("Value")
Sand_Key_Deep_2008_donut <- Sand_Key_Deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2008_donut,"Sand_Key_Deep_2008.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2008_donut_plot <- read.table("Sand_Key_Deep_2008.csv", header=TRUE, sep=",")


Sand_Key_Deep_2008_donut_plot_rounded <- Sand_Key_Deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2008_donut_plot_test <- cbind(Sand_Key_Deep_2008_donut_plot_rounded,Legend)


Sand_Key_Deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2008.png", width = 6, height = 6)




Sand_Key_Deep_2009 <- filter(Sand_Key_Deep_plot, Year == 2009)
Sand_Key_Deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2009_t <- t(Sand_Key_Deep_2009)

Sand_Key_Deep_2009_donut <- data.frame(Sand_Key_Deep_2009_t)
colnames(Sand_Key_Deep_2009_donut) <- c("Value")
Sand_Key_Deep_2009_donut <- Sand_Key_Deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2009_donut,"Sand_Key_Deep_2009.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2009_donut_plot <- read.table("Sand_Key_Deep_2009.csv", header=TRUE, sep=",")


Sand_Key_Deep_2009_donut_plot_rounded <- Sand_Key_Deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2009_donut_plot_test <- cbind(Sand_Key_Deep_2009_donut_plot_rounded,Legend)


Sand_Key_Deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Sand_Key_Deep_2009.png", width = 6, height = 6)




Sand_Key_Deep_2010 <- filter(Sand_Key_Deep_plot, Year == 2010)
Sand_Key_Deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2010_t <- t(Sand_Key_Deep_2010)

Sand_Key_Deep_2010_donut <- data.frame(Sand_Key_Deep_2010_t)
colnames(Sand_Key_Deep_2010_donut) <- c("Value")
Sand_Key_Deep_2010_donut <- Sand_Key_Deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2010_donut,"Sand_Key_Deep_2010.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2010_donut_plot <- read.table("Sand_Key_Deep_2010.csv", header=TRUE, sep=",")


Sand_Key_Deep_2010_donut_plot_rounded <- Sand_Key_Deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2010_donut_plot_test <- cbind(Sand_Key_Deep_2010_donut_plot_rounded,Legend)


Sand_Key_Deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2010.png", width = 6, height = 6)




Sand_Key_Deep_2011 <- filter(Sand_Key_Deep_plot, Year == 2011)
Sand_Key_Deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2011_t <- t(Sand_Key_Deep_2011)

Sand_Key_Deep_2011_donut <- data.frame(Sand_Key_Deep_2011_t)
colnames(Sand_Key_Deep_2011_donut) <- c("Value")
Sand_Key_Deep_2011_donut <- Sand_Key_Deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2011_donut,"Sand_Key_Deep_2011.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2011_donut_plot <- read.table("Sand_Key_Deep_2011.csv", header=TRUE, sep=",")


Sand_Key_Deep_2011_donut_plot_rounded <- Sand_Key_Deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2011_donut_plot_test <- cbind(Sand_Key_Deep_2011_donut_plot_rounded,Legend)


Sand_Key_Deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2011.png", width = 6, height = 6)





Sand_Key_Deep_2012 <- filter(Sand_Key_Deep_plot, Year == 2012)
Sand_Key_Deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2012_t <- t(Sand_Key_Deep_2012)

Sand_Key_Deep_2012_donut <- data.frame(Sand_Key_Deep_2012_t)
colnames(Sand_Key_Deep_2012_donut) <- c("Value")
Sand_Key_Deep_2012_donut <- Sand_Key_Deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2012_donut,"Sand_Key_Deep_2012.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2012_donut_plot <- read.table("Sand_Key_Deep_2012.csv", header=TRUE, sep=",")


Sand_Key_Deep_2012_donut_plot_rounded <- Sand_Key_Deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2012_donut_plot_test <- cbind(Sand_Key_Deep_2012_donut_plot_rounded,Legend)


Sand_Key_Deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2012.png", width = 6, height = 6)






Sand_Key_Deep_2014 <- filter(Sand_Key_Deep_plot, Year == 2014)
Sand_Key_Deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2014_t <- t(Sand_Key_Deep_2014)

Sand_Key_Deep_2014_donut <- data.frame(Sand_Key_Deep_2014_t)
colnames(Sand_Key_Deep_2014_donut) <- c("Value")
Sand_Key_Deep_2014_donut <- Sand_Key_Deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2014_donut,"Sand_Key_Deep_2014.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2014_donut_plot <- read.table("Sand_Key_Deep_2014.csv", header=TRUE, sep=",")


Sand_Key_Deep_2014_donut_plot_rounded <- Sand_Key_Deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2014_donut_plot_test <- cbind(Sand_Key_Deep_2014_donut_plot_rounded,Legend)


Sand_Key_Deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2014.png", width = 6, height = 6)





Sand_Key_Deep_2016 <- filter(Sand_Key_Deep_plot, Year == 2016)
Sand_Key_Deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2016_t <- t(Sand_Key_Deep_2016)

Sand_Key_Deep_2016_donut <- data.frame(Sand_Key_Deep_2016_t)
colnames(Sand_Key_Deep_2016_donut) <- c("Value")
Sand_Key_Deep_2016_donut <- Sand_Key_Deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Deep_2016_donut,"Sand_Key_Deep_2016.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Deep_2016_donut_plot <- read.table("Sand_Key_Deep_2016.csv", header=TRUE, sep=",")


Sand_Key_Deep_2016_donut_plot_rounded <- Sand_Key_Deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Deep_2016_donut_plot_test <- cbind(Sand_Key_Deep_2016_donut_plot_rounded,Legend)


Sand_Key_Deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Deep_2016.png", width = 6, height = 6)





Sand_Key_Shallow <- filter(RVC_CREMP, sitename == "Sand Key Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Sand_Key_Shallow_fish <- Sand_Key_Shallow$sum/max(Sand_Key_Shallow$sum)
Sand_Key_Shallow_biomass <- data.frame(Sand_Key_Shallow_fish)

Sand_Key_Shallow_biomass <- 100*Sand_Key_Shallow_biomass


Sand_Key_Shallow_Stony <- Sand_Key_Shallow$Stony_coral/max(Sand_Key_Shallow$Stony_coral)
Sand_Key_Shallow_coral <- data.frame(Sand_Key_Shallow_Stony)

Sand_Key_Shallow_stony_coral <- 100*Sand_Key_Shallow_coral

Sand_Key_Shallow_macro <- Sand_Key_Shallow$Macroalgae/max(Sand_Key_Shallow$Macroalgae)
Sand_Key_Shallow_algae <- data.frame(Sand_Key_Shallow_macro)


Sand_Key_Shallow_macroalgae <- (100*Sand_Key_Shallow_algae)


Sand_Key_Shallow_plot <- cbind(Sand_Key_Shallow_macroalgae,Sand_Key_Shallow_biomass,Sand_Key_Shallow_stony_coral)

Sand_Key_Shallow_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Sand_Key_Shallow_1999 <- filter(Sand_Key_Shallow_plot, Year == 1999)
Sand_Key_Shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_1999_t <- t(Sand_Key_Shallow_1999)

Sand_Key_Shallow_1999_donut <- data.frame(Sand_Key_Shallow_1999_t)
colnames(Sand_Key_Shallow_1999_donut) <- c("Value")
Sand_Key_Shallow_1999_donut <- Sand_Key_Shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_1999_donut,"Sand_Key_Shallow_1999.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_1999_donut_plot <- read.table("Sand_Key_Shallow_1999.csv", header=TRUE, sep=",")


Sand_Key_Shallow_1999_donut_plot_rounded <- Sand_Key_Shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_1999_donut_plot_test <- cbind(Sand_Key_Shallow_1999_donut_plot_rounded,Legend)


Sand_Key_Shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_1999.png", width = 6, height = 6)



### Sand Key Shallow


Sand_Key_Shallow_2000 <- filter(Sand_Key_Shallow_plot, Year == 2000)
Sand_Key_Shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2000_t <- t(Sand_Key_Shallow_2000)

Sand_Key_Shallow_2000_donut <- data.frame(Sand_Key_Shallow_2000_t)
colnames(Sand_Key_Shallow_2000_donut) <- c("Value")
Sand_Key_Shallow_2000_donut <- Sand_Key_Shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2000_donut,"Sand_Key_Shallow_2000.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2000_donut_plot <- read.table("Sand_Key_Shallow_2000.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2000_donut_plot_rounded <- Sand_Key_Shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2000_donut_plot_test <- cbind(Sand_Key_Shallow_2000_donut_plot_rounded,Legend)


Sand_Key_Shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2000.png", width = 6, height = 6)




Sand_Key_Shallow_2001 <- filter(Sand_Key_Shallow_plot, Year == 2001)
Sand_Key_Shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2001_t <- t(Sand_Key_Shallow_2001)

Sand_Key_Shallow_2001_donut <- data.frame(Sand_Key_Shallow_2001_t)
colnames(Sand_Key_Shallow_2001_donut) <- c("Value")
Sand_Key_Shallow_2001_donut <- Sand_Key_Shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2001_donut,"Sand_Key_Shallow_2001.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2001_donut_plot <- read.table("Sand_Key_Shallow_2001.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2001_donut_plot_rounded <- Sand_Key_Shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2001_donut_plot_test <- cbind(Sand_Key_Shallow_2001_donut_plot_rounded,Legend)


Sand_Key_Shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2001.png", width = 6, height = 6)





Sand_Key_Shallow_2002 <- filter(Sand_Key_Shallow_plot, Year == 2002)
Sand_Key_Shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2002_t <- t(Sand_Key_Shallow_2002)

Sand_Key_Shallow_2002_donut <- data.frame(Sand_Key_Shallow_2002_t)
colnames(Sand_Key_Shallow_2002_donut) <- c("Value")
Sand_Key_Shallow_2002_donut <- Sand_Key_Shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2002_donut,"Sand_Key_Shallow_2002.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2002_donut_plot <- read.table("Sand_Key_Shallow_2002.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2002_donut_plot_rounded <- Sand_Key_Shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2002_donut_plot_test <- cbind(Sand_Key_Shallow_2002_donut_plot_rounded,Legend)


Sand_Key_Shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2002.png", width = 6, height = 6)



Sand_Key_Shallow_2003 <- filter(Sand_Key_Shallow_plot, Year == 2003)
Sand_Key_Shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2003_t <- t(Sand_Key_Shallow_2003)

Sand_Key_Shallow_2003_donut <- data.frame(Sand_Key_Shallow_2003_t)
colnames(Sand_Key_Shallow_2003_donut) <- c("Value")
Sand_Key_Shallow_2003_donut <- Sand_Key_Shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2003_donut,"Sand_Key_Shallow_2003.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2003_donut_plot <- read.table("Sand_Key_Shallow_2003.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2003_donut_plot_rounded <- Sand_Key_Shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2003_donut_plot_test <- cbind(Sand_Key_Shallow_2003_donut_plot_rounded,Legend)


Sand_Key_Shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2003.png", width = 6, height = 6)




Sand_Key_Shallow_2004 <- filter(Sand_Key_Shallow_plot, Year == 2004)
Sand_Key_Shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2004_t <- t(Sand_Key_Shallow_2004)

Sand_Key_Shallow_2004_donut <- data.frame(Sand_Key_Shallow_2004_t)
colnames(Sand_Key_Shallow_2004_donut) <- c("Value")
Sand_Key_Shallow_2004_donut <- Sand_Key_Shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2004_donut,"Sand_Key_Shallow_2004.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2004_donut_plot <- read.table("Sand_Key_Shallow_2004.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2004_donut_plot_rounded <- Sand_Key_Shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2004_donut_plot_test <- cbind(Sand_Key_Shallow_2004_donut_plot_rounded,Legend)


Sand_Key_Shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2004.png", width = 6, height = 6)




Sand_Key_Shallow_2005 <- filter(Sand_Key_Shallow_plot, Year == 2005)
Sand_Key_Shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2005_t <- t(Sand_Key_Shallow_2005)

Sand_Key_Shallow_2005_donut <- data.frame(Sand_Key_Shallow_2005_t)
colnames(Sand_Key_Shallow_2005_donut) <- c("Value")
Sand_Key_Shallow_2005_donut <- Sand_Key_Shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2005_donut,"Sand_Key_Shallow_2005.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2005_donut_plot <- read.table("Sand_Key_Shallow_2005.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2005_donut_plot_rounded <- Sand_Key_Shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2005_donut_plot_test <- cbind(Sand_Key_Shallow_2005_donut_plot_rounded,Legend)


Sand_Key_Shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2005.png", width = 6, height = 6)





Sand_Key_Shallow_2006 <- filter(Sand_Key_Shallow_plot, Year == 2006)
Sand_Key_Shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2006_t <- t(Sand_Key_Shallow_2006)

Sand_Key_Shallow_2006_donut <- data.frame(Sand_Key_Shallow_2006_t)
colnames(Sand_Key_Shallow_2006_donut) <- c("Value")
Sand_Key_Shallow_2006_donut <- Sand_Key_Shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2006_donut,"Sand_Key_Shallow_2006.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2006_donut_plot <- read.table("Sand_Key_Shallow_2006.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2006_donut_plot_rounded <- Sand_Key_Shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2006_donut_plot_test <- cbind(Sand_Key_Shallow_2006_donut_plot_rounded,Legend)


Sand_Key_Shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2006.png", width = 6, height = 6)




Sand_Key_Shallow_2007 <- filter(Sand_Key_Shallow_plot, Year == 2007)
Sand_Key_Shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2007_t <- t(Sand_Key_Shallow_2007)

Sand_Key_Shallow_2007_donut <- data.frame(Sand_Key_Shallow_2007_t)
colnames(Sand_Key_Shallow_2007_donut) <- c("Value")
Sand_Key_Shallow_2007_donut <- Sand_Key_Shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2007_donut,"Sand_Key_Shallow_2007.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2007_donut_plot <- read.table("Sand_Key_Shallow_2007.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2007_donut_plot_rounded <- Sand_Key_Shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2007_donut_plot_test <- cbind(Sand_Key_Shallow_2007_donut_plot_rounded,Legend)


Sand_Key_Shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2007.png", width = 6, height = 6)




Sand_Key_Shallow_2008 <- filter(Sand_Key_Shallow_plot, Year == 2008)
Sand_Key_Shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2008_t <- t(Sand_Key_Shallow_2008)

Sand_Key_Shallow_2008_donut <- data.frame(Sand_Key_Shallow_2008_t)
colnames(Sand_Key_Shallow_2008_donut) <- c("Value")
Sand_Key_Shallow_2008_donut <- Sand_Key_Shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2008_donut,"Sand_Key_Shallow_2008.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2008_donut_plot <- read.table("Sand_Key_Shallow_2008.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2008_donut_plot_rounded <- Sand_Key_Shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2008_donut_plot_test <- cbind(Sand_Key_Shallow_2008_donut_plot_rounded,Legend)


Sand_Key_Shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2008.png", width = 6, height = 6)




Sand_Key_Shallow_2009 <- filter(Sand_Key_Shallow_plot, Year == 2009)
Sand_Key_Shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2009_t <- t(Sand_Key_Shallow_2009)

Sand_Key_Shallow_2009_donut <- data.frame(Sand_Key_Shallow_2009_t)
colnames(Sand_Key_Shallow_2009_donut) <- c("Value")
Sand_Key_Shallow_2009_donut <- Sand_Key_Shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2009_donut,"Sand_Key_Shallow_2009.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2009_donut_plot <- read.table("Sand_Key_Shallow_2009.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2009_donut_plot_rounded <- Sand_Key_Shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2009_donut_plot_test <- cbind(Sand_Key_Shallow_2009_donut_plot_rounded,Legend)


Sand_Key_Shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2009.png", width = 6, height = 6)




Sand_Key_Shallow_2010 <- filter(Sand_Key_Shallow_plot, Year == 2010)
Sand_Key_Shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2010_t <- t(Sand_Key_Shallow_2010)

Sand_Key_Shallow_2010_donut <- data.frame(Sand_Key_Shallow_2010_t)
colnames(Sand_Key_Shallow_2010_donut) <- c("Value")
Sand_Key_Shallow_2010_donut <- Sand_Key_Shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2010_donut,"Sand_Key_Shallow_2010.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2010_donut_plot <- read.table("Sand_Key_Shallow_2010.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2010_donut_plot_rounded <- Sand_Key_Shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2010_donut_plot_test <- cbind(Sand_Key_Shallow_2010_donut_plot_rounded,Legend)


Sand_Key_Shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Sand_Key_Shallow_2010.png", width = 6, height = 6)




Sand_Key_Shallow_2011 <- filter(Sand_Key_Shallow_plot, Year == 2011)
Sand_Key_Shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2011_t <- t(Sand_Key_Shallow_2011)

Sand_Key_Shallow_2011_donut <- data.frame(Sand_Key_Shallow_2011_t)
colnames(Sand_Key_Shallow_2011_donut) <- c("Value")
Sand_Key_Shallow_2011_donut <- Sand_Key_Shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2011_donut,"Sand_Key_Shallow_2011.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2011_donut_plot <- read.table("Sand_Key_Shallow_2011.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2011_donut_plot_rounded <- Sand_Key_Shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2011_donut_plot_test <- cbind(Sand_Key_Shallow_2011_donut_plot_rounded,Legend)


Sand_Key_Shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2011.png", width = 6, height = 6)





Sand_Key_Shallow_2012 <- filter(Sand_Key_Shallow_plot, Year == 2012)
Sand_Key_Shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2012_t <- t(Sand_Key_Shallow_2012)

Sand_Key_Shallow_2012_donut <- data.frame(Sand_Key_Shallow_2012_t)
colnames(Sand_Key_Shallow_2012_donut) <- c("Value")
Sand_Key_Shallow_2012_donut <- Sand_Key_Shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2012_donut,"Sand_Key_Shallow_2012.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2012_donut_plot <- read.table("Sand_Key_Shallow_2012.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2012_donut_plot_rounded <- Sand_Key_Shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2012_donut_plot_test <- cbind(Sand_Key_Shallow_2012_donut_plot_rounded,Legend)


Sand_Key_Shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2012.png", width = 6, height = 6)






Sand_Key_Shallow_2014 <- filter(Sand_Key_Shallow_plot, Year == 2014)
Sand_Key_Shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2014_t <- t(Sand_Key_Shallow_2014)

Sand_Key_Shallow_2014_donut <- data.frame(Sand_Key_Shallow_2014_t)
colnames(Sand_Key_Shallow_2014_donut) <- c("Value")
Sand_Key_Shallow_2014_donut <- Sand_Key_Shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2014_donut,"Sand_Key_Shallow_2014.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2014_donut_plot <- read.table("Sand_Key_Shallow_2014.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2014_donut_plot_rounded <- Sand_Key_Shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2014_donut_plot_test <- cbind(Sand_Key_Shallow_2014_donut_plot_rounded,Legend)


Sand_Key_Shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2014.png", width = 6, height = 6)





Sand_Key_Shallow_2016 <- filter(Sand_Key_Shallow_plot, Year == 2016)
Sand_Key_Shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Sand_Key_Shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2016_t <- t(Sand_Key_Shallow_2016)

Sand_Key_Shallow_2016_donut <- data.frame(Sand_Key_Shallow_2016_t)
colnames(Sand_Key_Shallow_2016_donut) <- c("Value")
Sand_Key_Shallow_2016_donut <- Sand_Key_Shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Sand_Key_Shallow_2016_donut,"Sand_Key_Shallow_2016.csv")


### import as csv (change category and value to the two column names)

Sand_Key_Shallow_2016_donut_plot <- read.table("Sand_Key_Shallow_2016.csv", header=TRUE, sep=",")


Sand_Key_Shallow_2016_donut_plot_rounded <- Sand_Key_Shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Sand_Key_Shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Sand_Key_Shallow_2016_donut_plot_test <- cbind(Sand_Key_Shallow_2016_donut_plot_rounded,Legend)


Sand_Key_Shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Sand Key Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Sand_Key_Shallow_2016.png", width = 6, height = 6)


# 
# 
# 
# Smith_Shoal <- filter(RVC_CREMP, sitename == "Smith Shoal")
# 
# ## Make percentages of sum, stony coral cover, and macroalgae
# 
# Smith_Shoal_fish <- Smith_Shoal$sum/max(Smith_Shoal$sum)
# Smith_Shoal_biomass <- data.frame(Smith_Shoal_fish)
# 
# Smith_Shoal_biomass <- 100*Smith_Shoal_biomass
# 
# 
# Smith_Shoal_Stony <- Smith_Shoal$Stony_coral/max(Smith_Shoal$Stony_coral)
# Smith_Shoal_coral <- data.frame(Smith_Shoal_Stony)
# 
# Smith_Shoal_stony_coral <- 100*Smith_Shoal_coral
# 
# Smith_Shoal_macro <- Smith_Shoal$Macroalgae/max(Smith_Shoal$Macroalgae)
# Smith_Shoal_algae <- data.frame(Smith_Shoal_macro)
# 
# 
# Smith_Shoal_macroalgae <- (100*Smith_Shoal_algae)
# 
# 
# Smith_Shoal_plot <- cbind(Smith_Shoal_macroalgae,Smith_Shoal_biomass,Smith_Shoal_stony_coral)
# 
# Smith_Shoal_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2014")
# 
# ### Filter per year
# 
# Smith_Shoal_1999 <- filter(Smith_Shoal_plot, Year == 1999)
# Smith_Shoal_1999$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_1999_t <- t(Smith_Shoal_1999)
# 
# Smith_Shoal_1999_donut <- data.frame(Smith_Shoal_1999_t)
# colnames(Smith_Shoal_1999_donut) <- c("Value")
# Smith_Shoal_1999_donut <- Smith_Shoal_1999_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_1999_donut,"Smith_Shoal_1999.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_1999_donut_plot <- read.table("Smith_Shoal_1999.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_1999_donut_plot_rounded <- Smith_Shoal_1999_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_1999_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_1999_donut_plot_test <- cbind(Smith_Shoal_1999_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_1999_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 1999") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_1999.png", width = 6, height = 6)
# 
# 
# 
# ### Smith Shoal
# 
# 
# Smith_Shoal_2000 <- filter(Smith_Shoal_plot, Year == 2000)
# Smith_Shoal_2000$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2000_t <- t(Smith_Shoal_2000)
# 
# Smith_Shoal_2000_donut <- data.frame(Smith_Shoal_2000_t)
# colnames(Smith_Shoal_2000_donut) <- c("Value")
# Smith_Shoal_2000_donut <- Smith_Shoal_2000_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2000_donut,"Smith_Shoal_2000.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2000_donut_plot <- read.table("Smith_Shoal_2000.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2000_donut_plot_rounded <- Smith_Shoal_2000_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2000_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2000_donut_plot_test <- cbind(Smith_Shoal_2000_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2000_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2000") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2000.png", width = 6, height = 6)
# 
# 
# 
# 
# Smith_Shoal_2001 <- filter(Smith_Shoal_plot, Year == 2001)
# Smith_Shoal_2001$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2001_t <- t(Smith_Shoal_2001)
# 
# Smith_Shoal_2001_donut <- data.frame(Smith_Shoal_2001_t)
# colnames(Smith_Shoal_2001_donut) <- c("Value")
# Smith_Shoal_2001_donut <- Smith_Shoal_2001_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2001_donut,"Smith_Shoal_2001.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2001_donut_plot <- read.table("Smith_Shoal_2001.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2001_donut_plot_rounded <- Smith_Shoal_2001_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2001_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2001_donut_plot_test <- cbind(Smith_Shoal_2001_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2001_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2001") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2001.png", width = 6, height = 6)
# 
# 
# 
# 
# 
# Smith_Shoal_2002 <- filter(Smith_Shoal_plot, Year == 2002)
# Smith_Shoal_2002$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2002_t <- t(Smith_Shoal_2002)
# 
# Smith_Shoal_2002_donut <- data.frame(Smith_Shoal_2002_t)
# colnames(Smith_Shoal_2002_donut) <- c("Value")
# Smith_Shoal_2002_donut <- Smith_Shoal_2002_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2002_donut,"Smith_Shoal_2002.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2002_donut_plot <- read.table("Smith_Shoal_2002.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2002_donut_plot_rounded <- Smith_Shoal_2002_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2002_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2002_donut_plot_test <- cbind(Smith_Shoal_2002_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2002_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2002") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2002.png", width = 6, height = 6)
# 
# 
# 
# Smith_Shoal_2003 <- filter(Smith_Shoal_plot, Year == 2003)
# Smith_Shoal_2003$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2003_t <- t(Smith_Shoal_2003)
# 
# Smith_Shoal_2003_donut <- data.frame(Smith_Shoal_2003_t)
# colnames(Smith_Shoal_2003_donut) <- c("Value")
# Smith_Shoal_2003_donut <- Smith_Shoal_2003_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2003_donut,"Smith_Shoal_2003.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2003_donut_plot <- read.table("Smith_Shoal_2003.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2003_donut_plot_rounded <- Smith_Shoal_2003_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2003_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2003_donut_plot_test <- cbind(Smith_Shoal_2003_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2003_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2003") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2003.png", width = 6, height = 6)
# 
# 
# 
# 
# Smith_Shoal_2004 <- filter(Smith_Shoal_plot, Year == 2004)
# Smith_Shoal_2004$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2004_t <- t(Smith_Shoal_2004)
# 
# Smith_Shoal_2004_donut <- data.frame(Smith_Shoal_2004_t)
# colnames(Smith_Shoal_2004_donut) <- c("Value")
# Smith_Shoal_2004_donut <- Smith_Shoal_2004_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2004_donut,"Smith_Shoal_2004.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2004_donut_plot <- read.table("Smith_Shoal_2004.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2004_donut_plot_rounded <- Smith_Shoal_2004_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2004_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2004_donut_plot_test <- cbind(Smith_Shoal_2004_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2004_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2004") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2004.png", width = 6, height = 6)
# 
# 
# 
# 
# Smith_Shoal_2005 <- filter(Smith_Shoal_plot, Year == 2005)
# Smith_Shoal_2005$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2005_t <- t(Smith_Shoal_2005)
# 
# Smith_Shoal_2005_donut <- data.frame(Smith_Shoal_2005_t)
# colnames(Smith_Shoal_2005_donut) <- c("Value")
# Smith_Shoal_2005_donut <- Smith_Shoal_2005_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2005_donut,"Smith_Shoal_2005.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2005_donut_plot <- read.table("Smith_Shoal_2005.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2005_donut_plot_rounded <- Smith_Shoal_2005_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2005_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2005_donut_plot_test <- cbind(Smith_Shoal_2005_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2005_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2005") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2005.png", width = 6, height = 6)
# 
# 
# 
# 
# 
# Smith_Shoal_2006 <- filter(Smith_Shoal_plot, Year == 2006)
# Smith_Shoal_2006$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2006_t <- t(Smith_Shoal_2006)
# 
# Smith_Shoal_2006_donut <- data.frame(Smith_Shoal_2006_t)
# colnames(Smith_Shoal_2006_donut) <- c("Value")
# Smith_Shoal_2006_donut <- Smith_Shoal_2006_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2006_donut,"Smith_Shoal_2006.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2006_donut_plot <- read.table("Smith_Shoal_2006.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2006_donut_plot_rounded <- Smith_Shoal_2006_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2006_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2006_donut_plot_test <- cbind(Smith_Shoal_2006_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2006_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2006") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2006.png", width = 6, height = 6)
# 
# 
# 
# 
# Smith_Shoal_2007 <- filter(Smith_Shoal_plot, Year == 2007)
# Smith_Shoal_2007$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2007_t <- t(Smith_Shoal_2007)
# 
# Smith_Shoal_2007_donut <- data.frame(Smith_Shoal_2007_t)
# colnames(Smith_Shoal_2007_donut) <- c("Value")
# Smith_Shoal_2007_donut <- Smith_Shoal_2007_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2007_donut,"Smith_Shoal_2007.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2007_donut_plot <- read.table("Smith_Shoal_2007.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2007_donut_plot_rounded <- Smith_Shoal_2007_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2007_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2007_donut_plot_test <- cbind(Smith_Shoal_2007_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2007_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2007") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2007.png", width = 6, height = 6)
# 
# 
# 
# 
# Smith_Shoal_2008 <- filter(Smith_Shoal_plot, Year == 2008)
# Smith_Shoal_2008$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2008_t <- t(Smith_Shoal_2008)
# 
# Smith_Shoal_2008_donut <- data.frame(Smith_Shoal_2008_t)
# colnames(Smith_Shoal_2008_donut) <- c("Value")
# Smith_Shoal_2008_donut <- Smith_Shoal_2008_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2008_donut,"Smith_Shoal_2008.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2008_donut_plot <- read.table("Smith_Shoal_2008.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2008_donut_plot_rounded <- Smith_Shoal_2008_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2008_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2008_donut_plot_test <- cbind(Smith_Shoal_2008_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2008_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2008") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2008.png", width = 6, height = 6)
# 
# 
# 
# 
# Smith_Shoal_2009 <- filter(Smith_Shoal_plot, Year == 2009)
# Smith_Shoal_2009$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2009_t <- t(Smith_Shoal_2009)
# 
# Smith_Shoal_2009_donut <- data.frame(Smith_Shoal_2009_t)
# colnames(Smith_Shoal_2009_donut) <- c("Value")
# Smith_Shoal_2009_donut <- Smith_Shoal_2009_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2009_donut,"Smith_Shoal_2009.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2009_donut_plot <- read.table("Smith_Shoal_2009.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2009_donut_plot_rounded <- Smith_Shoal_2009_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2009_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2009_donut_plot_test <- cbind(Smith_Shoal_2009_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2009_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2009") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# #ggsave ("plots/Smith_Shoal_2009.png", width = 6, height = 6)
# 
# 
# 
# 
# Smith_Shoal_2010 <- filter(Smith_Shoal_plot, Year == 2010)
# Smith_Shoal_2010$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2010_t <- t(Smith_Shoal_2010)
# 
# Smith_Shoal_2010_donut <- data.frame(Smith_Shoal_2010_t)
# colnames(Smith_Shoal_2010_donut) <- c("Value")
# Smith_Shoal_2010_donut <- Smith_Shoal_2010_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2010_donut,"Smith_Shoal_2010.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2010_donut_plot <- read.table("Smith_Shoal_2010.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2010_donut_plot_rounded <- Smith_Shoal_2010_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2010_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2010_donut_plot_test <- cbind(Smith_Shoal_2010_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2010_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2010") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2010.png", width = 6, height = 6)
# 
# 
# 
# 
# Smith_Shoal_2011 <- filter(Smith_Shoal_plot, Year == 2011)
# Smith_Shoal_2011$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2011_t <- t(Smith_Shoal_2011)
# 
# Smith_Shoal_2011_donut <- data.frame(Smith_Shoal_2011_t)
# colnames(Smith_Shoal_2011_donut) <- c("Value")
# Smith_Shoal_2011_donut <- Smith_Shoal_2011_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2011_donut,"Smith_Shoal_2011.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2011_donut_plot <- read.table("Smith_Shoal_2011.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2011_donut_plot_rounded <- Smith_Shoal_2011_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2011_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2011_donut_plot_test <- cbind(Smith_Shoal_2011_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2011_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2011") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2011.png", width = 6, height = 6)
# 
# 
# 
# 
# 
# Smith_Shoal_2012 <- filter(Smith_Shoal_plot, Year == 2012)
# Smith_Shoal_2012$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2012_t <- t(Smith_Shoal_2012)
# 
# Smith_Shoal_2012_donut <- data.frame(Smith_Shoal_2012_t)
# colnames(Smith_Shoal_2012_donut) <- c("Value")
# Smith_Shoal_2012_donut <- Smith_Shoal_2012_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2012_donut,"Smith_Shoal_2012.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2012_donut_plot <- read.table("Smith_Shoal_2012.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2012_donut_plot_rounded <- Smith_Shoal_2012_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2012_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2012_donut_plot_test <- cbind(Smith_Shoal_2012_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2012_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2012") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2012.png", width = 6, height = 6)
# 
# 
# 
# 
# 
# 
# Smith_Shoal_2014 <- filter(Smith_Shoal_plot, Year == 2014)
# Smith_Shoal_2014$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2014_t <- t(Smith_Shoal_2014)
# 
# Smith_Shoal_2014_donut <- data.frame(Smith_Shoal_2014_t)
# colnames(Smith_Shoal_2014_donut) <- c("Value")
# Smith_Shoal_2014_donut <- Smith_Shoal_2014_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2014_donut,"Smith_Shoal_2014.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2014_donut_plot <- read.table("Smith_Shoal_2014.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2014_donut_plot_rounded <- Smith_Shoal_2014_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2014_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2014_donut_plot_test <- cbind(Smith_Shoal_2014_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2014_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2014") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2014.png", width = 6, height = 6)
# 
# 
# 
# 
# 
# Smith_Shoal_2016 <- filter(Smith_Shoal_plot, Year == 2016)
# Smith_Shoal_2016$Year <- NULL
# 
# 
# ### Donut Plot
# 
# ## manipulate data
# 
# colnames(Smith_Shoal_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2016_t <- t(Smith_Shoal_2016)
# 
# Smith_Shoal_2016_donut <- data.frame(Smith_Shoal_2016_t)
# colnames(Smith_Shoal_2016_donut) <- c("Value")
# Smith_Shoal_2016_donut <- Smith_Shoal_2016_donut %>%
#   rownames_to_column(var = "Category")
# 
# 
# export(Smith_Shoal_2016_donut,"Smith_Shoal_2016.csv")
# 
# 
# ### import as csv (change category and value to the two column names)
# 
# Smith_Shoal_2016_donut_plot <- read.table("Smith_Shoal_2016.csv", header=TRUE, sep=",")
# 
# 
# Smith_Shoal_2016_donut_plot_rounded <- Smith_Shoal_2016_donut_plot %>%
#   mutate_if(is.numeric,round,digits = 0)
# Smith_Shoal_2016_donut_plot_rounded
# 
# 
# # plot
# 
# ## This allows the columns to be different colors and the legend variables
# 
# Legend = c("Macroalgae","Fish Biomass","Stony Coral")
# Smith_Shoal_2016_donut_plot_test <- cbind(Smith_Shoal_2016_donut_plot_rounded,Legend)
# 
# 
# Smith_Shoal_2016_donut_plot_test %>%
#   filter(!is.na(Value)) %>%
#   arrange(Value) %>%
#   tail(6) %>%
#   mutate(Category=factor(Category, Category)) %>%
#   ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Smith Shoal 2016") +
#   geom_bar(show.legend = TRUE, stat="identity") +
#   scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
#   geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
#   theme_ipsum() +
#   theme(
#     plot.title = element_text(hjust = 0.5),
#     plot.subtitle = element_text(hjust = 0.5),
#     panel.grid.minor = element_blank(),
#     panel.grid.major = element_blank(),
#     legend.position="bottom",
#     legend.background = element_blank(),
#     legend.box.background = element_rect(colour = "black"),
#     legend.text = element_text(size = 10),
#     axis.text = element_blank()
#   ) +
#   xlab("") +
#   ylab("") +
#   coord_polar(theta = "y") +
#   ylim(0,100)
# 
# ggsave ("plots/Smith_Shoal_2016.png", width = 6, height = 6)
# 
# 



Western_Sambo_Deep <- filter(RVC_CREMP, sitename == "Western Sambo Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Western_Sambo_Deep_fish <- Western_Sambo_Deep$sum/max(Western_Sambo_Deep$sum)
Western_Sambo_Deep_biomass <- data.frame(Western_Sambo_Deep_fish)

Western_Sambo_Deep_biomass <- 100*Western_Sambo_Deep_biomass


Western_Sambo_Deep_Stony <- Western_Sambo_Deep$Stony_coral/max(Western_Sambo_Deep$Stony_coral)
Western_Sambo_Deep_coral <- data.frame(Western_Sambo_Deep_Stony)

Western_Sambo_Deep_stony_coral <- 100*Western_Sambo_Deep_coral

Western_Sambo_Deep_macro <- Western_Sambo_Deep$Macroalgae/max(Western_Sambo_Deep$Macroalgae)
Western_Sambo_Deep_algae <- data.frame(Western_Sambo_Deep_macro)


Western_Sambo_Deep_macroalgae <- (100*Western_Sambo_Deep_algae)


Western_Sambo_Deep_plot <- cbind(Western_Sambo_Deep_macroalgae,Western_Sambo_Deep_biomass,Western_Sambo_Deep_stony_coral)

Western_Sambo_Deep_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2010","2011","2012","2014","2016")

### Filter per year

Western_Sambo_Deep_1999 <- filter(Western_Sambo_Deep_plot, Year == 1999)
Western_Sambo_Deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_1999_t <- t(Western_Sambo_Deep_1999)

Western_Sambo_Deep_1999_donut <- data.frame(Western_Sambo_Deep_1999_t)
colnames(Western_Sambo_Deep_1999_donut) <- c("Value")
Western_Sambo_Deep_1999_donut <- Western_Sambo_Deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_1999_donut,"Western_Sambo_Deep_1999.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_1999_donut_plot <- read.table("Western_Sambo_Deep_1999.csv", header=TRUE, sep=",")


Western_Sambo_Deep_1999_donut_plot_rounded <- Western_Sambo_Deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_1999_donut_plot_test <- cbind(Western_Sambo_Deep_1999_donut_plot_rounded,Legend)


Western_Sambo_Deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_1999.png", width = 6, height = 6)



### Western Sambo Deep


Western_Sambo_Deep_2000 <- filter(Western_Sambo_Deep_plot, Year == 2000)
Western_Sambo_Deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2000_t <- t(Western_Sambo_Deep_2000)

Western_Sambo_Deep_2000_donut <- data.frame(Western_Sambo_Deep_2000_t)
colnames(Western_Sambo_Deep_2000_donut) <- c("Value")
Western_Sambo_Deep_2000_donut <- Western_Sambo_Deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2000_donut,"Western_Sambo_Deep_2000.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2000_donut_plot <- read.table("Western_Sambo_Deep_2000.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2000_donut_plot_rounded <- Western_Sambo_Deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2000_donut_plot_test <- cbind(Western_Sambo_Deep_2000_donut_plot_rounded,Legend)


Western_Sambo_Deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2000.png", width = 6, height = 6)




Western_Sambo_Deep_2001 <- filter(Western_Sambo_Deep_plot, Year == 2001)
Western_Sambo_Deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2001_t <- t(Western_Sambo_Deep_2001)

Western_Sambo_Deep_2001_donut <- data.frame(Western_Sambo_Deep_2001_t)
colnames(Western_Sambo_Deep_2001_donut) <- c("Value")
Western_Sambo_Deep_2001_donut <- Western_Sambo_Deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2001_donut,"Western_Sambo_Deep_2001.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2001_donut_plot <- read.table("Western_Sambo_Deep_2001.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2001_donut_plot_rounded <- Western_Sambo_Deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2001_donut_plot_test <- cbind(Western_Sambo_Deep_2001_donut_plot_rounded,Legend)


Western_Sambo_Deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2001.png", width = 6, height = 6)





Western_Sambo_Deep_2002 <- filter(Western_Sambo_Deep_plot, Year == 2002)
Western_Sambo_Deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2002_t <- t(Western_Sambo_Deep_2002)

Western_Sambo_Deep_2002_donut <- data.frame(Western_Sambo_Deep_2002_t)
colnames(Western_Sambo_Deep_2002_donut) <- c("Value")
Western_Sambo_Deep_2002_donut <- Western_Sambo_Deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2002_donut,"Western_Sambo_Deep_2002.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2002_donut_plot <- read.table("Western_Sambo_Deep_2002.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2002_donut_plot_rounded <- Western_Sambo_Deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2002_donut_plot_test <- cbind(Western_Sambo_Deep_2002_donut_plot_rounded,Legend)


Western_Sambo_Deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2002.png", width = 6, height = 6)



Western_Sambo_Deep_2003 <- filter(Western_Sambo_Deep_plot, Year == 2003)
Western_Sambo_Deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2003_t <- t(Western_Sambo_Deep_2003)

Western_Sambo_Deep_2003_donut <- data.frame(Western_Sambo_Deep_2003_t)
colnames(Western_Sambo_Deep_2003_donut) <- c("Value")
Western_Sambo_Deep_2003_donut <- Western_Sambo_Deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2003_donut,"Western_Sambo_Deep_2003.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2003_donut_plot <- read.table("Western_Sambo_Deep_2003.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2003_donut_plot_rounded <- Western_Sambo_Deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2003_donut_plot_test <- cbind(Western_Sambo_Deep_2003_donut_plot_rounded,Legend)


Western_Sambo_Deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2003.png", width = 6, height = 6)




Western_Sambo_Deep_2004 <- filter(Western_Sambo_Deep_plot, Year == 2004)
Western_Sambo_Deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2004_t <- t(Western_Sambo_Deep_2004)

Western_Sambo_Deep_2004_donut <- data.frame(Western_Sambo_Deep_2004_t)
colnames(Western_Sambo_Deep_2004_donut) <- c("Value")
Western_Sambo_Deep_2004_donut <- Western_Sambo_Deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2004_donut,"Western_Sambo_Deep_2004.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2004_donut_plot <- read.table("Western_Sambo_Deep_2004.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2004_donut_plot_rounded <- Western_Sambo_Deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2004_donut_plot_test <- cbind(Western_Sambo_Deep_2004_donut_plot_rounded,Legend)


Western_Sambo_Deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2004.png", width = 6, height = 6)




Western_Sambo_Deep_2005 <- filter(Western_Sambo_Deep_plot, Year == 2005)
Western_Sambo_Deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2005_t <- t(Western_Sambo_Deep_2005)

Western_Sambo_Deep_2005_donut <- data.frame(Western_Sambo_Deep_2005_t)
colnames(Western_Sambo_Deep_2005_donut) <- c("Value")
Western_Sambo_Deep_2005_donut <- Western_Sambo_Deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2005_donut,"Western_Sambo_Deep_2005.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2005_donut_plot <- read.table("Western_Sambo_Deep_2005.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2005_donut_plot_rounded <- Western_Sambo_Deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2005_donut_plot_test <- cbind(Western_Sambo_Deep_2005_donut_plot_rounded,Legend)


Western_Sambo_Deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2005.png", width = 6, height = 6)





Western_Sambo_Deep_2006 <- filter(Western_Sambo_Deep_plot, Year == 2006)
Western_Sambo_Deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2006_t <- t(Western_Sambo_Deep_2006)

Western_Sambo_Deep_2006_donut <- data.frame(Western_Sambo_Deep_2006_t)
colnames(Western_Sambo_Deep_2006_donut) <- c("Value")
Western_Sambo_Deep_2006_donut <- Western_Sambo_Deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2006_donut,"Western_Sambo_Deep_2006.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2006_donut_plot <- read.table("Western_Sambo_Deep_2006.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2006_donut_plot_rounded <- Western_Sambo_Deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2006_donut_plot_test <- cbind(Western_Sambo_Deep_2006_donut_plot_rounded,Legend)


Western_Sambo_Deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2006.png", width = 6, height = 6)




Western_Sambo_Deep_2007 <- filter(Western_Sambo_Deep_plot, Year == 2007)
Western_Sambo_Deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2007_t <- t(Western_Sambo_Deep_2007)

Western_Sambo_Deep_2007_donut <- data.frame(Western_Sambo_Deep_2007_t)
colnames(Western_Sambo_Deep_2007_donut) <- c("Value")
Western_Sambo_Deep_2007_donut <- Western_Sambo_Deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2007_donut,"Western_Sambo_Deep_2007.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2007_donut_plot <- read.table("Western_Sambo_Deep_2007.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2007_donut_plot_rounded <- Western_Sambo_Deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2007_donut_plot_test <- cbind(Western_Sambo_Deep_2007_donut_plot_rounded,Legend)


Western_Sambo_Deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2007.png", width = 6, height = 6)




Western_Sambo_Deep_2008 <- filter(Western_Sambo_Deep_plot, Year == 2008)
Western_Sambo_Deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2008_t <- t(Western_Sambo_Deep_2008)

Western_Sambo_Deep_2008_donut <- data.frame(Western_Sambo_Deep_2008_t)
colnames(Western_Sambo_Deep_2008_donut) <- c("Value")
Western_Sambo_Deep_2008_donut <- Western_Sambo_Deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2008_donut,"Western_Sambo_Deep_2008.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2008_donut_plot <- read.table("Western_Sambo_Deep_2008.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2008_donut_plot_rounded <- Western_Sambo_Deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2008_donut_plot_test <- cbind(Western_Sambo_Deep_2008_donut_plot_rounded,Legend)


Western_Sambo_Deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2008.png", width = 6, height = 6)




Western_Sambo_Deep_2009 <- filter(Western_Sambo_Deep_plot, Year == 2009)
Western_Sambo_Deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2009_t <- t(Western_Sambo_Deep_2009)

Western_Sambo_Deep_2009_donut <- data.frame(Western_Sambo_Deep_2009_t)
colnames(Western_Sambo_Deep_2009_donut) <- c("Value")
Western_Sambo_Deep_2009_donut <- Western_Sambo_Deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2009_donut,"Western_Sambo_Deep_2009.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2009_donut_plot <- read.table("Western_Sambo_Deep_2009.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2009_donut_plot_rounded <- Western_Sambo_Deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2009_donut_plot_test <- cbind(Western_Sambo_Deep_2009_donut_plot_rounded,Legend)


Western_Sambo_Deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Western_Sambo_Deep_2009.png", width = 6, height = 6)




Western_Sambo_Deep_2010 <- filter(Western_Sambo_Deep_plot, Year == 2010)
Western_Sambo_Deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2010_t <- t(Western_Sambo_Deep_2010)

Western_Sambo_Deep_2010_donut <- data.frame(Western_Sambo_Deep_2010_t)
colnames(Western_Sambo_Deep_2010_donut) <- c("Value")
Western_Sambo_Deep_2010_donut <- Western_Sambo_Deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2010_donut,"Western_Sambo_Deep_2010.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2010_donut_plot <- read.table("Western_Sambo_Deep_2010.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2010_donut_plot_rounded <- Western_Sambo_Deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2010_donut_plot_test <- cbind(Western_Sambo_Deep_2010_donut_plot_rounded,Legend)


Western_Sambo_Deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2010.png", width = 6, height = 6)




Western_Sambo_Deep_2011 <- filter(Western_Sambo_Deep_plot, Year == 2011)
Western_Sambo_Deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2011_t <- t(Western_Sambo_Deep_2011)

Western_Sambo_Deep_2011_donut <- data.frame(Western_Sambo_Deep_2011_t)
colnames(Western_Sambo_Deep_2011_donut) <- c("Value")
Western_Sambo_Deep_2011_donut <- Western_Sambo_Deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2011_donut,"Western_Sambo_Deep_2011.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2011_donut_plot <- read.table("Western_Sambo_Deep_2011.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2011_donut_plot_rounded <- Western_Sambo_Deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2011_donut_plot_test <- cbind(Western_Sambo_Deep_2011_donut_plot_rounded,Legend)


Western_Sambo_Deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2011.png", width = 6, height = 6)





Western_Sambo_Deep_2012 <- filter(Western_Sambo_Deep_plot, Year == 2012)
Western_Sambo_Deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2012_t <- t(Western_Sambo_Deep_2012)

Western_Sambo_Deep_2012_donut <- data.frame(Western_Sambo_Deep_2012_t)
colnames(Western_Sambo_Deep_2012_donut) <- c("Value")
Western_Sambo_Deep_2012_donut <- Western_Sambo_Deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2012_donut,"Western_Sambo_Deep_2012.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2012_donut_plot <- read.table("Western_Sambo_Deep_2012.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2012_donut_plot_rounded <- Western_Sambo_Deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2012_donut_plot_test <- cbind(Western_Sambo_Deep_2012_donut_plot_rounded,Legend)


Western_Sambo_Deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2012.png", width = 6, height = 6)






Western_Sambo_Deep_2014 <- filter(Western_Sambo_Deep_plot, Year == 2014)
Western_Sambo_Deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2014_t <- t(Western_Sambo_Deep_2014)

Western_Sambo_Deep_2014_donut <- data.frame(Western_Sambo_Deep_2014_t)
colnames(Western_Sambo_Deep_2014_donut) <- c("Value")
Western_Sambo_Deep_2014_donut <- Western_Sambo_Deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Deep_2014_donut,"Western_Sambo_Deep_2014.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Deep_2014_donut_plot <- read.table("Western_Sambo_Deep_2014.csv", header=TRUE, sep=",")


Western_Sambo_Deep_2014_donut_plot_rounded <- Western_Sambo_Deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Deep_2014_donut_plot_test <- cbind(Western_Sambo_Deep_2014_donut_plot_rounded,Legend)


Western_Sambo_Deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Deep_2014.png", width = 6, height = 6)





Western_Sambo_Shallow_2016 <- filter(Western_Sambo_Shallow_plot, Year == 2016)
Western_Sambo_Shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2016_t <- t(Western_Sambo_Shallow_2016)

Western_Sambo_Shallow_2016_donut <- data.frame(Western_Sambo_Shallow_2016_t)
colnames(Western_Sambo_Shallow_2016_donut) <- c("Value")
Western_Sambo_Shallow_2016_donut <- Western_Sambo_Shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2016_donut,"Western_Sambo_Shallow_2016.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2016_donut_plot <- read.table("Western_Sambo_Shallow_2016.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2016_donut_plot_rounded <- Western_Sambo_Shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2016_donut_plot_test <- cbind(Western_Sambo_Shallow_2016_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2016.png", width = 6, height = 6)




Western_Sambo_Shallow <- filter(RVC_CREMP, sitename == "Western Sambo Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Western_Sambo_Shallow_fish <- Western_Sambo_Shallow$sum/max(Western_Sambo_Shallow$sum)
Western_Sambo_Shallow_biomass <- data.frame(Western_Sambo_Shallow_fish)

Western_Sambo_Shallow_biomass <- 100*Western_Sambo_Shallow_biomass


Western_Sambo_Shallow_Stony <- Western_Sambo_Shallow$Stony_coral/max(Western_Sambo_Shallow$Stony_coral)
Western_Sambo_Shallow_coral <- data.frame(Western_Sambo_Shallow_Stony)

Western_Sambo_Shallow_stony_coral <- 100*Western_Sambo_Shallow_coral

Western_Sambo_Shallow_macro <- Western_Sambo_Shallow$Macroalgae/max(Western_Sambo_Shallow$Macroalgae)
Western_Sambo_Shallow_algae <- data.frame(Western_Sambo_Shallow_macro)


Western_Sambo_Shallow_macroalgae <- (100*Western_Sambo_Shallow_algae)


Western_Sambo_Shallow_plot <- cbind(Western_Sambo_Shallow_macroalgae,Western_Sambo_Shallow_biomass,Western_Sambo_Shallow_stony_coral)

Western_Sambo_Shallow_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Western_Sambo_Shallow_1999 <- filter(Western_Sambo_Shallow_plot, Year == 1999)
Western_Sambo_Shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_1999_t <- t(Western_Sambo_Shallow_1999)

Western_Sambo_Shallow_1999_donut <- data.frame(Western_Sambo_Shallow_1999_t)
colnames(Western_Sambo_Shallow_1999_donut) <- c("Value")
Western_Sambo_Shallow_1999_donut <- Western_Sambo_Shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_1999_donut,"Western_Sambo_Shallow_1999.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_1999_donut_plot <- read.table("Western_Sambo_Shallow_1999.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_1999_donut_plot_rounded <- Western_Sambo_Shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_1999_donut_plot_test <- cbind(Western_Sambo_Shallow_1999_donut_plot_rounded,Legend)


Western_Sambo_Shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_1999.png", width = 6, height = 6)



### Western Sambo Shallow


Western_Sambo_Shallow_2000 <- filter(Western_Sambo_Shallow_plot, Year == 2000)
Western_Sambo_Shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2000_t <- t(Western_Sambo_Shallow_2000)

Western_Sambo_Shallow_2000_donut <- data.frame(Western_Sambo_Shallow_2000_t)
colnames(Western_Sambo_Shallow_2000_donut) <- c("Value")
Western_Sambo_Shallow_2000_donut <- Western_Sambo_Shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2000_donut,"Western_Sambo_Shallow_2000.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2000_donut_plot <- read.table("Western_Sambo_Shallow_2000.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2000_donut_plot_rounded <- Western_Sambo_Shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2000_donut_plot_test <- cbind(Western_Sambo_Shallow_2000_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2000.png", width = 6, height = 6)




Western_Sambo_Shallow_2001 <- filter(Western_Sambo_Shallow_plot, Year == 2001)
Western_Sambo_Shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2001_t <- t(Western_Sambo_Shallow_2001)

Western_Sambo_Shallow_2001_donut <- data.frame(Western_Sambo_Shallow_2001_t)
colnames(Western_Sambo_Shallow_2001_donut) <- c("Value")
Western_Sambo_Shallow_2001_donut <- Western_Sambo_Shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2001_donut,"Western_Sambo_Shallow_2001.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2001_donut_plot <- read.table("Western_Sambo_Shallow_2001.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2001_donut_plot_rounded <- Western_Sambo_Shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2001_donut_plot_test <- cbind(Western_Sambo_Shallow_2001_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2001.png", width = 6, height = 6)





Western_Sambo_Shallow_2002 <- filter(Western_Sambo_Shallow_plot, Year == 2002)
Western_Sambo_Shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2002_t <- t(Western_Sambo_Shallow_2002)

Western_Sambo_Shallow_2002_donut <- data.frame(Western_Sambo_Shallow_2002_t)
colnames(Western_Sambo_Shallow_2002_donut) <- c("Value")
Western_Sambo_Shallow_2002_donut <- Western_Sambo_Shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2002_donut,"Western_Sambo_Shallow_2002.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2002_donut_plot <- read.table("Western_Sambo_Shallow_2002.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2002_donut_plot_rounded <- Western_Sambo_Shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2002_donut_plot_test <- cbind(Western_Sambo_Shallow_2002_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2002.png", width = 6, height = 6)



Western_Sambo_Shallow_2003 <- filter(Western_Sambo_Shallow_plot, Year == 2003)
Western_Sambo_Shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2003_t <- t(Western_Sambo_Shallow_2003)

Western_Sambo_Shallow_2003_donut <- data.frame(Western_Sambo_Shallow_2003_t)
colnames(Western_Sambo_Shallow_2003_donut) <- c("Value")
Western_Sambo_Shallow_2003_donut <- Western_Sambo_Shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2003_donut,"Western_Sambo_Shallow_2003.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2003_donut_plot <- read.table("Western_Sambo_Shallow_2003.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2003_donut_plot_rounded <- Western_Sambo_Shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2003_donut_plot_test <- cbind(Western_Sambo_Shallow_2003_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2003.png", width = 6, height = 6)




Western_Sambo_Shallow_2004 <- filter(Western_Sambo_Shallow_plot, Year == 2004)
Western_Sambo_Shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2004_t <- t(Western_Sambo_Shallow_2004)

Western_Sambo_Shallow_2004_donut <- data.frame(Western_Sambo_Shallow_2004_t)
colnames(Western_Sambo_Shallow_2004_donut) <- c("Value")
Western_Sambo_Shallow_2004_donut <- Western_Sambo_Shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2004_donut,"Western_Sambo_Shallow_2004.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2004_donut_plot <- read.table("Western_Sambo_Shallow_2004.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2004_donut_plot_rounded <- Western_Sambo_Shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2004_donut_plot_test <- cbind(Western_Sambo_Shallow_2004_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2004.png", width = 6, height = 6)




Western_Sambo_Shallow_2005 <- filter(Western_Sambo_Shallow_plot, Year == 2005)
Western_Sambo_Shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2005_t <- t(Western_Sambo_Shallow_2005)

Western_Sambo_Shallow_2005_donut <- data.frame(Western_Sambo_Shallow_2005_t)
colnames(Western_Sambo_Shallow_2005_donut) <- c("Value")
Western_Sambo_Shallow_2005_donut <- Western_Sambo_Shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2005_donut,"Western_Sambo_Shallow_2005.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2005_donut_plot <- read.table("Western_Sambo_Shallow_2005.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2005_donut_plot_rounded <- Western_Sambo_Shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2005_donut_plot_test <- cbind(Western_Sambo_Shallow_2005_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2005.png", width = 6, height = 6)





Western_Sambo_Shallow_2006 <- filter(Western_Sambo_Shallow_plot, Year == 2006)
Western_Sambo_Shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2006_t <- t(Western_Sambo_Shallow_2006)

Western_Sambo_Shallow_2006_donut <- data.frame(Western_Sambo_Shallow_2006_t)
colnames(Western_Sambo_Shallow_2006_donut) <- c("Value")
Western_Sambo_Shallow_2006_donut <- Western_Sambo_Shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2006_donut,"Western_Sambo_Shallow_2006.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2006_donut_plot <- read.table("Western_Sambo_Shallow_2006.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2006_donut_plot_rounded <- Western_Sambo_Shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2006_donut_plot_test <- cbind(Western_Sambo_Shallow_2006_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2006.png", width = 6, height = 6)




Western_Sambo_Shallow_2007 <- filter(Western_Sambo_Shallow_plot, Year == 2007)
Western_Sambo_Shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2007_t <- t(Western_Sambo_Shallow_2007)

Western_Sambo_Shallow_2007_donut <- data.frame(Western_Sambo_Shallow_2007_t)
colnames(Western_Sambo_Shallow_2007_donut) <- c("Value")
Western_Sambo_Shallow_2007_donut <- Western_Sambo_Shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2007_donut,"Western_Sambo_Shallow_2007.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2007_donut_plot <- read.table("Western_Sambo_Shallow_2007.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2007_donut_plot_rounded <- Western_Sambo_Shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2007_donut_plot_test <- cbind(Western_Sambo_Shallow_2007_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2007.png", width = 6, height = 6)




Western_Sambo_Shallow_2008 <- filter(Western_Sambo_Shallow_plot, Year == 2008)
Western_Sambo_Shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2008_t <- t(Western_Sambo_Shallow_2008)

Western_Sambo_Shallow_2008_donut <- data.frame(Western_Sambo_Shallow_2008_t)
colnames(Western_Sambo_Shallow_2008_donut) <- c("Value")
Western_Sambo_Shallow_2008_donut <- Western_Sambo_Shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2008_donut,"Western_Sambo_Shallow_2008.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2008_donut_plot <- read.table("Western_Sambo_Shallow_2008.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2008_donut_plot_rounded <- Western_Sambo_Shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2008_donut_plot_test <- cbind(Western_Sambo_Shallow_2008_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2008.png", width = 6, height = 6)




Western_Sambo_Shallow_2009 <- filter(Western_Sambo_Shallow_plot, Year == 2009)
Western_Sambo_Shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2009_t <- t(Western_Sambo_Shallow_2009)

Western_Sambo_Shallow_2009_donut <- data.frame(Western_Sambo_Shallow_2009_t)
colnames(Western_Sambo_Shallow_2009_donut) <- c("Value")
Western_Sambo_Shallow_2009_donut <- Western_Sambo_Shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2009_donut,"Western_Sambo_Shallow_2009.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2009_donut_plot <- read.table("Western_Sambo_Shallow_2009.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2009_donut_plot_rounded <- Western_Sambo_Shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2009_donut_plot_test <- cbind(Western_Sambo_Shallow_2009_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2009.png", width = 6, height = 6)




Western_Sambo_Shallow_2010 <- filter(Western_Sambo_Shallow_plot, Year == 2010)
Western_Sambo_Shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2010_t <- t(Western_Sambo_Shallow_2010)

Western_Sambo_Shallow_2010_donut <- data.frame(Western_Sambo_Shallow_2010_t)
colnames(Western_Sambo_Shallow_2010_donut) <- c("Value")
Western_Sambo_Shallow_2010_donut <- Western_Sambo_Shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2010_donut,"Western_Sambo_Shallow_2010.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2010_donut_plot <- read.table("Western_Sambo_Shallow_2010.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2010_donut_plot_rounded <- Western_Sambo_Shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2010_donut_plot_test <- cbind(Western_Sambo_Shallow_2010_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Western_Sambo_Shallow_2010.png", width = 6, height = 6)




Western_Sambo_Shallow_2011 <- filter(Western_Sambo_Shallow_plot, Year == 2011)
Western_Sambo_Shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2011_t <- t(Western_Sambo_Shallow_2011)

Western_Sambo_Shallow_2011_donut <- data.frame(Western_Sambo_Shallow_2011_t)
colnames(Western_Sambo_Shallow_2011_donut) <- c("Value")
Western_Sambo_Shallow_2011_donut <- Western_Sambo_Shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2011_donut,"Western_Sambo_Shallow_2011.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2011_donut_plot <- read.table("Western_Sambo_Shallow_2011.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2011_donut_plot_rounded <- Western_Sambo_Shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2011_donut_plot_test <- cbind(Western_Sambo_Shallow_2011_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2011.png", width = 6, height = 6)





Western_Sambo_Shallow_2012 <- filter(Western_Sambo_Shallow_plot, Year == 2012)
Western_Sambo_Shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2012_t <- t(Western_Sambo_Shallow_2012)

Western_Sambo_Shallow_2012_donut <- data.frame(Western_Sambo_Shallow_2012_t)
colnames(Western_Sambo_Shallow_2012_donut) <- c("Value")
Western_Sambo_Shallow_2012_donut <- Western_Sambo_Shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2012_donut,"Western_Sambo_Shallow_2012.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2012_donut_plot <- read.table("Western_Sambo_Shallow_2012.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2012_donut_plot_rounded <- Western_Sambo_Shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2012_donut_plot_test <- cbind(Western_Sambo_Shallow_2012_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2012.png", width = 6, height = 6)






Western_Sambo_Shallow_2014 <- filter(Western_Sambo_Shallow_plot, Year == 2014)
Western_Sambo_Shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2014_t <- t(Western_Sambo_Shallow_2014)

Western_Sambo_Shallow_2014_donut <- data.frame(Western_Sambo_Shallow_2014_t)
colnames(Western_Sambo_Shallow_2014_donut) <- c("Value")
Western_Sambo_Shallow_2014_donut <- Western_Sambo_Shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2014_donut,"Western_Sambo_Shallow_2014.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2014_donut_plot <- read.table("Western_Sambo_Shallow_2014.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2014_donut_plot_rounded <- Western_Sambo_Shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2014_donut_plot_test <- cbind(Western_Sambo_Shallow_2014_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2014.png", width = 6, height = 6)





Western_Sambo_Shallow_2016 <- filter(Western_Sambo_Shallow_plot, Year == 2016)
Western_Sambo_Shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Western_Sambo_Shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2016_t <- t(Western_Sambo_Shallow_2016)

Western_Sambo_Shallow_2016_donut <- data.frame(Western_Sambo_Shallow_2016_t)
colnames(Western_Sambo_Shallow_2016_donut) <- c("Value")
Western_Sambo_Shallow_2016_donut <- Western_Sambo_Shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Western_Sambo_Shallow_2016_donut,"Western_Sambo_Shallow_2016.csv")


### import as csv (change category and value to the two column names)

Western_Sambo_Shallow_2016_donut_plot <- read.table("Western_Sambo_Shallow_2016.csv", header=TRUE, sep=",")


Western_Sambo_Shallow_2016_donut_plot_rounded <- Western_Sambo_Shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Western_Sambo_Shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Western_Sambo_Shallow_2016_donut_plot_test <- cbind(Western_Sambo_Shallow_2016_donut_plot_rounded,Legend)


Western_Sambo_Shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Western Sambo Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Western_Sambo_Shallow_2016.png", width = 6, height = 6)


setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/LK/plots")


library(gridExtra)
library(png)
library(grid)

pdf('LK.pdf')
lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  grid.newpage()
  grid.raster(img, interpolate = FALSE)
  
})
dev.off()

plots <- lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  rasterGrob(img, interpolate = FALSE)
})

ggsave("LK_combined.pdf", marrangeGrob(grobs=plots, nrow=2, ncol=4))












setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/UK")







Carysfort_Deep <- filter(RVC_CREMP, sitename == "Carysfort Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Carysfort_Deep_fish <- Carysfort_Deep$sum/max(Carysfort_Deep$sum)
Carysfort_Deep_biomass <- data.frame(Carysfort_Deep_fish)

Carysfort_Deep_biomass <- 100*Carysfort_Deep_biomass


Carysfort_Deep_Stony <- Carysfort_Deep$Stony_coral/max(Carysfort_Deep$Stony_coral)
Carysfort_Deep_coral <- data.frame(Carysfort_Deep_Stony)

Carysfort_Deep_stony_coral <- 100*Carysfort_Deep_coral

Carysfort_Deep_macro <- Carysfort_Deep$Macroalgae/max(Carysfort_Deep$Macroalgae)
Carysfort_Deep_algae <- data.frame(Carysfort_Deep_macro)


Carysfort_Deep_macroalgae <- (100*Carysfort_Deep_algae)


Carysfort_Deep_plot <- cbind(Carysfort_Deep_macroalgae,Carysfort_Deep_biomass,Carysfort_Deep_stony_coral)

Carysfort_Deep_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Carysfort_Deep_1999 <- filter(Carysfort_Deep_plot, Year == 1999)
Carysfort_Deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_1999_t <- t(Carysfort_Deep_1999)

Carysfort_Deep_1999_donut <- data.frame(Carysfort_Deep_1999_t)
colnames(Carysfort_Deep_1999_donut) <- c("Value")
Carysfort_Deep_1999_donut <- Carysfort_Deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_1999_donut,"Carysfort_Deep_1999.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_1999_donut_plot <- read.table("Carysfort_Deep_1999.csv", header=TRUE, sep=",")


Carysfort_Deep_1999_donut_plot_rounded <- Carysfort_Deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_1999_donut_plot_test <- cbind(Carysfort_Deep_1999_donut_plot_rounded,Legend)


Carysfort_Deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Carysfort_Deep_1999.png", width = 6, height = 6)



### Carysfort Deep


Carysfort_Deep_2000 <- filter(Carysfort_Deep_plot, Year == 2000)
Carysfort_Deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2000_t <- t(Carysfort_Deep_2000)

Carysfort_Deep_2000_donut <- data.frame(Carysfort_Deep_2000_t)
colnames(Carysfort_Deep_2000_donut) <- c("Value")
Carysfort_Deep_2000_donut <- Carysfort_Deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2000_donut,"Carysfort_Deep_2000.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2000_donut_plot <- read.table("Carysfort_Deep_2000.csv", header=TRUE, sep=",")


Carysfort_Deep_2000_donut_plot_rounded <- Carysfort_Deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2000_donut_plot_test <- cbind(Carysfort_Deep_2000_donut_plot_rounded,Legend)


Carysfort_Deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2000.png", width = 6, height = 6)




Carysfort_Deep_2001 <- filter(Carysfort_Deep_plot, Year == 2001)
Carysfort_Deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2001_t <- t(Carysfort_Deep_2001)

Carysfort_Deep_2001_donut <- data.frame(Carysfort_Deep_2001_t)
colnames(Carysfort_Deep_2001_donut) <- c("Value")
Carysfort_Deep_2001_donut <- Carysfort_Deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2001_donut,"Carysfort_Deep_2001.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2001_donut_plot <- read.table("Carysfort_Deep_2001.csv", header=TRUE, sep=",")


Carysfort_Deep_2001_donut_plot_rounded <- Carysfort_Deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2001_donut_plot_test <- cbind(Carysfort_Deep_2001_donut_plot_rounded,Legend)


Carysfort_Deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2001.png", width = 6, height = 6)





Carysfort_Deep_2002 <- filter(Carysfort_Deep_plot, Year == 2002)
Carysfort_Deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2002_t <- t(Carysfort_Deep_2002)

Carysfort_Deep_2002_donut <- data.frame(Carysfort_Deep_2002_t)
colnames(Carysfort_Deep_2002_donut) <- c("Value")
Carysfort_Deep_2002_donut <- Carysfort_Deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2002_donut,"Carysfort_Deep_2002.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2002_donut_plot <- read.table("Carysfort_Deep_2002.csv", header=TRUE, sep=",")


Carysfort_Deep_2002_donut_plot_rounded <- Carysfort_Deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2002_donut_plot_test <- cbind(Carysfort_Deep_2002_donut_plot_rounded,Legend)


Carysfort_Deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2002.png", width = 6, height = 6)



Carysfort_Deep_2003 <- filter(Carysfort_Deep_plot, Year == 2003)
Carysfort_Deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2003_t <- t(Carysfort_Deep_2003)

Carysfort_Deep_2003_donut <- data.frame(Carysfort_Deep_2003_t)
colnames(Carysfort_Deep_2003_donut) <- c("Value")
Carysfort_Deep_2003_donut <- Carysfort_Deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2003_donut,"Carysfort_Deep_2003.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2003_donut_plot <- read.table("Carysfort_Deep_2003.csv", header=TRUE, sep=",")


Carysfort_Deep_2003_donut_plot_rounded <- Carysfort_Deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2003_donut_plot_test <- cbind(Carysfort_Deep_2003_donut_plot_rounded,Legend)


Carysfort_Deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2003.png", width = 6, height = 6)




Carysfort_Deep_2004 <- filter(Carysfort_Deep_plot, Year == 2004)
Carysfort_Deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2004_t <- t(Carysfort_Deep_2004)

Carysfort_Deep_2004_donut <- data.frame(Carysfort_Deep_2004_t)
colnames(Carysfort_Deep_2004_donut) <- c("Value")
Carysfort_Deep_2004_donut <- Carysfort_Deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2004_donut,"Carysfort_Deep_2004.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2004_donut_plot <- read.table("Carysfort_Deep_2004.csv", header=TRUE, sep=",")


Carysfort_Deep_2004_donut_plot_rounded <- Carysfort_Deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2004_donut_plot_test <- cbind(Carysfort_Deep_2004_donut_plot_rounded,Legend)


Carysfort_Deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2004.png", width = 6, height = 6)




Carysfort_Deep_2005 <- filter(Carysfort_Deep_plot, Year == 2005)
Carysfort_Deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2005_t <- t(Carysfort_Deep_2005)

Carysfort_Deep_2005_donut <- data.frame(Carysfort_Deep_2005_t)
colnames(Carysfort_Deep_2005_donut) <- c("Value")
Carysfort_Deep_2005_donut <- Carysfort_Deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2005_donut,"Carysfort_Deep_2005.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2005_donut_plot <- read.table("Carysfort_Deep_2005.csv", header=TRUE, sep=",")


Carysfort_Deep_2005_donut_plot_rounded <- Carysfort_Deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2005_donut_plot_test <- cbind(Carysfort_Deep_2005_donut_plot_rounded,Legend)


Carysfort_Deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2005.png", width = 6, height = 6)





Carysfort_Deep_2006 <- filter(Carysfort_Deep_plot, Year == 2006)
Carysfort_Deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2006_t <- t(Carysfort_Deep_2006)

Carysfort_Deep_2006_donut <- data.frame(Carysfort_Deep_2006_t)
colnames(Carysfort_Deep_2006_donut) <- c("Value")
Carysfort_Deep_2006_donut <- Carysfort_Deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2006_donut,"Carysfort_Deep_2006.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2006_donut_plot <- read.table("Carysfort_Deep_2006.csv", header=TRUE, sep=",")


Carysfort_Deep_2006_donut_plot_rounded <- Carysfort_Deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2006_donut_plot_test <- cbind(Carysfort_Deep_2006_donut_plot_rounded,Legend)


Carysfort_Deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2006.png", width = 6, height = 6)




Carysfort_Deep_2007 <- filter(Carysfort_Deep_plot, Year == 2007)
Carysfort_Deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2007_t <- t(Carysfort_Deep_2007)

Carysfort_Deep_2007_donut <- data.frame(Carysfort_Deep_2007_t)
colnames(Carysfort_Deep_2007_donut) <- c("Value")
Carysfort_Deep_2007_donut <- Carysfort_Deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2007_donut,"Carysfort_Deep_2007.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2007_donut_plot <- read.table("Carysfort_Deep_2007.csv", header=TRUE, sep=",")


Carysfort_Deep_2007_donut_plot_rounded <- Carysfort_Deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2007_donut_plot_test <- cbind(Carysfort_Deep_2007_donut_plot_rounded,Legend)


Carysfort_Deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2007.png", width = 6, height = 6)




Carysfort_Deep_2008 <- filter(Carysfort_Deep_plot, Year == 2008)
Carysfort_Deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2008_t <- t(Carysfort_Deep_2008)

Carysfort_Deep_2008_donut <- data.frame(Carysfort_Deep_2008_t)
colnames(Carysfort_Deep_2008_donut) <- c("Value")
Carysfort_Deep_2008_donut <- Carysfort_Deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2008_donut,"Carysfort_Deep_2008.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2008_donut_plot <- read.table("Carysfort_Deep_2008.csv", header=TRUE, sep=",")


Carysfort_Deep_2008_donut_plot_rounded <- Carysfort_Deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2008_donut_plot_test <- cbind(Carysfort_Deep_2008_donut_plot_rounded,Legend)


Carysfort_Deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2008.png", width = 6, height = 6)




Carysfort_Deep_2009 <- filter(Carysfort_Deep_plot, Year == 2009)
Carysfort_Deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2009_t <- t(Carysfort_Deep_2009)

Carysfort_Deep_2009_donut <- data.frame(Carysfort_Deep_2009_t)
colnames(Carysfort_Deep_2009_donut) <- c("Value")
Carysfort_Deep_2009_donut <- Carysfort_Deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2009_donut,"Carysfort_Deep_2009.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2009_donut_plot <- read.table("Carysfort_Deep_2009.csv", header=TRUE, sep=",")


Carysfort_Deep_2009_donut_plot_rounded <- Carysfort_Deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2009_donut_plot_test <- cbind(Carysfort_Deep_2009_donut_plot_rounded,Legend)


Carysfort_Deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2009.png", width = 6, height = 6)




Carysfort_Deep_2010 <- filter(Carysfort_Deep_plot, Year == 2010)
Carysfort_Deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2010_t <- t(Carysfort_Deep_2010)

Carysfort_Deep_2010_donut <- data.frame(Carysfort_Deep_2010_t)
colnames(Carysfort_Deep_2010_donut) <- c("Value")
Carysfort_Deep_2010_donut <- Carysfort_Deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2010_donut,"Carysfort_Deep_2010.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2010_donut_plot <- read.table("Carysfort_Deep_2010.csv", header=TRUE, sep=",")


Carysfort_Deep_2010_donut_plot_rounded <- Carysfort_Deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2010_donut_plot_test <- cbind(Carysfort_Deep_2010_donut_plot_rounded,Legend)


Carysfort_Deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Carysfort_Deep_2010.png", width = 6, height = 6)




Carysfort_Deep_2011 <- filter(Carysfort_Deep_plot, Year == 2011)
Carysfort_Deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2011_t <- t(Carysfort_Deep_2011)

Carysfort_Deep_2011_donut <- data.frame(Carysfort_Deep_2011_t)
colnames(Carysfort_Deep_2011_donut) <- c("Value")
Carysfort_Deep_2011_donut <- Carysfort_Deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2011_donut,"Carysfort_Deep_2011.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2011_donut_plot <- read.table("Carysfort_Deep_2011.csv", header=TRUE, sep=",")


Carysfort_Deep_2011_donut_plot_rounded <- Carysfort_Deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2011_donut_plot_test <- cbind(Carysfort_Deep_2011_donut_plot_rounded,Legend)


Carysfort_Deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2011.png", width = 6, height = 6)





Carysfort_Deep_2012 <- filter(Carysfort_Deep_plot, Year == 2012)
Carysfort_Deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2012_t <- t(Carysfort_Deep_2012)

Carysfort_Deep_2012_donut <- data.frame(Carysfort_Deep_2012_t)
colnames(Carysfort_Deep_2012_donut) <- c("Value")
Carysfort_Deep_2012_donut <- Carysfort_Deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2012_donut,"Carysfort_Deep_2012.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2012_donut_plot <- read.table("Carysfort_Deep_2012.csv", header=TRUE, sep=",")


Carysfort_Deep_2012_donut_plot_rounded <- Carysfort_Deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2012_donut_plot_test <- cbind(Carysfort_Deep_2012_donut_plot_rounded,Legend)


Carysfort_Deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2012.png", width = 6, height = 6)






Carysfort_Deep_2014 <- filter(Carysfort_Deep_plot, Year == 2014)
Carysfort_Deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2014_t <- t(Carysfort_Deep_2014)

Carysfort_Deep_2014_donut <- data.frame(Carysfort_Deep_2014_t)
colnames(Carysfort_Deep_2014_donut) <- c("Value")
Carysfort_Deep_2014_donut <- Carysfort_Deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2014_donut,"Carysfort_Deep_2014.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2014_donut_plot <- read.table("Carysfort_Deep_2014.csv", header=TRUE, sep=",")


Carysfort_Deep_2014_donut_plot_rounded <- Carysfort_Deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2014_donut_plot_test <- cbind(Carysfort_Deep_2014_donut_plot_rounded,Legend)


Carysfort_Deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2014.png", width = 6, height = 6)





Carysfort_Deep_2016 <- filter(Carysfort_Deep_plot, Year == 2016)
Carysfort_Deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2016_t <- t(Carysfort_Deep_2016)

Carysfort_Deep_2016_donut <- data.frame(Carysfort_Deep_2016_t)
colnames(Carysfort_Deep_2016_donut) <- c("Value")
Carysfort_Deep_2016_donut <- Carysfort_Deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Deep_2016_donut,"Carysfort_Deep_2016.csv")


### import as csv (change category and value to the two column names)

Carysfort_Deep_2016_donut_plot <- read.table("Carysfort_Deep_2016.csv", header=TRUE, sep=",")


Carysfort_Deep_2016_donut_plot_rounded <- Carysfort_Deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Deep_2016_donut_plot_test <- cbind(Carysfort_Deep_2016_donut_plot_rounded,Legend)


Carysfort_Deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Deep_2016.png", width = 6, height = 6)






Carysfort_Shallow <- filter(RVC_CREMP, sitename == "Carysfort Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Carysfort_Shallow_fish <- Carysfort_Shallow$sum/max(Carysfort_Shallow$sum)
Carysfort_Shallow_biomass <- data.frame(Carysfort_Shallow_fish)

Carysfort_Shallow_biomass <- 100*Carysfort_Shallow_biomass


Carysfort_Shallow_Stony <- Carysfort_Shallow$Stony_coral/max(Carysfort_Shallow$Stony_coral)
Carysfort_Shallow_coral <- data.frame(Carysfort_Shallow_Stony)

Carysfort_Shallow_stony_coral <- 100*Carysfort_Shallow_coral

Carysfort_Shallow_macro <- Carysfort_Shallow$Macroalgae/max(Carysfort_Shallow$Macroalgae)
Carysfort_Shallow_algae <- data.frame(Carysfort_Shallow_macro)


Carysfort_Shallow_macroalgae <- (100*Carysfort_Shallow_algae)


Carysfort_Shallow_plot <- cbind(Carysfort_Shallow_macroalgae,Carysfort_Shallow_biomass,Carysfort_Shallow_stony_coral)

Carysfort_Shallow_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Carysfort_Shallow_1999 <- filter(Carysfort_Shallow_plot, Year == 1999)
Carysfort_Shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_1999_t <- t(Carysfort_Shallow_1999)

Carysfort_Shallow_1999_donut <- data.frame(Carysfort_Shallow_1999_t)
colnames(Carysfort_Shallow_1999_donut) <- c("Value")
Carysfort_Shallow_1999_donut <- Carysfort_Shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_1999_donut,"Carysfort_Shallow_1999.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_1999_donut_plot <- read.table("Carysfort_Shallow_1999.csv", header=TRUE, sep=",")


Carysfort_Shallow_1999_donut_plot_rounded <- Carysfort_Shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_1999_donut_plot_test <- cbind(Carysfort_Shallow_1999_donut_plot_rounded,Legend)


Carysfort_Shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Carysfort_Shallow_1999.png", width = 6, height = 6)



### Carysfort Shallow


Carysfort_Shallow_2000 <- filter(Carysfort_Shallow_plot, Year == 2000)
Carysfort_Shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2000_t <- t(Carysfort_Shallow_2000)

Carysfort_Shallow_2000_donut <- data.frame(Carysfort_Shallow_2000_t)
colnames(Carysfort_Shallow_2000_donut) <- c("Value")
Carysfort_Shallow_2000_donut <- Carysfort_Shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2000_donut,"Carysfort_Shallow_2000.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2000_donut_plot <- read.table("Carysfort_Shallow_2000.csv", header=TRUE, sep=",")


Carysfort_Shallow_2000_donut_plot_rounded <- Carysfort_Shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2000_donut_plot_test <- cbind(Carysfort_Shallow_2000_donut_plot_rounded,Legend)


Carysfort_Shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2000.png", width = 6, height = 6)




Carysfort_Shallow_2001 <- filter(Carysfort_Shallow_plot, Year == 2001)
Carysfort_Shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2001_t <- t(Carysfort_Shallow_2001)

Carysfort_Shallow_2001_donut <- data.frame(Carysfort_Shallow_2001_t)
colnames(Carysfort_Shallow_2001_donut) <- c("Value")
Carysfort_Shallow_2001_donut <- Carysfort_Shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2001_donut,"Carysfort_Shallow_2001.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2001_donut_plot <- read.table("Carysfort_Shallow_2001.csv", header=TRUE, sep=",")


Carysfort_Shallow_2001_donut_plot_rounded <- Carysfort_Shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2001_donut_plot_test <- cbind(Carysfort_Shallow_2001_donut_plot_rounded,Legend)


Carysfort_Shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2001.png", width = 6, height = 6)





Carysfort_Shallow_2002 <- filter(Carysfort_Shallow_plot, Year == 2002)
Carysfort_Shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2002_t <- t(Carysfort_Shallow_2002)

Carysfort_Shallow_2002_donut <- data.frame(Carysfort_Shallow_2002_t)
colnames(Carysfort_Shallow_2002_donut) <- c("Value")
Carysfort_Shallow_2002_donut <- Carysfort_Shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2002_donut,"Carysfort_Shallow_2002.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2002_donut_plot <- read.table("Carysfort_Shallow_2002.csv", header=TRUE, sep=",")


Carysfort_Shallow_2002_donut_plot_rounded <- Carysfort_Shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2002_donut_plot_test <- cbind(Carysfort_Shallow_2002_donut_plot_rounded,Legend)


Carysfort_Shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2002.png", width = 6, height = 6)



Carysfort_Shallow_2003 <- filter(Carysfort_Shallow_plot, Year == 2003)
Carysfort_Shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2003_t <- t(Carysfort_Shallow_2003)

Carysfort_Shallow_2003_donut <- data.frame(Carysfort_Shallow_2003_t)
colnames(Carysfort_Shallow_2003_donut) <- c("Value")
Carysfort_Shallow_2003_donut <- Carysfort_Shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2003_donut,"Carysfort_Shallow_2003.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2003_donut_plot <- read.table("Carysfort_Shallow_2003.csv", header=TRUE, sep=",")


Carysfort_Shallow_2003_donut_plot_rounded <- Carysfort_Shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2003_donut_plot_test <- cbind(Carysfort_Shallow_2003_donut_plot_rounded,Legend)


Carysfort_Shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2003.png", width = 6, height = 6)




Carysfort_Shallow_2004 <- filter(Carysfort_Shallow_plot, Year == 2004)
Carysfort_Shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2004_t <- t(Carysfort_Shallow_2004)

Carysfort_Shallow_2004_donut <- data.frame(Carysfort_Shallow_2004_t)
colnames(Carysfort_Shallow_2004_donut) <- c("Value")
Carysfort_Shallow_2004_donut <- Carysfort_Shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2004_donut,"Carysfort_Shallow_2004.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2004_donut_plot <- read.table("Carysfort_Shallow_2004.csv", header=TRUE, sep=",")


Carysfort_Shallow_2004_donut_plot_rounded <- Carysfort_Shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2004_donut_plot_test <- cbind(Carysfort_Shallow_2004_donut_plot_rounded,Legend)


Carysfort_Shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2004.png", width = 6, height = 6)




Carysfort_Shallow_2005 <- filter(Carysfort_Shallow_plot, Year == 2005)
Carysfort_Shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2005_t <- t(Carysfort_Shallow_2005)

Carysfort_Shallow_2005_donut <- data.frame(Carysfort_Shallow_2005_t)
colnames(Carysfort_Shallow_2005_donut) <- c("Value")
Carysfort_Shallow_2005_donut <- Carysfort_Shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2005_donut,"Carysfort_Shallow_2005.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2005_donut_plot <- read.table("Carysfort_Shallow_2005.csv", header=TRUE, sep=",")


Carysfort_Shallow_2005_donut_plot_rounded <- Carysfort_Shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2005_donut_plot_test <- cbind(Carysfort_Shallow_2005_donut_plot_rounded,Legend)


Carysfort_Shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2005.png", width = 6, height = 6)





Carysfort_Shallow_2006 <- filter(Carysfort_Shallow_plot, Year == 2006)
Carysfort_Shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2006_t <- t(Carysfort_Shallow_2006)

Carysfort_Shallow_2006_donut <- data.frame(Carysfort_Shallow_2006_t)
colnames(Carysfort_Shallow_2006_donut) <- c("Value")
Carysfort_Shallow_2006_donut <- Carysfort_Shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2006_donut,"Carysfort_Shallow_2006.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2006_donut_plot <- read.table("Carysfort_Shallow_2006.csv", header=TRUE, sep=",")


Carysfort_Shallow_2006_donut_plot_rounded <- Carysfort_Shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2006_donut_plot_test <- cbind(Carysfort_Shallow_2006_donut_plot_rounded,Legend)


Carysfort_Shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2006.png", width = 6, height = 6)




Carysfort_Shallow_2007 <- filter(Carysfort_Shallow_plot, Year == 2007)
Carysfort_Shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2007_t <- t(Carysfort_Shallow_2007)

Carysfort_Shallow_2007_donut <- data.frame(Carysfort_Shallow_2007_t)
colnames(Carysfort_Shallow_2007_donut) <- c("Value")
Carysfort_Shallow_2007_donut <- Carysfort_Shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2007_donut,"Carysfort_Shallow_2007.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2007_donut_plot <- read.table("Carysfort_Shallow_2007.csv", header=TRUE, sep=",")


Carysfort_Shallow_2007_donut_plot_rounded <- Carysfort_Shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2007_donut_plot_test <- cbind(Carysfort_Shallow_2007_donut_plot_rounded,Legend)


Carysfort_Shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2007.png", width = 6, height = 6)




Carysfort_Shallow_2008 <- filter(Carysfort_Shallow_plot, Year == 2008)
Carysfort_Shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2008_t <- t(Carysfort_Shallow_2008)

Carysfort_Shallow_2008_donut <- data.frame(Carysfort_Shallow_2008_t)
colnames(Carysfort_Shallow_2008_donut) <- c("Value")
Carysfort_Shallow_2008_donut <- Carysfort_Shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2008_donut,"Carysfort_Shallow_2008.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2008_donut_plot <- read.table("Carysfort_Shallow_2008.csv", header=TRUE, sep=",")


Carysfort_Shallow_2008_donut_plot_rounded <- Carysfort_Shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2008_donut_plot_test <- cbind(Carysfort_Shallow_2008_donut_plot_rounded,Legend)


Carysfort_Shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2008.png", width = 6, height = 6)




Carysfort_Shallow_2009 <- filter(Carysfort_Shallow_plot, Year == 2009)
Carysfort_Shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2009_t <- t(Carysfort_Shallow_2009)

Carysfort_Shallow_2009_donut <- data.frame(Carysfort_Shallow_2009_t)
colnames(Carysfort_Shallow_2009_donut) <- c("Value")
Carysfort_Shallow_2009_donut <- Carysfort_Shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2009_donut,"Carysfort_Shallow_2009.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2009_donut_plot <- read.table("Carysfort_Shallow_2009.csv", header=TRUE, sep=",")


Carysfort_Shallow_2009_donut_plot_rounded <- Carysfort_Shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2009_donut_plot_test <- cbind(Carysfort_Shallow_2009_donut_plot_rounded,Legend)


Carysfort_Shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2009.png", width = 6, height = 6)




Carysfort_Shallow_2010 <- filter(Carysfort_Shallow_plot, Year == 2010)
Carysfort_Shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2010_t <- t(Carysfort_Shallow_2010)

Carysfort_Shallow_2010_donut <- data.frame(Carysfort_Shallow_2010_t)
colnames(Carysfort_Shallow_2010_donut) <- c("Value")
Carysfort_Shallow_2010_donut <- Carysfort_Shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2010_donut,"Carysfort_Shallow_2010.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2010_donut_plot <- read.table("Carysfort_Shallow_2010.csv", header=TRUE, sep=",")


Carysfort_Shallow_2010_donut_plot_rounded <- Carysfort_Shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2010_donut_plot_test <- cbind(Carysfort_Shallow_2010_donut_plot_rounded,Legend)


Carysfort_Shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Carysfort_Shallow_2010.png", width = 6, height = 6)




Carysfort_Shallow_2011 <- filter(Carysfort_Shallow_plot, Year == 2011)
Carysfort_Shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2011_t <- t(Carysfort_Shallow_2011)

Carysfort_Shallow_2011_donut <- data.frame(Carysfort_Shallow_2011_t)
colnames(Carysfort_Shallow_2011_donut) <- c("Value")
Carysfort_Shallow_2011_donut <- Carysfort_Shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2011_donut,"Carysfort_Shallow_2011.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2011_donut_plot <- read.table("Carysfort_Shallow_2011.csv", header=TRUE, sep=",")


Carysfort_Shallow_2011_donut_plot_rounded <- Carysfort_Shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2011_donut_plot_test <- cbind(Carysfort_Shallow_2011_donut_plot_rounded,Legend)


Carysfort_Shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2011.png", width = 6, height = 6)





Carysfort_Shallow_2012 <- filter(Carysfort_Shallow_plot, Year == 2012)
Carysfort_Shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2012_t <- t(Carysfort_Shallow_2012)

Carysfort_Shallow_2012_donut <- data.frame(Carysfort_Shallow_2012_t)
colnames(Carysfort_Shallow_2012_donut) <- c("Value")
Carysfort_Shallow_2012_donut <- Carysfort_Shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2012_donut,"Carysfort_Shallow_2012.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2012_donut_plot <- read.table("Carysfort_Shallow_2012.csv", header=TRUE, sep=",")


Carysfort_Shallow_2012_donut_plot_rounded <- Carysfort_Shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2012_donut_plot_test <- cbind(Carysfort_Shallow_2012_donut_plot_rounded,Legend)


Carysfort_Shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2012.png", width = 6, height = 6)






Carysfort_Shallow_2014 <- filter(Carysfort_Shallow_plot, Year == 2014)
Carysfort_Shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2014_t <- t(Carysfort_Shallow_2014)

Carysfort_Shallow_2014_donut <- data.frame(Carysfort_Shallow_2014_t)
colnames(Carysfort_Shallow_2014_donut) <- c("Value")
Carysfort_Shallow_2014_donut <- Carysfort_Shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2014_donut,"Carysfort_Shallow_2014.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2014_donut_plot <- read.table("Carysfort_Shallow_2014.csv", header=TRUE, sep=",")


Carysfort_Shallow_2014_donut_plot_rounded <- Carysfort_Shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2014_donut_plot_test <- cbind(Carysfort_Shallow_2014_donut_plot_rounded,Legend)


Carysfort_Shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2014.png", width = 6, height = 6)





Carysfort_Shallow_2016 <- filter(Carysfort_Shallow_plot, Year == 2016)
Carysfort_Shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Carysfort_Shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2016_t <- t(Carysfort_Shallow_2016)

Carysfort_Shallow_2016_donut <- data.frame(Carysfort_Shallow_2016_t)
colnames(Carysfort_Shallow_2016_donut) <- c("Value")
Carysfort_Shallow_2016_donut <- Carysfort_Shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Carysfort_Shallow_2016_donut,"Carysfort_Shallow_2016.csv")


### import as csv (change category and value to the two column names)

Carysfort_Shallow_2016_donut_plot <- read.table("Carysfort_Shallow_2016.csv", header=TRUE, sep=",")


Carysfort_Shallow_2016_donut_plot_rounded <- Carysfort_Shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Carysfort_Shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Carysfort_Shallow_2016_donut_plot_test <- cbind(Carysfort_Shallow_2016_donut_plot_rounded,Legend)


Carysfort_Shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Carysfort Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Carysfort_Shallow_2016.png", width = 6, height = 6)






Conch_Deep <- filter(RVC_CREMP, sitename == "Conch Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Conch_Deep_fish <- Conch_Deep$sum/max(Conch_Deep$sum)
Conch_Deep_biomass <- data.frame(Conch_Deep_fish)

Conch_Deep_biomass <- 100*Conch_Deep_biomass


Conch_Deep_Stony <- Conch_Deep$Stony_coral/max(Conch_Deep$Stony_coral)
Conch_Deep_coral <- data.frame(Conch_Deep_Stony)

Conch_Deep_stony_coral <- 100*Conch_Deep_coral

Conch_Deep_macro <- Conch_Deep$Macroalgae/max(Conch_Deep$Macroalgae)
Conch_Deep_algae <- data.frame(Conch_Deep_macro)


Conch_Deep_macroalgae <- (100*Conch_Deep_algae)


Conch_Deep_plot <- cbind(Conch_Deep_macroalgae,Conch_Deep_biomass,Conch_Deep_stony_coral)

Conch_Deep_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Conch_Deep_1999 <- filter(Conch_Deep_plot, Year == 1999)
Conch_Deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_1999_t <- t(Conch_Deep_1999)

Conch_Deep_1999_donut <- data.frame(Conch_Deep_1999_t)
colnames(Conch_Deep_1999_donut) <- c("Value")
Conch_Deep_1999_donut <- Conch_Deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_1999_donut,"Conch_Deep_1999.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_1999_donut_plot <- read.table("Conch_Deep_1999.csv", header=TRUE, sep=",")


Conch_Deep_1999_donut_plot_rounded <- Conch_Deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_1999_donut_plot_test <- cbind(Conch_Deep_1999_donut_plot_rounded,Legend)


Conch_Deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_1999.png", width = 6, height = 6)



### Conch Deep


Conch_Deep_2000 <- filter(Conch_Deep_plot, Year == 2000)
Conch_Deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2000_t <- t(Conch_Deep_2000)

Conch_Deep_2000_donut <- data.frame(Conch_Deep_2000_t)
colnames(Conch_Deep_2000_donut) <- c("Value")
Conch_Deep_2000_donut <- Conch_Deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2000_donut,"Conch_Deep_2000.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2000_donut_plot <- read.table("Conch_Deep_2000.csv", header=TRUE, sep=",")


Conch_Deep_2000_donut_plot_rounded <- Conch_Deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2000_donut_plot_test <- cbind(Conch_Deep_2000_donut_plot_rounded,Legend)


Conch_Deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2000.png", width = 6, height = 6)




Conch_Deep_2001 <- filter(Conch_Deep_plot, Year == 2001)
Conch_Deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2001_t <- t(Conch_Deep_2001)

Conch_Deep_2001_donut <- data.frame(Conch_Deep_2001_t)
colnames(Conch_Deep_2001_donut) <- c("Value")
Conch_Deep_2001_donut <- Conch_Deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2001_donut,"Conch_Deep_2001.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2001_donut_plot <- read.table("Conch_Deep_2001.csv", header=TRUE, sep=",")


Conch_Deep_2001_donut_plot_rounded <- Conch_Deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2001_donut_plot_test <- cbind(Conch_Deep_2001_donut_plot_rounded,Legend)


Conch_Deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2001.png", width = 6, height = 6)





Conch_Deep_2002 <- filter(Conch_Deep_plot, Year == 2002)
Conch_Deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2002_t <- t(Conch_Deep_2002)

Conch_Deep_2002_donut <- data.frame(Conch_Deep_2002_t)
colnames(Conch_Deep_2002_donut) <- c("Value")
Conch_Deep_2002_donut <- Conch_Deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2002_donut,"Conch_Deep_2002.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2002_donut_plot <- read.table("Conch_Deep_2002.csv", header=TRUE, sep=",")


Conch_Deep_2002_donut_plot_rounded <- Conch_Deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2002_donut_plot_test <- cbind(Conch_Deep_2002_donut_plot_rounded,Legend)


Conch_Deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2002.png", width = 6, height = 6)



Conch_Deep_2003 <- filter(Conch_Deep_plot, Year == 2003)
Conch_Deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2003_t <- t(Conch_Deep_2003)

Conch_Deep_2003_donut <- data.frame(Conch_Deep_2003_t)
colnames(Conch_Deep_2003_donut) <- c("Value")
Conch_Deep_2003_donut <- Conch_Deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2003_donut,"Conch_Deep_2003.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2003_donut_plot <- read.table("Conch_Deep_2003.csv", header=TRUE, sep=",")


Conch_Deep_2003_donut_plot_rounded <- Conch_Deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2003_donut_plot_test <- cbind(Conch_Deep_2003_donut_plot_rounded,Legend)


Conch_Deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2003.png", width = 6, height = 6)




Conch_Deep_2004 <- filter(Conch_Deep_plot, Year == 2004)
Conch_Deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2004_t <- t(Conch_Deep_2004)

Conch_Deep_2004_donut <- data.frame(Conch_Deep_2004_t)
colnames(Conch_Deep_2004_donut) <- c("Value")
Conch_Deep_2004_donut <- Conch_Deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2004_donut,"Conch_Deep_2004.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2004_donut_plot <- read.table("Conch_Deep_2004.csv", header=TRUE, sep=",")


Conch_Deep_2004_donut_plot_rounded <- Conch_Deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2004_donut_plot_test <- cbind(Conch_Deep_2004_donut_plot_rounded,Legend)


Conch_Deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2004.png", width = 6, height = 6)




Conch_Deep_2005 <- filter(Conch_Deep_plot, Year == 2005)
Conch_Deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2005_t <- t(Conch_Deep_2005)

Conch_Deep_2005_donut <- data.frame(Conch_Deep_2005_t)
colnames(Conch_Deep_2005_donut) <- c("Value")
Conch_Deep_2005_donut <- Conch_Deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2005_donut,"Conch_Deep_2005.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2005_donut_plot <- read.table("Conch_Deep_2005.csv", header=TRUE, sep=",")


Conch_Deep_2005_donut_plot_rounded <- Conch_Deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2005_donut_plot_test <- cbind(Conch_Deep_2005_donut_plot_rounded,Legend)


Conch_Deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2005.png", width = 6, height = 6)





Conch_Deep_2006 <- filter(Conch_Deep_plot, Year == 2006)
Conch_Deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2006_t <- t(Conch_Deep_2006)

Conch_Deep_2006_donut <- data.frame(Conch_Deep_2006_t)
colnames(Conch_Deep_2006_donut) <- c("Value")
Conch_Deep_2006_donut <- Conch_Deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2006_donut,"Conch_Deep_2006.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2006_donut_plot <- read.table("Conch_Deep_2006.csv", header=TRUE, sep=",")


Conch_Deep_2006_donut_plot_rounded <- Conch_Deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2006_donut_plot_test <- cbind(Conch_Deep_2006_donut_plot_rounded,Legend)


Conch_Deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2006.png", width = 6, height = 6)




Conch_Deep_2007 <- filter(Conch_Deep_plot, Year == 2007)
Conch_Deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2007_t <- t(Conch_Deep_2007)

Conch_Deep_2007_donut <- data.frame(Conch_Deep_2007_t)
colnames(Conch_Deep_2007_donut) <- c("Value")
Conch_Deep_2007_donut <- Conch_Deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2007_donut,"Conch_Deep_2007.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2007_donut_plot <- read.table("Conch_Deep_2007.csv", header=TRUE, sep=",")


Conch_Deep_2007_donut_plot_rounded <- Conch_Deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2007_donut_plot_test <- cbind(Conch_Deep_2007_donut_plot_rounded,Legend)


Conch_Deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2007.png", width = 6, height = 6)




Conch_Deep_2008 <- filter(Conch_Deep_plot, Year == 2008)
Conch_Deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2008_t <- t(Conch_Deep_2008)

Conch_Deep_2008_donut <- data.frame(Conch_Deep_2008_t)
colnames(Conch_Deep_2008_donut) <- c("Value")
Conch_Deep_2008_donut <- Conch_Deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2008_donut,"Conch_Deep_2008.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2008_donut_plot <- read.table("Conch_Deep_2008.csv", header=TRUE, sep=",")


Conch_Deep_2008_donut_plot_rounded <- Conch_Deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2008_donut_plot_test <- cbind(Conch_Deep_2008_donut_plot_rounded,Legend)


Conch_Deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2008.png", width = 6, height = 6)




Conch_Deep_2009 <- filter(Conch_Deep_plot, Year == 2009)
Conch_Deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2009_t <- t(Conch_Deep_2009)

Conch_Deep_2009_donut <- data.frame(Conch_Deep_2009_t)
colnames(Conch_Deep_2009_donut) <- c("Value")
Conch_Deep_2009_donut <- Conch_Deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2009_donut,"Conch_Deep_2009.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2009_donut_plot <- read.table("Conch_Deep_2009.csv", header=TRUE, sep=",")


Conch_Deep_2009_donut_plot_rounded <- Conch_Deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2009_donut_plot_test <- cbind(Conch_Deep_2009_donut_plot_rounded,Legend)


Conch_Deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2009.png", width = 6, height = 6)




Conch_Deep_2010 <- filter(Conch_Deep_plot, Year == 2010)
Conch_Deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2010_t <- t(Conch_Deep_2010)

Conch_Deep_2010_donut <- data.frame(Conch_Deep_2010_t)
colnames(Conch_Deep_2010_donut) <- c("Value")
Conch_Deep_2010_donut <- Conch_Deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2010_donut,"Conch_Deep_2010.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2010_donut_plot <- read.table("Conch_Deep_2010.csv", header=TRUE, sep=",")


Conch_Deep_2010_donut_plot_rounded <- Conch_Deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2010_donut_plot_test <- cbind(Conch_Deep_2010_donut_plot_rounded,Legend)


Conch_Deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Conch_Deep_2010.png", width = 6, height = 6)




Conch_Deep_2011 <- filter(Conch_Deep_plot, Year == 2011)
Conch_Deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2011_t <- t(Conch_Deep_2011)

Conch_Deep_2011_donut <- data.frame(Conch_Deep_2011_t)
colnames(Conch_Deep_2011_donut) <- c("Value")
Conch_Deep_2011_donut <- Conch_Deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2011_donut,"Conch_Deep_2011.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2011_donut_plot <- read.table("Conch_Deep_2011.csv", header=TRUE, sep=",")


Conch_Deep_2011_donut_plot_rounded <- Conch_Deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2011_donut_plot_test <- cbind(Conch_Deep_2011_donut_plot_rounded,Legend)


Conch_Deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2011.png", width = 6, height = 6)





Conch_Deep_2012 <- filter(Conch_Deep_plot, Year == 2012)
Conch_Deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2012_t <- t(Conch_Deep_2012)

Conch_Deep_2012_donut <- data.frame(Conch_Deep_2012_t)
colnames(Conch_Deep_2012_donut) <- c("Value")
Conch_Deep_2012_donut <- Conch_Deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2012_donut,"Conch_Deep_2012.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2012_donut_plot <- read.table("Conch_Deep_2012.csv", header=TRUE, sep=",")


Conch_Deep_2012_donut_plot_rounded <- Conch_Deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2012_donut_plot_test <- cbind(Conch_Deep_2012_donut_plot_rounded,Legend)


Conch_Deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2012.png", width = 6, height = 6)






Conch_Deep_2014 <- filter(Conch_Deep_plot, Year == 2014)
Conch_Deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2014_t <- t(Conch_Deep_2014)

Conch_Deep_2014_donut <- data.frame(Conch_Deep_2014_t)
colnames(Conch_Deep_2014_donut) <- c("Value")
Conch_Deep_2014_donut <- Conch_Deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2014_donut,"Conch_Deep_2014.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2014_donut_plot <- read.table("Conch_Deep_2014.csv", header=TRUE, sep=",")


Conch_Deep_2014_donut_plot_rounded <- Conch_Deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2014_donut_plot_test <- cbind(Conch_Deep_2014_donut_plot_rounded,Legend)


Conch_Deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2014.png", width = 6, height = 6)





Conch_Deep_2016 <- filter(Conch_Deep_plot, Year == 2016)
Conch_Deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2016_t <- t(Conch_Deep_2016)

Conch_Deep_2016_donut <- data.frame(Conch_Deep_2016_t)
colnames(Conch_Deep_2016_donut) <- c("Value")
Conch_Deep_2016_donut <- Conch_Deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Deep_2016_donut,"Conch_Deep_2016.csv")


### import as csv (change category and value to the two column names)

Conch_Deep_2016_donut_plot <- read.table("Conch_Deep_2016.csv", header=TRUE, sep=",")


Conch_Deep_2016_donut_plot_rounded <- Conch_Deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Deep_2016_donut_plot_test <- cbind(Conch_Deep_2016_donut_plot_rounded,Legend)


Conch_Deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Deep_2016.png", width = 6, height = 6)





Conch_Shallow <- filter(RVC_CREMP, sitename == "Conch Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Conch_Shallow_fish <- Conch_Shallow$sum/max(Conch_Shallow$sum)
Conch_Shallow_biomass <- data.frame(Conch_Shallow_fish)

Conch_Shallow_biomass <- 100*Conch_Shallow_biomass


Conch_Shallow_Stony <- Conch_Shallow$Stony_coral/max(Conch_Shallow$Stony_coral)
Conch_Shallow_coral <- data.frame(Conch_Shallow_Stony)

Conch_Shallow_stony_coral <- 100*Conch_Shallow_coral

Conch_Shallow_macro <- Conch_Shallow$Macroalgae/max(Conch_Shallow$Macroalgae)
Conch_Shallow_algae <- data.frame(Conch_Shallow_macro)


Conch_Shallow_macroalgae <- (100*Conch_Shallow_algae)


Conch_Shallow_plot <- cbind(Conch_Shallow_macroalgae,Conch_Shallow_biomass,Conch_Shallow_stony_coral)

Conch_Shallow_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Conch_Shallow_1999 <- filter(Conch_Shallow_plot, Year == 1999)
Conch_Shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_1999_t <- t(Conch_Shallow_1999)

Conch_Shallow_1999_donut <- data.frame(Conch_Shallow_1999_t)
colnames(Conch_Shallow_1999_donut) <- c("Value")
Conch_Shallow_1999_donut <- Conch_Shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_1999_donut,"Conch_Shallow_1999.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_1999_donut_plot <- read.table("Conch_Shallow_1999.csv", header=TRUE, sep=",")


Conch_Shallow_1999_donut_plot_rounded <- Conch_Shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_1999_donut_plot_test <- cbind(Conch_Shallow_1999_donut_plot_rounded,Legend)


Conch_Shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_1999.png", width = 6, height = 6)



### Conch Shallow


Conch_Shallow_2000 <- filter(Conch_Shallow_plot, Year == 2000)
Conch_Shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2000_t <- t(Conch_Shallow_2000)

Conch_Shallow_2000_donut <- data.frame(Conch_Shallow_2000_t)
colnames(Conch_Shallow_2000_donut) <- c("Value")
Conch_Shallow_2000_donut <- Conch_Shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2000_donut,"Conch_Shallow_2000.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2000_donut_plot <- read.table("Conch_Shallow_2000.csv", header=TRUE, sep=",")


Conch_Shallow_2000_donut_plot_rounded <- Conch_Shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2000_donut_plot_test <- cbind(Conch_Shallow_2000_donut_plot_rounded,Legend)


Conch_Shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2000.png", width = 6, height = 6)




Conch_Shallow_2001 <- filter(Conch_Shallow_plot, Year == 2001)
Conch_Shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2001_t <- t(Conch_Shallow_2001)

Conch_Shallow_2001_donut <- data.frame(Conch_Shallow_2001_t)
colnames(Conch_Shallow_2001_donut) <- c("Value")
Conch_Shallow_2001_donut <- Conch_Shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2001_donut,"Conch_Shallow_2001.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2001_donut_plot <- read.table("Conch_Shallow_2001.csv", header=TRUE, sep=",")


Conch_Shallow_2001_donut_plot_rounded <- Conch_Shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2001_donut_plot_test <- cbind(Conch_Shallow_2001_donut_plot_rounded,Legend)


Conch_Shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2001.png", width = 6, height = 6)





Conch_Shallow_2002 <- filter(Conch_Shallow_plot, Year == 2002)
Conch_Shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2002_t <- t(Conch_Shallow_2002)

Conch_Shallow_2002_donut <- data.frame(Conch_Shallow_2002_t)
colnames(Conch_Shallow_2002_donut) <- c("Value")
Conch_Shallow_2002_donut <- Conch_Shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2002_donut,"Conch_Shallow_2002.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2002_donut_plot <- read.table("Conch_Shallow_2002.csv", header=TRUE, sep=",")


Conch_Shallow_2002_donut_plot_rounded <- Conch_Shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2002_donut_plot_test <- cbind(Conch_Shallow_2002_donut_plot_rounded,Legend)


Conch_Shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2002.png", width = 6, height = 6)



Conch_Shallow_2003 <- filter(Conch_Shallow_plot, Year == 2003)
Conch_Shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2003_t <- t(Conch_Shallow_2003)

Conch_Shallow_2003_donut <- data.frame(Conch_Shallow_2003_t)
colnames(Conch_Shallow_2003_donut) <- c("Value")
Conch_Shallow_2003_donut <- Conch_Shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2003_donut,"Conch_Shallow_2003.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2003_donut_plot <- read.table("Conch_Shallow_2003.csv", header=TRUE, sep=",")


Conch_Shallow_2003_donut_plot_rounded <- Conch_Shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2003_donut_plot_test <- cbind(Conch_Shallow_2003_donut_plot_rounded,Legend)


Conch_Shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2003.png", width = 6, height = 6)




Conch_Shallow_2004 <- filter(Conch_Shallow_plot, Year == 2004)
Conch_Shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2004_t <- t(Conch_Shallow_2004)

Conch_Shallow_2004_donut <- data.frame(Conch_Shallow_2004_t)
colnames(Conch_Shallow_2004_donut) <- c("Value")
Conch_Shallow_2004_donut <- Conch_Shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2004_donut,"Conch_Shallow_2004.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2004_donut_plot <- read.table("Conch_Shallow_2004.csv", header=TRUE, sep=",")


Conch_Shallow_2004_donut_plot_rounded <- Conch_Shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2004_donut_plot_test <- cbind(Conch_Shallow_2004_donut_plot_rounded,Legend)


Conch_Shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Conch_Shallow_2004.png", width = 6, height = 6)




Conch_Shallow_2005 <- filter(Conch_Shallow_plot, Year == 2005)
Conch_Shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2005_t <- t(Conch_Shallow_2005)

Conch_Shallow_2005_donut <- data.frame(Conch_Shallow_2005_t)
colnames(Conch_Shallow_2005_donut) <- c("Value")
Conch_Shallow_2005_donut <- Conch_Shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2005_donut,"Conch_Shallow_2005.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2005_donut_plot <- read.table("Conch_Shallow_2005.csv", header=TRUE, sep=",")


Conch_Shallow_2005_donut_plot_rounded <- Conch_Shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2005_donut_plot_test <- cbind(Conch_Shallow_2005_donut_plot_rounded,Legend)


Conch_Shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2005.png", width = 6, height = 6)





Conch_Shallow_2006 <- filter(Conch_Shallow_plot, Year == 2006)
Conch_Shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2006_t <- t(Conch_Shallow_2006)

Conch_Shallow_2006_donut <- data.frame(Conch_Shallow_2006_t)
colnames(Conch_Shallow_2006_donut) <- c("Value")
Conch_Shallow_2006_donut <- Conch_Shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2006_donut,"Conch_Shallow_2006.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2006_donut_plot <- read.table("Conch_Shallow_2006.csv", header=TRUE, sep=",")


Conch_Shallow_2006_donut_plot_rounded <- Conch_Shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2006_donut_plot_test <- cbind(Conch_Shallow_2006_donut_plot_rounded,Legend)


Conch_Shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2006.png", width = 6, height = 6)




Conch_Shallow_2007 <- filter(Conch_Shallow_plot, Year == 2007)
Conch_Shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2007_t <- t(Conch_Shallow_2007)

Conch_Shallow_2007_donut <- data.frame(Conch_Shallow_2007_t)
colnames(Conch_Shallow_2007_donut) <- c("Value")
Conch_Shallow_2007_donut <- Conch_Shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2007_donut,"Conch_Shallow_2007.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2007_donut_plot <- read.table("Conch_Shallow_2007.csv", header=TRUE, sep=",")


Conch_Shallow_2007_donut_plot_rounded <- Conch_Shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2007_donut_plot_test <- cbind(Conch_Shallow_2007_donut_plot_rounded,Legend)


Conch_Shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2007.png", width = 6, height = 6)




Conch_Shallow_2008 <- filter(Conch_Shallow_plot, Year == 2008)
Conch_Shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2008_t <- t(Conch_Shallow_2008)

Conch_Shallow_2008_donut <- data.frame(Conch_Shallow_2008_t)
colnames(Conch_Shallow_2008_donut) <- c("Value")
Conch_Shallow_2008_donut <- Conch_Shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2008_donut,"Conch_Shallow_2008.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2008_donut_plot <- read.table("Conch_Shallow_2008.csv", header=TRUE, sep=",")


Conch_Shallow_2008_donut_plot_rounded <- Conch_Shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2008_donut_plot_test <- cbind(Conch_Shallow_2008_donut_plot_rounded,Legend)


Conch_Shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2008.png", width = 6, height = 6)




Conch_Shallow_2009 <- filter(Conch_Shallow_plot, Year == 2009)
Conch_Shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2009_t <- t(Conch_Shallow_2009)

Conch_Shallow_2009_donut <- data.frame(Conch_Shallow_2009_t)
colnames(Conch_Shallow_2009_donut) <- c("Value")
Conch_Shallow_2009_donut <- Conch_Shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2009_donut,"Conch_Shallow_2009.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2009_donut_plot <- read.table("Conch_Shallow_2009.csv", header=TRUE, sep=",")


Conch_Shallow_2009_donut_plot_rounded <- Conch_Shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2009_donut_plot_test <- cbind(Conch_Shallow_2009_donut_plot_rounded,Legend)


Conch_Shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2009.png", width = 6, height = 6)




Conch_Shallow_2010 <- filter(Conch_Shallow_plot, Year == 2010)
Conch_Shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2010_t <- t(Conch_Shallow_2010)

Conch_Shallow_2010_donut <- data.frame(Conch_Shallow_2010_t)
colnames(Conch_Shallow_2010_donut) <- c("Value")
Conch_Shallow_2010_donut <- Conch_Shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2010_donut,"Conch_Shallow_2010.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2010_donut_plot <- read.table("Conch_Shallow_2010.csv", header=TRUE, sep=",")


Conch_Shallow_2010_donut_plot_rounded <- Conch_Shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2010_donut_plot_test <- cbind(Conch_Shallow_2010_donut_plot_rounded,Legend)


Conch_Shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Conch_Shallow_2010.png", width = 6, height = 6)




Conch_Shallow_2011 <- filter(Conch_Shallow_plot, Year == 2011)
Conch_Shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2011_t <- t(Conch_Shallow_2011)

Conch_Shallow_2011_donut <- data.frame(Conch_Shallow_2011_t)
colnames(Conch_Shallow_2011_donut) <- c("Value")
Conch_Shallow_2011_donut <- Conch_Shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2011_donut,"Conch_Shallow_2011.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2011_donut_plot <- read.table("Conch_Shallow_2011.csv", header=TRUE, sep=",")


Conch_Shallow_2011_donut_plot_rounded <- Conch_Shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2011_donut_plot_test <- cbind(Conch_Shallow_2011_donut_plot_rounded,Legend)


Conch_Shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2011.png", width = 6, height = 6)





Conch_Shallow_2012 <- filter(Conch_Shallow_plot, Year == 2012)
Conch_Shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2012_t <- t(Conch_Shallow_2012)

Conch_Shallow_2012_donut <- data.frame(Conch_Shallow_2012_t)
colnames(Conch_Shallow_2012_donut) <- c("Value")
Conch_Shallow_2012_donut <- Conch_Shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2012_donut,"Conch_Shallow_2012.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2012_donut_plot <- read.table("Conch_Shallow_2012.csv", header=TRUE, sep=",")


Conch_Shallow_2012_donut_plot_rounded <- Conch_Shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2012_donut_plot_test <- cbind(Conch_Shallow_2012_donut_plot_rounded,Legend)


Conch_Shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2012.png", width = 6, height = 6)






Conch_Shallow_2014 <- filter(Conch_Shallow_plot, Year == 2014)
Conch_Shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2014_t <- t(Conch_Shallow_2014)

Conch_Shallow_2014_donut <- data.frame(Conch_Shallow_2014_t)
colnames(Conch_Shallow_2014_donut) <- c("Value")
Conch_Shallow_2014_donut <- Conch_Shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2014_donut,"Conch_Shallow_2014.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2014_donut_plot <- read.table("Conch_Shallow_2014.csv", header=TRUE, sep=",")


Conch_Shallow_2014_donut_plot_rounded <- Conch_Shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2014_donut_plot_test <- cbind(Conch_Shallow_2014_donut_plot_rounded,Legend)


Conch_Shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2014.png", width = 6, height = 6)





Conch_Shallow_2016 <- filter(Conch_Shallow_plot, Year == 2016)
Conch_Shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Conch_Shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2016_t <- t(Conch_Shallow_2016)

Conch_Shallow_2016_donut <- data.frame(Conch_Shallow_2016_t)
colnames(Conch_Shallow_2016_donut) <- c("Value")
Conch_Shallow_2016_donut <- Conch_Shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Conch_Shallow_2016_donut,"Conch_Shallow_2016.csv")


### import as csv (change category and value to the two column names)

Conch_Shallow_2016_donut_plot <- read.table("Conch_Shallow_2016.csv", header=TRUE, sep=",")


Conch_Shallow_2016_donut_plot_rounded <- Conch_Shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Conch_Shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Conch_Shallow_2016_donut_plot_test <- cbind(Conch_Shallow_2016_donut_plot_rounded,Legend)


Conch_Shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Conch Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Conch_Shallow_2016.png", width = 6, height = 6)





Grecian_Rocks <- filter(RVC_CREMP, sitename == "Grecian Rocks")

## Make percentages of sum, stony coral cover, and macroalgae

Grecian_Rocks_fish <- Grecian_Rocks$sum/max(Grecian_Rocks$sum)
Grecian_Rocks_biomass <- data.frame(Grecian_Rocks_fish)

Grecian_Rocks_biomass <- 100*Grecian_Rocks_biomass


Grecian_Rocks_Stony <- Grecian_Rocks$Stony_coral/max(Grecian_Rocks$Stony_coral)
Grecian_Rocks_coral <- data.frame(Grecian_Rocks_Stony)

Grecian_Rocks_stony_coral <- 100*Grecian_Rocks_coral

Grecian_Rocks_macro <- Grecian_Rocks$Macroalgae/max(Grecian_Rocks$Macroalgae)
Grecian_Rocks_algae <- data.frame(Grecian_Rocks_macro)


Grecian_Rocks_macroalgae <- (100*Grecian_Rocks_algae)


Grecian_Rocks_plot <- cbind(Grecian_Rocks_macroalgae,Grecian_Rocks_biomass,Grecian_Rocks_stony_coral)

Grecian_Rocks_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Grecian_Rocks_1999 <- filter(Grecian_Rocks_plot, Year == 1999)
Grecian_Rocks_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_1999_t <- t(Grecian_Rocks_1999)

Grecian_Rocks_1999_donut <- data.frame(Grecian_Rocks_1999_t)
colnames(Grecian_Rocks_1999_donut) <- c("Value")
Grecian_Rocks_1999_donut <- Grecian_Rocks_1999_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_1999_donut,"Grecian_Rocks_1999.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_1999_donut_plot <- read.table("Grecian_Rocks_1999.csv", header=TRUE, sep=",")


Grecian_Rocks_1999_donut_plot_rounded <- Grecian_Rocks_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_1999_donut_plot_test <- cbind(Grecian_Rocks_1999_donut_plot_rounded,Legend)


Grecian_Rocks_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_1999.png", width = 6, height = 6)



### Grecian Rocks


Grecian_Rocks_2000 <- filter(Grecian_Rocks_plot, Year == 2000)
Grecian_Rocks_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2000_t <- t(Grecian_Rocks_2000)

Grecian_Rocks_2000_donut <- data.frame(Grecian_Rocks_2000_t)
colnames(Grecian_Rocks_2000_donut) <- c("Value")
Grecian_Rocks_2000_donut <- Grecian_Rocks_2000_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2000_donut,"Grecian_Rocks_2000.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2000_donut_plot <- read.table("Grecian_Rocks_2000.csv", header=TRUE, sep=",")


Grecian_Rocks_2000_donut_plot_rounded <- Grecian_Rocks_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2000_donut_plot_test <- cbind(Grecian_Rocks_2000_donut_plot_rounded,Legend)


Grecian_Rocks_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2000.png", width = 6, height = 6)




Grecian_Rocks_2001 <- filter(Grecian_Rocks_plot, Year == 2001)
Grecian_Rocks_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2001_t <- t(Grecian_Rocks_2001)

Grecian_Rocks_2001_donut <- data.frame(Grecian_Rocks_2001_t)
colnames(Grecian_Rocks_2001_donut) <- c("Value")
Grecian_Rocks_2001_donut <- Grecian_Rocks_2001_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2001_donut,"Grecian_Rocks_2001.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2001_donut_plot <- read.table("Grecian_Rocks_2001.csv", header=TRUE, sep=",")


Grecian_Rocks_2001_donut_plot_rounded <- Grecian_Rocks_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2001_donut_plot_test <- cbind(Grecian_Rocks_2001_donut_plot_rounded,Legend)


Grecian_Rocks_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2001.png", width = 6, height = 6)





Grecian_Rocks_2002 <- filter(Grecian_Rocks_plot, Year == 2002)
Grecian_Rocks_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2002_t <- t(Grecian_Rocks_2002)

Grecian_Rocks_2002_donut <- data.frame(Grecian_Rocks_2002_t)
colnames(Grecian_Rocks_2002_donut) <- c("Value")
Grecian_Rocks_2002_donut <- Grecian_Rocks_2002_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2002_donut,"Grecian_Rocks_2002.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2002_donut_plot <- read.table("Grecian_Rocks_2002.csv", header=TRUE, sep=",")


Grecian_Rocks_2002_donut_plot_rounded <- Grecian_Rocks_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2002_donut_plot_test <- cbind(Grecian_Rocks_2002_donut_plot_rounded,Legend)


Grecian_Rocks_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2002.png", width = 6, height = 6)



Grecian_Rocks_2003 <- filter(Grecian_Rocks_plot, Year == 2003)
Grecian_Rocks_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2003_t <- t(Grecian_Rocks_2003)

Grecian_Rocks_2003_donut <- data.frame(Grecian_Rocks_2003_t)
colnames(Grecian_Rocks_2003_donut) <- c("Value")
Grecian_Rocks_2003_donut <- Grecian_Rocks_2003_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2003_donut,"Grecian_Rocks_2003.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2003_donut_plot <- read.table("Grecian_Rocks_2003.csv", header=TRUE, sep=",")


Grecian_Rocks_2003_donut_plot_rounded <- Grecian_Rocks_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2003_donut_plot_test <- cbind(Grecian_Rocks_2003_donut_plot_rounded,Legend)


Grecian_Rocks_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2003.png", width = 6, height = 6)




Grecian_Rocks_2004 <- filter(Grecian_Rocks_plot, Year == 2004)
Grecian_Rocks_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2004_t <- t(Grecian_Rocks_2004)

Grecian_Rocks_2004_donut <- data.frame(Grecian_Rocks_2004_t)
colnames(Grecian_Rocks_2004_donut) <- c("Value")
Grecian_Rocks_2004_donut <- Grecian_Rocks_2004_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2004_donut,"Grecian_Rocks_2004.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2004_donut_plot <- read.table("Grecian_Rocks_2004.csv", header=TRUE, sep=",")


Grecian_Rocks_2004_donut_plot_rounded <- Grecian_Rocks_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2004_donut_plot_test <- cbind(Grecian_Rocks_2004_donut_plot_rounded,Legend)


Grecian_Rocks_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2004.png", width = 6, height = 6)




Grecian_Rocks_2005 <- filter(Grecian_Rocks_plot, Year == 2005)
Grecian_Rocks_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2005_t <- t(Grecian_Rocks_2005)

Grecian_Rocks_2005_donut <- data.frame(Grecian_Rocks_2005_t)
colnames(Grecian_Rocks_2005_donut) <- c("Value")
Grecian_Rocks_2005_donut <- Grecian_Rocks_2005_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2005_donut,"Grecian_Rocks_2005.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2005_donut_plot <- read.table("Grecian_Rocks_2005.csv", header=TRUE, sep=",")


Grecian_Rocks_2005_donut_plot_rounded <- Grecian_Rocks_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2005_donut_plot_test <- cbind(Grecian_Rocks_2005_donut_plot_rounded,Legend)


Grecian_Rocks_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2005.png", width = 6, height = 6)





Grecian_Rocks_2006 <- filter(Grecian_Rocks_plot, Year == 2006)
Grecian_Rocks_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2006_t <- t(Grecian_Rocks_2006)

Grecian_Rocks_2006_donut <- data.frame(Grecian_Rocks_2006_t)
colnames(Grecian_Rocks_2006_donut) <- c("Value")
Grecian_Rocks_2006_donut <- Grecian_Rocks_2006_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2006_donut,"Grecian_Rocks_2006.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2006_donut_plot <- read.table("Grecian_Rocks_2006.csv", header=TRUE, sep=",")


Grecian_Rocks_2006_donut_plot_rounded <- Grecian_Rocks_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2006_donut_plot_test <- cbind(Grecian_Rocks_2006_donut_plot_rounded,Legend)


Grecian_Rocks_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2006.png", width = 6, height = 6)




Grecian_Rocks_2007 <- filter(Grecian_Rocks_plot, Year == 2007)
Grecian_Rocks_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2007_t <- t(Grecian_Rocks_2007)

Grecian_Rocks_2007_donut <- data.frame(Grecian_Rocks_2007_t)
colnames(Grecian_Rocks_2007_donut) <- c("Value")
Grecian_Rocks_2007_donut <- Grecian_Rocks_2007_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2007_donut,"Grecian_Rocks_2007.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2007_donut_plot <- read.table("Grecian_Rocks_2007.csv", header=TRUE, sep=",")


Grecian_Rocks_2007_donut_plot_rounded <- Grecian_Rocks_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2007_donut_plot_test <- cbind(Grecian_Rocks_2007_donut_plot_rounded,Legend)


Grecian_Rocks_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2007.png", width = 6, height = 6)




Grecian_Rocks_2008 <- filter(Grecian_Rocks_plot, Year == 2008)
Grecian_Rocks_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2008_t <- t(Grecian_Rocks_2008)

Grecian_Rocks_2008_donut <- data.frame(Grecian_Rocks_2008_t)
colnames(Grecian_Rocks_2008_donut) <- c("Value")
Grecian_Rocks_2008_donut <- Grecian_Rocks_2008_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2008_donut,"Grecian_Rocks_2008.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2008_donut_plot <- read.table("Grecian_Rocks_2008.csv", header=TRUE, sep=",")


Grecian_Rocks_2008_donut_plot_rounded <- Grecian_Rocks_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2008_donut_plot_test <- cbind(Grecian_Rocks_2008_donut_plot_rounded,Legend)


Grecian_Rocks_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2008.png", width = 6, height = 6)




Grecian_Rocks_2009 <- filter(Grecian_Rocks_plot, Year == 2009)
Grecian_Rocks_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2009_t <- t(Grecian_Rocks_2009)

Grecian_Rocks_2009_donut <- data.frame(Grecian_Rocks_2009_t)
colnames(Grecian_Rocks_2009_donut) <- c("Value")
Grecian_Rocks_2009_donut <- Grecian_Rocks_2009_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2009_donut,"Grecian_Rocks_2009.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2009_donut_plot <- read.table("Grecian_Rocks_2009.csv", header=TRUE, sep=",")


Grecian_Rocks_2009_donut_plot_rounded <- Grecian_Rocks_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2009_donut_plot_test <- cbind(Grecian_Rocks_2009_donut_plot_rounded,Legend)


Grecian_Rocks_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2009.png", width = 6, height = 6)




Grecian_Rocks_2010 <- filter(Grecian_Rocks_plot, Year == 2010)
Grecian_Rocks_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2010_t <- t(Grecian_Rocks_2010)

Grecian_Rocks_2010_donut <- data.frame(Grecian_Rocks_2010_t)
colnames(Grecian_Rocks_2010_donut) <- c("Value")
Grecian_Rocks_2010_donut <- Grecian_Rocks_2010_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2010_donut,"Grecian_Rocks_2010.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2010_donut_plot <- read.table("Grecian_Rocks_2010.csv", header=TRUE, sep=",")


Grecian_Rocks_2010_donut_plot_rounded <- Grecian_Rocks_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2010_donut_plot_test <- cbind(Grecian_Rocks_2010_donut_plot_rounded,Legend)


Grecian_Rocks_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Grecian_Rocks_2010.png", width = 6, height = 6)




Grecian_Rocks_2011 <- filter(Grecian_Rocks_plot, Year == 2011)
Grecian_Rocks_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2011_t <- t(Grecian_Rocks_2011)

Grecian_Rocks_2011_donut <- data.frame(Grecian_Rocks_2011_t)
colnames(Grecian_Rocks_2011_donut) <- c("Value")
Grecian_Rocks_2011_donut <- Grecian_Rocks_2011_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2011_donut,"Grecian_Rocks_2011.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2011_donut_plot <- read.table("Grecian_Rocks_2011.csv", header=TRUE, sep=",")


Grecian_Rocks_2011_donut_plot_rounded <- Grecian_Rocks_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2011_donut_plot_test <- cbind(Grecian_Rocks_2011_donut_plot_rounded,Legend)


Grecian_Rocks_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2011.png", width = 6, height = 6)





Grecian_Rocks_2012 <- filter(Grecian_Rocks_plot, Year == 2012)
Grecian_Rocks_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2012_t <- t(Grecian_Rocks_2012)

Grecian_Rocks_2012_donut <- data.frame(Grecian_Rocks_2012_t)
colnames(Grecian_Rocks_2012_donut) <- c("Value")
Grecian_Rocks_2012_donut <- Grecian_Rocks_2012_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2012_donut,"Grecian_Rocks_2012.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2012_donut_plot <- read.table("Grecian_Rocks_2012.csv", header=TRUE, sep=",")


Grecian_Rocks_2012_donut_plot_rounded <- Grecian_Rocks_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2012_donut_plot_test <- cbind(Grecian_Rocks_2012_donut_plot_rounded,Legend)


Grecian_Rocks_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2012.png", width = 6, height = 6)






Grecian_Rocks_2014 <- filter(Grecian_Rocks_plot, Year == 2014)
Grecian_Rocks_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2014_t <- t(Grecian_Rocks_2014)

Grecian_Rocks_2014_donut <- data.frame(Grecian_Rocks_2014_t)
colnames(Grecian_Rocks_2014_donut) <- c("Value")
Grecian_Rocks_2014_donut <- Grecian_Rocks_2014_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2014_donut,"Grecian_Rocks_2014.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2014_donut_plot <- read.table("Grecian_Rocks_2014.csv", header=TRUE, sep=",")


Grecian_Rocks_2014_donut_plot_rounded <- Grecian_Rocks_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2014_donut_plot_test <- cbind(Grecian_Rocks_2014_donut_plot_rounded,Legend)


Grecian_Rocks_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2014.png", width = 6, height = 6)





Grecian_Rocks_2016 <- filter(Grecian_Rocks_plot, Year == 2016)
Grecian_Rocks_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Grecian_Rocks_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2016_t <- t(Grecian_Rocks_2016)

Grecian_Rocks_2016_donut <- data.frame(Grecian_Rocks_2016_t)
colnames(Grecian_Rocks_2016_donut) <- c("Value")
Grecian_Rocks_2016_donut <- Grecian_Rocks_2016_donut %>%
  rownames_to_column(var = "Category")


export(Grecian_Rocks_2016_donut,"Grecian_Rocks_2016.csv")


### import as csv (change category and value to the two column names)

Grecian_Rocks_2016_donut_plot <- read.table("Grecian_Rocks_2016.csv", header=TRUE, sep=",")


Grecian_Rocks_2016_donut_plot_rounded <- Grecian_Rocks_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Grecian_Rocks_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Grecian_Rocks_2016_donut_plot_test <- cbind(Grecian_Rocks_2016_donut_plot_rounded,Legend)


Grecian_Rocks_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Grecian Rocks 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Grecian_Rocks_2016.png", width = 6, height = 6)




Molasses_Deep <- filter(RVC_CREMP, sitename == "Molasses Deep")

## Make percentages of sum, stony coral cover, and macroalgae

Molasses_Deep_fish <- Molasses_Deep$sum/max(Molasses_Deep$sum)
Molasses_Deep_biomass <- data.frame(Molasses_Deep_fish)

Molasses_Deep_biomass <- 100*Molasses_Deep_biomass


Molasses_Deep_Stony <- Molasses_Deep$Stony_coral/max(Molasses_Deep$Stony_coral)
Molasses_Deep_coral <- data.frame(Molasses_Deep_Stony)

Molasses_Deep_stony_coral <- 100*Molasses_Deep_coral

Molasses_Deep_macro <- Molasses_Deep$Macroalgae/max(Molasses_Deep$Macroalgae)
Molasses_Deep_algae <- data.frame(Molasses_Deep_macro)


Molasses_Deep_macroalgae <- (100*Molasses_Deep_algae)


Molasses_Deep_plot <- cbind(Molasses_Deep_macroalgae,Molasses_Deep_biomass,Molasses_Deep_stony_coral)

Molasses_Deep_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Molasses_Deep_1999 <- filter(Molasses_Deep_plot, Year == 1999)
Molasses_Deep_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_1999_t <- t(Molasses_Deep_1999)

Molasses_Deep_1999_donut <- data.frame(Molasses_Deep_1999_t)
colnames(Molasses_Deep_1999_donut) <- c("Value")
Molasses_Deep_1999_donut <- Molasses_Deep_1999_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_1999_donut,"Molasses_Deep_1999.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_1999_donut_plot <- read.table("Molasses_Deep_1999.csv", header=TRUE, sep=",")


Molasses_Deep_1999_donut_plot_rounded <- Molasses_Deep_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_1999_donut_plot_test <- cbind(Molasses_Deep_1999_donut_plot_rounded,Legend)


Molasses_Deep_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_1999.png", width = 6, height = 6)



### Molasses Deep


Molasses_Deep_2000 <- filter(Molasses_Deep_plot, Year == 2000)
Molasses_Deep_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2000_t <- t(Molasses_Deep_2000)

Molasses_Deep_2000_donut <- data.frame(Molasses_Deep_2000_t)
colnames(Molasses_Deep_2000_donut) <- c("Value")
Molasses_Deep_2000_donut <- Molasses_Deep_2000_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2000_donut,"Molasses_Deep_2000.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2000_donut_plot <- read.table("Molasses_Deep_2000.csv", header=TRUE, sep=",")


Molasses_Deep_2000_donut_plot_rounded <- Molasses_Deep_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2000_donut_plot_test <- cbind(Molasses_Deep_2000_donut_plot_rounded,Legend)


Molasses_Deep_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2000.png", width = 6, height = 6)




Molasses_Deep_2001 <- filter(Molasses_Deep_plot, Year == 2001)
Molasses_Deep_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2001_t <- t(Molasses_Deep_2001)

Molasses_Deep_2001_donut <- data.frame(Molasses_Deep_2001_t)
colnames(Molasses_Deep_2001_donut) <- c("Value")
Molasses_Deep_2001_donut <- Molasses_Deep_2001_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2001_donut,"Molasses_Deep_2001.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2001_donut_plot <- read.table("Molasses_Deep_2001.csv", header=TRUE, sep=",")


Molasses_Deep_2001_donut_plot_rounded <- Molasses_Deep_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2001_donut_plot_test <- cbind(Molasses_Deep_2001_donut_plot_rounded,Legend)


Molasses_Deep_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2001.png", width = 6, height = 6)





Molasses_Deep_2002 <- filter(Molasses_Deep_plot, Year == 2002)
Molasses_Deep_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2002_t <- t(Molasses_Deep_2002)

Molasses_Deep_2002_donut <- data.frame(Molasses_Deep_2002_t)
colnames(Molasses_Deep_2002_donut) <- c("Value")
Molasses_Deep_2002_donut <- Molasses_Deep_2002_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2002_donut,"Molasses_Deep_2002.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2002_donut_plot <- read.table("Molasses_Deep_2002.csv", header=TRUE, sep=",")


Molasses_Deep_2002_donut_plot_rounded <- Molasses_Deep_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2002_donut_plot_test <- cbind(Molasses_Deep_2002_donut_plot_rounded,Legend)


Molasses_Deep_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2002.png", width = 6, height = 6)



Molasses_Deep_2003 <- filter(Molasses_Deep_plot, Year == 2003)
Molasses_Deep_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2003_t <- t(Molasses_Deep_2003)

Molasses_Deep_2003_donut <- data.frame(Molasses_Deep_2003_t)
colnames(Molasses_Deep_2003_donut) <- c("Value")
Molasses_Deep_2003_donut <- Molasses_Deep_2003_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2003_donut,"Molasses_Deep_2003.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2003_donut_plot <- read.table("Molasses_Deep_2003.csv", header=TRUE, sep=",")


Molasses_Deep_2003_donut_plot_rounded <- Molasses_Deep_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2003_donut_plot_test <- cbind(Molasses_Deep_2003_donut_plot_rounded,Legend)


Molasses_Deep_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2003.png", width = 6, height = 6)




Molasses_Deep_2004 <- filter(Molasses_Deep_plot, Year == 2004)
Molasses_Deep_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2004_t <- t(Molasses_Deep_2004)

Molasses_Deep_2004_donut <- data.frame(Molasses_Deep_2004_t)
colnames(Molasses_Deep_2004_donut) <- c("Value")
Molasses_Deep_2004_donut <- Molasses_Deep_2004_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2004_donut,"Molasses_Deep_2004.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2004_donut_plot <- read.table("Molasses_Deep_2004.csv", header=TRUE, sep=",")


Molasses_Deep_2004_donut_plot_rounded <- Molasses_Deep_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2004_donut_plot_test <- cbind(Molasses_Deep_2004_donut_plot_rounded,Legend)


Molasses_Deep_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2004.png", width = 6, height = 6)




Molasses_Deep_2005 <- filter(Molasses_Deep_plot, Year == 2005)
Molasses_Deep_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2005_t <- t(Molasses_Deep_2005)

Molasses_Deep_2005_donut <- data.frame(Molasses_Deep_2005_t)
colnames(Molasses_Deep_2005_donut) <- c("Value")
Molasses_Deep_2005_donut <- Molasses_Deep_2005_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2005_donut,"Molasses_Deep_2005.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2005_donut_plot <- read.table("Molasses_Deep_2005.csv", header=TRUE, sep=",")


Molasses_Deep_2005_donut_plot_rounded <- Molasses_Deep_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2005_donut_plot_test <- cbind(Molasses_Deep_2005_donut_plot_rounded,Legend)


Molasses_Deep_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2005.png", width = 6, height = 6)





Molasses_Deep_2006 <- filter(Molasses_Deep_plot, Year == 2006)
Molasses_Deep_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2006_t <- t(Molasses_Deep_2006)

Molasses_Deep_2006_donut <- data.frame(Molasses_Deep_2006_t)
colnames(Molasses_Deep_2006_donut) <- c("Value")
Molasses_Deep_2006_donut <- Molasses_Deep_2006_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2006_donut,"Molasses_Deep_2006.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2006_donut_plot <- read.table("Molasses_Deep_2006.csv", header=TRUE, sep=",")


Molasses_Deep_2006_donut_plot_rounded <- Molasses_Deep_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2006_donut_plot_test <- cbind(Molasses_Deep_2006_donut_plot_rounded,Legend)


Molasses_Deep_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2006.png", width = 6, height = 6)




Molasses_Deep_2007 <- filter(Molasses_Deep_plot, Year == 2007)
Molasses_Deep_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2007_t <- t(Molasses_Deep_2007)

Molasses_Deep_2007_donut <- data.frame(Molasses_Deep_2007_t)
colnames(Molasses_Deep_2007_donut) <- c("Value")
Molasses_Deep_2007_donut <- Molasses_Deep_2007_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2007_donut,"Molasses_Deep_2007.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2007_donut_plot <- read.table("Molasses_Deep_2007.csv", header=TRUE, sep=",")


Molasses_Deep_2007_donut_plot_rounded <- Molasses_Deep_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2007_donut_plot_test <- cbind(Molasses_Deep_2007_donut_plot_rounded,Legend)


Molasses_Deep_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2007.png", width = 6, height = 6)




Molasses_Deep_2008 <- filter(Molasses_Deep_plot, Year == 2008)
Molasses_Deep_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2008_t <- t(Molasses_Deep_2008)

Molasses_Deep_2008_donut <- data.frame(Molasses_Deep_2008_t)
colnames(Molasses_Deep_2008_donut) <- c("Value")
Molasses_Deep_2008_donut <- Molasses_Deep_2008_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2008_donut,"Molasses_Deep_2008.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2008_donut_plot <- read.table("Molasses_Deep_2008.csv", header=TRUE, sep=",")


Molasses_Deep_2008_donut_plot_rounded <- Molasses_Deep_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2008_donut_plot_test <- cbind(Molasses_Deep_2008_donut_plot_rounded,Legend)


Molasses_Deep_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2008.png", width = 6, height = 6)




Molasses_Deep_2009 <- filter(Molasses_Deep_plot, Year == 2009)
Molasses_Deep_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2009_t <- t(Molasses_Deep_2009)

Molasses_Deep_2009_donut <- data.frame(Molasses_Deep_2009_t)
colnames(Molasses_Deep_2009_donut) <- c("Value")
Molasses_Deep_2009_donut <- Molasses_Deep_2009_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2009_donut,"Molasses_Deep_2009.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2009_donut_plot <- read.table("Molasses_Deep_2009.csv", header=TRUE, sep=",")


Molasses_Deep_2009_donut_plot_rounded <- Molasses_Deep_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2009_donut_plot_test <- cbind(Molasses_Deep_2009_donut_plot_rounded,Legend)


Molasses_Deep_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2009.png", width = 6, height = 6)




Molasses_Deep_2010 <- filter(Molasses_Deep_plot, Year == 2010)
Molasses_Deep_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2010_t <- t(Molasses_Deep_2010)

Molasses_Deep_2010_donut <- data.frame(Molasses_Deep_2010_t)
colnames(Molasses_Deep_2010_donut) <- c("Value")
Molasses_Deep_2010_donut <- Molasses_Deep_2010_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2010_donut,"Molasses_Deep_2010.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2010_donut_plot <- read.table("Molasses_Deep_2010.csv", header=TRUE, sep=",")


Molasses_Deep_2010_donut_plot_rounded <- Molasses_Deep_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2010_donut_plot_test <- cbind(Molasses_Deep_2010_donut_plot_rounded,Legend)


Molasses_Deep_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Molasses_Deep_2010.png", width = 6, height = 6)




Molasses_Deep_2011 <- filter(Molasses_Deep_plot, Year == 2011)
Molasses_Deep_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2011_t <- t(Molasses_Deep_2011)

Molasses_Deep_2011_donut <- data.frame(Molasses_Deep_2011_t)
colnames(Molasses_Deep_2011_donut) <- c("Value")
Molasses_Deep_2011_donut <- Molasses_Deep_2011_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2011_donut,"Molasses_Deep_2011.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2011_donut_plot <- read.table("Molasses_Deep_2011.csv", header=TRUE, sep=",")


Molasses_Deep_2011_donut_plot_rounded <- Molasses_Deep_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2011_donut_plot_test <- cbind(Molasses_Deep_2011_donut_plot_rounded,Legend)


Molasses_Deep_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2011.png", width = 6, height = 6)





Molasses_Deep_2012 <- filter(Molasses_Deep_plot, Year == 2012)
Molasses_Deep_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2012_t <- t(Molasses_Deep_2012)

Molasses_Deep_2012_donut <- data.frame(Molasses_Deep_2012_t)
colnames(Molasses_Deep_2012_donut) <- c("Value")
Molasses_Deep_2012_donut <- Molasses_Deep_2012_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2012_donut,"Molasses_Deep_2012.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2012_donut_plot <- read.table("Molasses_Deep_2012.csv", header=TRUE, sep=",")


Molasses_Deep_2012_donut_plot_rounded <- Molasses_Deep_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2012_donut_plot_test <- cbind(Molasses_Deep_2012_donut_plot_rounded,Legend)


Molasses_Deep_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2012.png", width = 6, height = 6)






Molasses_Deep_2014 <- filter(Molasses_Deep_plot, Year == 2014)
Molasses_Deep_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2014_t <- t(Molasses_Deep_2014)

Molasses_Deep_2014_donut <- data.frame(Molasses_Deep_2014_t)
colnames(Molasses_Deep_2014_donut) <- c("Value")
Molasses_Deep_2014_donut <- Molasses_Deep_2014_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2014_donut,"Molasses_Deep_2014.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2014_donut_plot <- read.table("Molasses_Deep_2014.csv", header=TRUE, sep=",")


Molasses_Deep_2014_donut_plot_rounded <- Molasses_Deep_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2014_donut_plot_test <- cbind(Molasses_Deep_2014_donut_plot_rounded,Legend)


Molasses_Deep_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2014.png", width = 6, height = 6)





Molasses_Deep_2016 <- filter(Molasses_Deep_plot, Year == 2016)
Molasses_Deep_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Deep_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2016_t <- t(Molasses_Deep_2016)

Molasses_Deep_2016_donut <- data.frame(Molasses_Deep_2016_t)
colnames(Molasses_Deep_2016_donut) <- c("Value")
Molasses_Deep_2016_donut <- Molasses_Deep_2016_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Deep_2016_donut,"Molasses_Deep_2016.csv")


### import as csv (change category and value to the two column names)

Molasses_Deep_2016_donut_plot <- read.table("Molasses_Deep_2016.csv", header=TRUE, sep=",")


Molasses_Deep_2016_donut_plot_rounded <- Molasses_Deep_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Deep_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Deep_2016_donut_plot_test <- cbind(Molasses_Deep_2016_donut_plot_rounded,Legend)


Molasses_Deep_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Deep 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Deep_2016.png", width = 6, height = 6)




Molasses_Shallow <- filter(RVC_CREMP, sitename == "Molasses Shallow")

## Make percentages of sum, stony coral cover, and macroalgae

Molasses_Shallow_fish <- Molasses_Shallow$sum/max(Molasses_Shallow$sum)
Molasses_Shallow_biomass <- data.frame(Molasses_Shallow_fish)

Molasses_Shallow_biomass <- 100*Molasses_Shallow_biomass


Molasses_Shallow_Stony <- Molasses_Shallow$Stony_coral/max(Molasses_Shallow$Stony_coral)
Molasses_Shallow_coral <- data.frame(Molasses_Shallow_Stony)

Molasses_Shallow_stony_coral <- 100*Molasses_Shallow_coral

Molasses_Shallow_macro <- Molasses_Shallow$Macroalgae/max(Molasses_Shallow$Macroalgae)
Molasses_Shallow_algae <- data.frame(Molasses_Shallow_macro)


Molasses_Shallow_macroalgae <- (100*Molasses_Shallow_algae)


Molasses_Shallow_plot <- cbind(Molasses_Shallow_macroalgae,Molasses_Shallow_biomass,Molasses_Shallow_stony_coral)

Molasses_Shallow_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2011","2012","2014","2016")

### Filter per year

Molasses_Shallow_1999 <- filter(Molasses_Shallow_plot, Year == 1999)
Molasses_Shallow_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_1999_t <- t(Molasses_Shallow_1999)

Molasses_Shallow_1999_donut <- data.frame(Molasses_Shallow_1999_t)
colnames(Molasses_Shallow_1999_donut) <- c("Value")
Molasses_Shallow_1999_donut <- Molasses_Shallow_1999_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_1999_donut,"Molasses_Shallow_1999.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_1999_donut_plot <- read.table("Molasses_Shallow_1999.csv", header=TRUE, sep=",")


Molasses_Shallow_1999_donut_plot_rounded <- Molasses_Shallow_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_1999_donut_plot_test <- cbind(Molasses_Shallow_1999_donut_plot_rounded,Legend)


Molasses_Shallow_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_1999.png", width = 6, height = 6)



### Molasses Shallow


Molasses_Shallow_2000 <- filter(Molasses_Shallow_plot, Year == 2000)
Molasses_Shallow_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2000_t <- t(Molasses_Shallow_2000)

Molasses_Shallow_2000_donut <- data.frame(Molasses_Shallow_2000_t)
colnames(Molasses_Shallow_2000_donut) <- c("Value")
Molasses_Shallow_2000_donut <- Molasses_Shallow_2000_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2000_donut,"Molasses_Shallow_2000.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2000_donut_plot <- read.table("Molasses_Shallow_2000.csv", header=TRUE, sep=",")


Molasses_Shallow_2000_donut_plot_rounded <- Molasses_Shallow_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2000_donut_plot_test <- cbind(Molasses_Shallow_2000_donut_plot_rounded,Legend)


Molasses_Shallow_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2000.png", width = 6, height = 6)




Molasses_Shallow_2001 <- filter(Molasses_Shallow_plot, Year == 2001)
Molasses_Shallow_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2001_t <- t(Molasses_Shallow_2001)

Molasses_Shallow_2001_donut <- data.frame(Molasses_Shallow_2001_t)
colnames(Molasses_Shallow_2001_donut) <- c("Value")
Molasses_Shallow_2001_donut <- Molasses_Shallow_2001_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2001_donut,"Molasses_Shallow_2001.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2001_donut_plot <- read.table("Molasses_Shallow_2001.csv", header=TRUE, sep=",")


Molasses_Shallow_2001_donut_plot_rounded <- Molasses_Shallow_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2001_donut_plot_test <- cbind(Molasses_Shallow_2001_donut_plot_rounded,Legend)


Molasses_Shallow_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2001.png", width = 6, height = 6)





Molasses_Shallow_2002 <- filter(Molasses_Shallow_plot, Year == 2002)
Molasses_Shallow_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2002_t <- t(Molasses_Shallow_2002)

Molasses_Shallow_2002_donut <- data.frame(Molasses_Shallow_2002_t)
colnames(Molasses_Shallow_2002_donut) <- c("Value")
Molasses_Shallow_2002_donut <- Molasses_Shallow_2002_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2002_donut,"Molasses_Shallow_2002.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2002_donut_plot <- read.table("Molasses_Shallow_2002.csv", header=TRUE, sep=",")


Molasses_Shallow_2002_donut_plot_rounded <- Molasses_Shallow_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2002_donut_plot_test <- cbind(Molasses_Shallow_2002_donut_plot_rounded,Legend)


Molasses_Shallow_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2002.png", width = 6, height = 6)



Molasses_Shallow_2003 <- filter(Molasses_Shallow_plot, Year == 2003)
Molasses_Shallow_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2003_t <- t(Molasses_Shallow_2003)

Molasses_Shallow_2003_donut <- data.frame(Molasses_Shallow_2003_t)
colnames(Molasses_Shallow_2003_donut) <- c("Value")
Molasses_Shallow_2003_donut <- Molasses_Shallow_2003_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2003_donut,"Molasses_Shallow_2003.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2003_donut_plot <- read.table("Molasses_Shallow_2003.csv", header=TRUE, sep=",")


Molasses_Shallow_2003_donut_plot_rounded <- Molasses_Shallow_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2003_donut_plot_test <- cbind(Molasses_Shallow_2003_donut_plot_rounded,Legend)


Molasses_Shallow_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2003.png", width = 6, height = 6)




Molasses_Shallow_2004 <- filter(Molasses_Shallow_plot, Year == 2004)
Molasses_Shallow_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2004_t <- t(Molasses_Shallow_2004)

Molasses_Shallow_2004_donut <- data.frame(Molasses_Shallow_2004_t)
colnames(Molasses_Shallow_2004_donut) <- c("Value")
Molasses_Shallow_2004_donut <- Molasses_Shallow_2004_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2004_donut,"Molasses_Shallow_2004.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2004_donut_plot <- read.table("Molasses_Shallow_2004.csv", header=TRUE, sep=",")


Molasses_Shallow_2004_donut_plot_rounded <- Molasses_Shallow_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2004_donut_plot_test <- cbind(Molasses_Shallow_2004_donut_plot_rounded,Legend)


Molasses_Shallow_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2004.png", width = 6, height = 6)




Molasses_Shallow_2005 <- filter(Molasses_Shallow_plot, Year == 2005)
Molasses_Shallow_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2005_t <- t(Molasses_Shallow_2005)

Molasses_Shallow_2005_donut <- data.frame(Molasses_Shallow_2005_t)
colnames(Molasses_Shallow_2005_donut) <- c("Value")
Molasses_Shallow_2005_donut <- Molasses_Shallow_2005_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2005_donut,"Molasses_Shallow_2005.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2005_donut_plot <- read.table("Molasses_Shallow_2005.csv", header=TRUE, sep=",")


Molasses_Shallow_2005_donut_plot_rounded <- Molasses_Shallow_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2005_donut_plot_test <- cbind(Molasses_Shallow_2005_donut_plot_rounded,Legend)


Molasses_Shallow_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2005.png", width = 6, height = 6)





Molasses_Shallow_2006 <- filter(Molasses_Shallow_plot, Year == 2006)
Molasses_Shallow_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2006_t <- t(Molasses_Shallow_2006)

Molasses_Shallow_2006_donut <- data.frame(Molasses_Shallow_2006_t)
colnames(Molasses_Shallow_2006_donut) <- c("Value")
Molasses_Shallow_2006_donut <- Molasses_Shallow_2006_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2006_donut,"Molasses_Shallow_2006.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2006_donut_plot <- read.table("Molasses_Shallow_2006.csv", header=TRUE, sep=",")


Molasses_Shallow_2006_donut_plot_rounded <- Molasses_Shallow_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2006_donut_plot_test <- cbind(Molasses_Shallow_2006_donut_plot_rounded,Legend)


Molasses_Shallow_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2006.png", width = 6, height = 6)




Molasses_Shallow_2007 <- filter(Molasses_Shallow_plot, Year == 2007)
Molasses_Shallow_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2007_t <- t(Molasses_Shallow_2007)

Molasses_Shallow_2007_donut <- data.frame(Molasses_Shallow_2007_t)
colnames(Molasses_Shallow_2007_donut) <- c("Value")
Molasses_Shallow_2007_donut <- Molasses_Shallow_2007_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2007_donut,"Molasses_Shallow_2007.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2007_donut_plot <- read.table("Molasses_Shallow_2007.csv", header=TRUE, sep=",")


Molasses_Shallow_2007_donut_plot_rounded <- Molasses_Shallow_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2007_donut_plot_test <- cbind(Molasses_Shallow_2007_donut_plot_rounded,Legend)


Molasses_Shallow_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2007.png", width = 6, height = 6)




Molasses_Shallow_2008 <- filter(Molasses_Shallow_plot, Year == 2008)
Molasses_Shallow_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2008_t <- t(Molasses_Shallow_2008)

Molasses_Shallow_2008_donut <- data.frame(Molasses_Shallow_2008_t)
colnames(Molasses_Shallow_2008_donut) <- c("Value")
Molasses_Shallow_2008_donut <- Molasses_Shallow_2008_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2008_donut,"Molasses_Shallow_2008.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2008_donut_plot <- read.table("Molasses_Shallow_2008.csv", header=TRUE, sep=",")


Molasses_Shallow_2008_donut_plot_rounded <- Molasses_Shallow_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2008_donut_plot_test <- cbind(Molasses_Shallow_2008_donut_plot_rounded,Legend)


Molasses_Shallow_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2008.png", width = 6, height = 6)




Molasses_Shallow_2009 <- filter(Molasses_Shallow_plot, Year == 2009)
Molasses_Shallow_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2009_t <- t(Molasses_Shallow_2009)

Molasses_Shallow_2009_donut <- data.frame(Molasses_Shallow_2009_t)
colnames(Molasses_Shallow_2009_donut) <- c("Value")
Molasses_Shallow_2009_donut <- Molasses_Shallow_2009_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2009_donut,"Molasses_Shallow_2009.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2009_donut_plot <- read.table("Molasses_Shallow_2009.csv", header=TRUE, sep=",")


Molasses_Shallow_2009_donut_plot_rounded <- Molasses_Shallow_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2009_donut_plot_test <- cbind(Molasses_Shallow_2009_donut_plot_rounded,Legend)


Molasses_Shallow_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2009.png", width = 6, height = 6)




Molasses_Shallow_2010 <- filter(Molasses_Shallow_plot, Year == 2010)
Molasses_Shallow_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2010_t <- t(Molasses_Shallow_2010)

Molasses_Shallow_2010_donut <- data.frame(Molasses_Shallow_2010_t)
colnames(Molasses_Shallow_2010_donut) <- c("Value")
Molasses_Shallow_2010_donut <- Molasses_Shallow_2010_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2010_donut,"Molasses_Shallow_2010.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2010_donut_plot <- read.table("Molasses_Shallow_2010.csv", header=TRUE, sep=",")


Molasses_Shallow_2010_donut_plot_rounded <- Molasses_Shallow_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2010_donut_plot_test <- cbind(Molasses_Shallow_2010_donut_plot_rounded,Legend)


Molasses_Shallow_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Molasses_Shallow_2010.png", width = 6, height = 6)




Molasses_Shallow_2011 <- filter(Molasses_Shallow_plot, Year == 2011)
Molasses_Shallow_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2011_t <- t(Molasses_Shallow_2011)

Molasses_Shallow_2011_donut <- data.frame(Molasses_Shallow_2011_t)
colnames(Molasses_Shallow_2011_donut) <- c("Value")
Molasses_Shallow_2011_donut <- Molasses_Shallow_2011_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2011_donut,"Molasses_Shallow_2011.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2011_donut_plot <- read.table("Molasses_Shallow_2011.csv", header=TRUE, sep=",")


Molasses_Shallow_2011_donut_plot_rounded <- Molasses_Shallow_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2011_donut_plot_test <- cbind(Molasses_Shallow_2011_donut_plot_rounded,Legend)


Molasses_Shallow_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2011.png", width = 6, height = 6)





Molasses_Shallow_2012 <- filter(Molasses_Shallow_plot, Year == 2012)
Molasses_Shallow_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2012_t <- t(Molasses_Shallow_2012)

Molasses_Shallow_2012_donut <- data.frame(Molasses_Shallow_2012_t)
colnames(Molasses_Shallow_2012_donut) <- c("Value")
Molasses_Shallow_2012_donut <- Molasses_Shallow_2012_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2012_donut,"Molasses_Shallow_2012.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2012_donut_plot <- read.table("Molasses_Shallow_2012.csv", header=TRUE, sep=",")


Molasses_Shallow_2012_donut_plot_rounded <- Molasses_Shallow_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2012_donut_plot_test <- cbind(Molasses_Shallow_2012_donut_plot_rounded,Legend)


Molasses_Shallow_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2012.png", width = 6, height = 6)






Molasses_Shallow_2014 <- filter(Molasses_Shallow_plot, Year == 2014)
Molasses_Shallow_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2014_t <- t(Molasses_Shallow_2014)

Molasses_Shallow_2014_donut <- data.frame(Molasses_Shallow_2014_t)
colnames(Molasses_Shallow_2014_donut) <- c("Value")
Molasses_Shallow_2014_donut <- Molasses_Shallow_2014_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2014_donut,"Molasses_Shallow_2014.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2014_donut_plot <- read.table("Molasses_Shallow_2014.csv", header=TRUE, sep=",")


Molasses_Shallow_2014_donut_plot_rounded <- Molasses_Shallow_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2014_donut_plot_test <- cbind(Molasses_Shallow_2014_donut_plot_rounded,Legend)


Molasses_Shallow_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2014.png", width = 6, height = 6)





Molasses_Shallow_2016 <- filter(Molasses_Shallow_plot, Year == 2016)
Molasses_Shallow_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Molasses_Shallow_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2016_t <- t(Molasses_Shallow_2016)

Molasses_Shallow_2016_donut <- data.frame(Molasses_Shallow_2016_t)
colnames(Molasses_Shallow_2016_donut) <- c("Value")
Molasses_Shallow_2016_donut <- Molasses_Shallow_2016_donut %>%
  rownames_to_column(var = "Category")


export(Molasses_Shallow_2016_donut,"Molasses_Shallow_2016.csv")


### import as csv (change category and value to the two column names)

Molasses_Shallow_2016_donut_plot <- read.table("Molasses_Shallow_2016.csv", header=TRUE, sep=",")


Molasses_Shallow_2016_donut_plot_rounded <- Molasses_Shallow_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Molasses_Shallow_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Molasses_Shallow_2016_donut_plot_test <- cbind(Molasses_Shallow_2016_donut_plot_rounded,Legend)


Molasses_Shallow_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Molasses Shallow 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Molasses_Shallow_2016.png", width = 6, height = 6)






Porter_Patch <- filter(RVC_CREMP, sitename == "Porter Patch")

## Make percentages of sum, stony coral cover, and macroalgae

Porter_Patch_fish <- Porter_Patch$sum/max(Porter_Patch$sum)
Porter_Patch_biomass <- data.frame(Porter_Patch_fish)

Porter_Patch_biomass <- 100*Porter_Patch_biomass


Porter_Patch_Stony <- Porter_Patch$Stony_coral/max(Porter_Patch$Stony_coral)
Porter_Patch_coral <- data.frame(Porter_Patch_Stony)

Porter_Patch_stony_coral <- 100*Porter_Patch_coral

Porter_Patch_macro <- Porter_Patch$Macroalgae/max(Porter_Patch$Macroalgae)
Porter_Patch_algae <- data.frame(Porter_Patch_macro)


Porter_Patch_macroalgae <- (100*Porter_Patch_algae)


Porter_Patch_plot <- cbind(Porter_Patch_macroalgae,Porter_Patch_biomass,Porter_Patch_stony_coral)

Porter_Patch_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2012","2014")

### Filter per year

Porter_Patch_1999 <- filter(Porter_Patch_plot, Year == 1999)
Porter_Patch_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_1999_t <- t(Porter_Patch_1999)

Porter_Patch_1999_donut <- data.frame(Porter_Patch_1999_t)
colnames(Porter_Patch_1999_donut) <- c("Value")
Porter_Patch_1999_donut <- Porter_Patch_1999_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_1999_donut,"Porter_Patch_1999.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_1999_donut_plot <- read.table("Porter_Patch_1999.csv", header=TRUE, sep=",")


Porter_Patch_1999_donut_plot_rounded <- Porter_Patch_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_1999_donut_plot_test <- cbind(Porter_Patch_1999_donut_plot_rounded,Legend)


Porter_Patch_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_1999.png", width = 6, height = 6)



### Porter Patch


Porter_Patch_2000 <- filter(Porter_Patch_plot, Year == 2000)
Porter_Patch_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2000_t <- t(Porter_Patch_2000)

Porter_Patch_2000_donut <- data.frame(Porter_Patch_2000_t)
colnames(Porter_Patch_2000_donut) <- c("Value")
Porter_Patch_2000_donut <- Porter_Patch_2000_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2000_donut,"Porter_Patch_2000.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2000_donut_plot <- read.table("Porter_Patch_2000.csv", header=TRUE, sep=",")


Porter_Patch_2000_donut_plot_rounded <- Porter_Patch_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2000_donut_plot_test <- cbind(Porter_Patch_2000_donut_plot_rounded,Legend)


Porter_Patch_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2000.png", width = 6, height = 6)




Porter_Patch_2001 <- filter(Porter_Patch_plot, Year == 2001)
Porter_Patch_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2001_t <- t(Porter_Patch_2001)

Porter_Patch_2001_donut <- data.frame(Porter_Patch_2001_t)
colnames(Porter_Patch_2001_donut) <- c("Value")
Porter_Patch_2001_donut <- Porter_Patch_2001_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2001_donut,"Porter_Patch_2001.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2001_donut_plot <- read.table("Porter_Patch_2001.csv", header=TRUE, sep=",")


Porter_Patch_2001_donut_plot_rounded <- Porter_Patch_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2001_donut_plot_test <- cbind(Porter_Patch_2001_donut_plot_rounded,Legend)


Porter_Patch_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2001.png", width = 6, height = 6)





Porter_Patch_2002 <- filter(Porter_Patch_plot, Year == 2002)
Porter_Patch_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2002_t <- t(Porter_Patch_2002)

Porter_Patch_2002_donut <- data.frame(Porter_Patch_2002_t)
colnames(Porter_Patch_2002_donut) <- c("Value")
Porter_Patch_2002_donut <- Porter_Patch_2002_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2002_donut,"Porter_Patch_2002.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2002_donut_plot <- read.table("Porter_Patch_2002.csv", header=TRUE, sep=",")


Porter_Patch_2002_donut_plot_rounded <- Porter_Patch_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2002_donut_plot_test <- cbind(Porter_Patch_2002_donut_plot_rounded,Legend)


Porter_Patch_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2002.png", width = 6, height = 6)



Porter_Patch_2003 <- filter(Porter_Patch_plot, Year == 2003)
Porter_Patch_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2003_t <- t(Porter_Patch_2003)

Porter_Patch_2003_donut <- data.frame(Porter_Patch_2003_t)
colnames(Porter_Patch_2003_donut) <- c("Value")
Porter_Patch_2003_donut <- Porter_Patch_2003_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2003_donut,"Porter_Patch_2003.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2003_donut_plot <- read.table("Porter_Patch_2003.csv", header=TRUE, sep=",")


Porter_Patch_2003_donut_plot_rounded <- Porter_Patch_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2003_donut_plot_test <- cbind(Porter_Patch_2003_donut_plot_rounded,Legend)


Porter_Patch_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2003.png", width = 6, height = 6)




Porter_Patch_2004 <- filter(Porter_Patch_plot, Year == 2004)
Porter_Patch_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2004_t <- t(Porter_Patch_2004)

Porter_Patch_2004_donut <- data.frame(Porter_Patch_2004_t)
colnames(Porter_Patch_2004_donut) <- c("Value")
Porter_Patch_2004_donut <- Porter_Patch_2004_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2004_donut,"Porter_Patch_2004.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2004_donut_plot <- read.table("Porter_Patch_2004.csv", header=TRUE, sep=",")


Porter_Patch_2004_donut_plot_rounded <- Porter_Patch_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2004_donut_plot_test <- cbind(Porter_Patch_2004_donut_plot_rounded,Legend)


Porter_Patch_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2004.png", width = 6, height = 6)




Porter_Patch_2005 <- filter(Porter_Patch_plot, Year == 2005)
Porter_Patch_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2005_t <- t(Porter_Patch_2005)

Porter_Patch_2005_donut <- data.frame(Porter_Patch_2005_t)
colnames(Porter_Patch_2005_donut) <- c("Value")
Porter_Patch_2005_donut <- Porter_Patch_2005_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2005_donut,"Porter_Patch_2005.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2005_donut_plot <- read.table("Porter_Patch_2005.csv", header=TRUE, sep=",")


Porter_Patch_2005_donut_plot_rounded <- Porter_Patch_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2005_donut_plot_test <- cbind(Porter_Patch_2005_donut_plot_rounded,Legend)


Porter_Patch_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Porter_Patch_2005.png", width = 6, height = 6)





Porter_Patch_2006 <- filter(Porter_Patch_plot, Year == 2006)
Porter_Patch_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2006_t <- t(Porter_Patch_2006)

Porter_Patch_2006_donut <- data.frame(Porter_Patch_2006_t)
colnames(Porter_Patch_2006_donut) <- c("Value")
Porter_Patch_2006_donut <- Porter_Patch_2006_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2006_donut,"Porter_Patch_2006.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2006_donut_plot <- read.table("Porter_Patch_2006.csv", header=TRUE, sep=",")


Porter_Patch_2006_donut_plot_rounded <- Porter_Patch_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2006_donut_plot_test <- cbind(Porter_Patch_2006_donut_plot_rounded,Legend)


Porter_Patch_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Porter_Patch_2006.png", width = 6, height = 6)




Porter_Patch_2007 <- filter(Porter_Patch_plot, Year == 2007)
Porter_Patch_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2007_t <- t(Porter_Patch_2007)

Porter_Patch_2007_donut <- data.frame(Porter_Patch_2007_t)
colnames(Porter_Patch_2007_donut) <- c("Value")
Porter_Patch_2007_donut <- Porter_Patch_2007_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2007_donut,"Porter_Patch_2007.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2007_donut_plot <- read.table("Porter_Patch_2007.csv", header=TRUE, sep=",")


Porter_Patch_2007_donut_plot_rounded <- Porter_Patch_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2007_donut_plot_test <- cbind(Porter_Patch_2007_donut_plot_rounded,Legend)


Porter_Patch_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2007.png", width = 6, height = 6)




Porter_Patch_2008 <- filter(Porter_Patch_plot, Year == 2008)
Porter_Patch_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2008_t <- t(Porter_Patch_2008)

Porter_Patch_2008_donut <- data.frame(Porter_Patch_2008_t)
colnames(Porter_Patch_2008_donut) <- c("Value")
Porter_Patch_2008_donut <- Porter_Patch_2008_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2008_donut,"Porter_Patch_2008.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2008_donut_plot <- read.table("Porter_Patch_2008.csv", header=TRUE, sep=",")


Porter_Patch_2008_donut_plot_rounded <- Porter_Patch_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2008_donut_plot_test <- cbind(Porter_Patch_2008_donut_plot_rounded,Legend)


Porter_Patch_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2008.png", width = 6, height = 6)




Porter_Patch_2009 <- filter(Porter_Patch_plot, Year == 2009)
Porter_Patch_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2009_t <- t(Porter_Patch_2009)

Porter_Patch_2009_donut <- data.frame(Porter_Patch_2009_t)
colnames(Porter_Patch_2009_donut) <- c("Value")
Porter_Patch_2009_donut <- Porter_Patch_2009_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2009_donut,"Porter_Patch_2009.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2009_donut_plot <- read.table("Porter_Patch_2009.csv", header=TRUE, sep=",")


Porter_Patch_2009_donut_plot_rounded <- Porter_Patch_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2009_donut_plot_test <- cbind(Porter_Patch_2009_donut_plot_rounded,Legend)


Porter_Patch_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Porter_Patch_2009.png", width = 6, height = 6)




Porter_Patch_2010 <- filter(Porter_Patch_plot, Year == 2010)
Porter_Patch_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2010_t <- t(Porter_Patch_2010)

Porter_Patch_2010_donut <- data.frame(Porter_Patch_2010_t)
colnames(Porter_Patch_2010_donut) <- c("Value")
Porter_Patch_2010_donut <- Porter_Patch_2010_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2010_donut,"Porter_Patch_2010.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2010_donut_plot <- read.table("Porter_Patch_2010.csv", header=TRUE, sep=",")


Porter_Patch_2010_donut_plot_rounded <- Porter_Patch_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2010_donut_plot_test <- cbind(Porter_Patch_2010_donut_plot_rounded,Legend)


Porter_Patch_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2010.png", width = 6, height = 6)




Porter_Patch_2011 <- filter(Porter_Patch_plot, Year == 2011)
Porter_Patch_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2011_t <- t(Porter_Patch_2011)

Porter_Patch_2011_donut <- data.frame(Porter_Patch_2011_t)
colnames(Porter_Patch_2011_donut) <- c("Value")
Porter_Patch_2011_donut <- Porter_Patch_2011_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2011_donut,"Porter_Patch_2011.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2011_donut_plot <- read.table("Porter_Patch_2011.csv", header=TRUE, sep=",")


Porter_Patch_2011_donut_plot_rounded <- Porter_Patch_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2011_donut_plot_test <- cbind(Porter_Patch_2011_donut_plot_rounded,Legend)


Porter_Patch_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2011.png", width = 6, height = 6)





Porter_Patch_2012 <- filter(Porter_Patch_plot, Year == 2012)
Porter_Patch_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2012_t <- t(Porter_Patch_2012)

Porter_Patch_2012_donut <- data.frame(Porter_Patch_2012_t)
colnames(Porter_Patch_2012_donut) <- c("Value")
Porter_Patch_2012_donut <- Porter_Patch_2012_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2012_donut,"Porter_Patch_2012.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2012_donut_plot <- read.table("Porter_Patch_2012.csv", header=TRUE, sep=",")


Porter_Patch_2012_donut_plot_rounded <- Porter_Patch_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2012_donut_plot_test <- cbind(Porter_Patch_2012_donut_plot_rounded,Legend)


Porter_Patch_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Porter_Patch_2012.png", width = 6, height = 6)






Porter_Patch_2014 <- filter(Porter_Patch_plot, Year == 2014)
Porter_Patch_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2014_t <- t(Porter_Patch_2014)

Porter_Patch_2014_donut <- data.frame(Porter_Patch_2014_t)
colnames(Porter_Patch_2014_donut) <- c("Value")
Porter_Patch_2014_donut <- Porter_Patch_2014_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2014_donut,"Porter_Patch_2014.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2014_donut_plot <- read.table("Porter_Patch_2014.csv", header=TRUE, sep=",")


Porter_Patch_2014_donut_plot_rounded <- Porter_Patch_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2014_donut_plot_test <- cbind(Porter_Patch_2014_donut_plot_rounded,Legend)


Porter_Patch_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Porter_Patch_2014.png", width = 6, height = 6)





Porter_Patch_2016 <- filter(Porter_Patch_plot, Year == 2016)
Porter_Patch_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Porter_Patch_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2016_t <- t(Porter_Patch_2016)

Porter_Patch_2016_donut <- data.frame(Porter_Patch_2016_t)
colnames(Porter_Patch_2016_donut) <- c("Value")
Porter_Patch_2016_donut <- Porter_Patch_2016_donut %>%
  rownames_to_column(var = "Category")


export(Porter_Patch_2016_donut,"Porter_Patch_2016.csv")


### import as csv (change category and value to the two column names)

Porter_Patch_2016_donut_plot <- read.table("Porter_Patch_2016.csv", header=TRUE, sep=",")


Porter_Patch_2016_donut_plot_rounded <- Porter_Patch_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Porter_Patch_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Porter_Patch_2016_donut_plot_test <- cbind(Porter_Patch_2016_donut_plot_rounded,Legend)


Porter_Patch_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Porter Patch 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Porter_Patch_2016.png", width = 6, height = 6)





Turtle <- filter(RVC_CREMP, sitename == "Turtle")

## Make percentages of sum, stony coral cover, and macroalgae

Turtle_fish <- Turtle$sum/max(Turtle$sum)
Turtle_biomass <- data.frame(Turtle_fish)

Turtle_biomass <- 100*Turtle_biomass


Turtle_Stony <- Turtle$Stony_coral/max(Turtle$Stony_coral)
Turtle_coral <- data.frame(Turtle_Stony)

Turtle_stony_coral <- 100*Turtle_coral

Turtle_macro <- Turtle$Macroalgae/max(Turtle$Macroalgae)
Turtle_algae <- data.frame(Turtle_macro)


Turtle_macroalgae <- (100*Turtle_algae)


Turtle_plot <- cbind(Turtle_macroalgae,Turtle_biomass,Turtle_stony_coral)

Turtle_plot$Year <- c("1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2014")

### Filter per year

Turtle_1999 <- filter(Turtle_plot, Year == 1999)
Turtle_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_1999_t <- t(Turtle_1999)

Turtle_1999_donut <- data.frame(Turtle_1999_t)
colnames(Turtle_1999_donut) <- c("Value")
Turtle_1999_donut <- Turtle_1999_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_1999_donut,"Turtle_1999.csv")


### import as csv (change category and value to the two column names)

Turtle_1999_donut_plot <- read.table("Turtle_1999.csv", header=TRUE, sep=",")


Turtle_1999_donut_plot_rounded <- Turtle_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_1999_donut_plot_test <- cbind(Turtle_1999_donut_plot_rounded,Legend)


Turtle_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Turtle_1999.png", width = 6, height = 6)



### Turtle


Turtle_2000 <- filter(Turtle_plot, Year == 2000)
Turtle_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2000_t <- t(Turtle_2000)

Turtle_2000_donut <- data.frame(Turtle_2000_t)
colnames(Turtle_2000_donut) <- c("Value")
Turtle_2000_donut <- Turtle_2000_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2000_donut,"Turtle_2000.csv")


### import as csv (change category and value to the two column names)

Turtle_2000_donut_plot <- read.table("Turtle_2000.csv", header=TRUE, sep=",")


Turtle_2000_donut_plot_rounded <- Turtle_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2000_donut_plot_test <- cbind(Turtle_2000_donut_plot_rounded,Legend)


Turtle_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Turtle_2000.png", width = 6, height = 6)




Turtle_2001 <- filter(Turtle_plot, Year == 2001)
Turtle_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2001_t <- t(Turtle_2001)

Turtle_2001_donut <- data.frame(Turtle_2001_t)
colnames(Turtle_2001_donut) <- c("Value")
Turtle_2001_donut <- Turtle_2001_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2001_donut,"Turtle_2001.csv")


### import as csv (change category and value to the two column names)

Turtle_2001_donut_plot <- read.table("Turtle_2001.csv", header=TRUE, sep=",")


Turtle_2001_donut_plot_rounded <- Turtle_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2001_donut_plot_test <- cbind(Turtle_2001_donut_plot_rounded,Legend)


Turtle_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Turtle_2001.png", width = 6, height = 6)





Turtle_2002 <- filter(Turtle_plot, Year == 2002)
Turtle_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2002_t <- t(Turtle_2002)

Turtle_2002_donut <- data.frame(Turtle_2002_t)
colnames(Turtle_2002_donut) <- c("Value")
Turtle_2002_donut <- Turtle_2002_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2002_donut,"Turtle_2002.csv")


### import as csv (change category and value to the two column names)

Turtle_2002_donut_plot <- read.table("Turtle_2002.csv", header=TRUE, sep=",")


Turtle_2002_donut_plot_rounded <- Turtle_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2002_donut_plot_test <- cbind(Turtle_2002_donut_plot_rounded,Legend)


Turtle_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Turtle_2002.png", width = 6, height = 6)



Turtle_2003 <- filter(Turtle_plot, Year == 2003)
Turtle_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2003_t <- t(Turtle_2003)

Turtle_2003_donut <- data.frame(Turtle_2003_t)
colnames(Turtle_2003_donut) <- c("Value")
Turtle_2003_donut <- Turtle_2003_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2003_donut,"Turtle_2003.csv")


### import as csv (change category and value to the two column names)

Turtle_2003_donut_plot <- read.table("Turtle_2003.csv", header=TRUE, sep=",")


Turtle_2003_donut_plot_rounded <- Turtle_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2003_donut_plot_test <- cbind(Turtle_2003_donut_plot_rounded,Legend)


Turtle_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Turtle_2003.png", width = 6, height = 6)




Turtle_2004 <- filter(Turtle_plot, Year == 2004)
Turtle_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2004_t <- t(Turtle_2004)

Turtle_2004_donut <- data.frame(Turtle_2004_t)
colnames(Turtle_2004_donut) <- c("Value")
Turtle_2004_donut <- Turtle_2004_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2004_donut,"Turtle_2004.csv")


### import as csv (change category and value to the two column names)

Turtle_2004_donut_plot <- read.table("Turtle_2004.csv", header=TRUE, sep=",")


Turtle_2004_donut_plot_rounded <- Turtle_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2004_donut_plot_test <- cbind(Turtle_2004_donut_plot_rounded,Legend)


Turtle_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Turtle_2004.png", width = 6, height = 6)




Turtle_2005 <- filter(Turtle_plot, Year == 2005)
Turtle_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2005_t <- t(Turtle_2005)

Turtle_2005_donut <- data.frame(Turtle_2005_t)
colnames(Turtle_2005_donut) <- c("Value")
Turtle_2005_donut <- Turtle_2005_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2005_donut,"Turtle_2005.csv")


### import as csv (change category and value to the two column names)

Turtle_2005_donut_plot <- read.table("Turtle_2005.csv", header=TRUE, sep=",")


Turtle_2005_donut_plot_rounded <- Turtle_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2005_donut_plot_test <- cbind(Turtle_2005_donut_plot_rounded,Legend)


Turtle_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Turtle_2005.png", width = 6, height = 6)





Turtle_2006 <- filter(Turtle_plot, Year == 2006)
Turtle_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2006_t <- t(Turtle_2006)

Turtle_2006_donut <- data.frame(Turtle_2006_t)
colnames(Turtle_2006_donut) <- c("Value")
Turtle_2006_donut <- Turtle_2006_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2006_donut,"Turtle_2006.csv")


### import as csv (change category and value to the two column names)

Turtle_2006_donut_plot <- read.table("Turtle_2006.csv", header=TRUE, sep=",")


Turtle_2006_donut_plot_rounded <- Turtle_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2006_donut_plot_test <- cbind(Turtle_2006_donut_plot_rounded,Legend)


Turtle_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Turtle_2006.png", width = 6, height = 6)




Turtle_2007 <- filter(Turtle_plot, Year == 2007)
Turtle_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2007_t <- t(Turtle_2007)

Turtle_2007_donut <- data.frame(Turtle_2007_t)
colnames(Turtle_2007_donut) <- c("Value")
Turtle_2007_donut <- Turtle_2007_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2007_donut,"Turtle_2007.csv")


### import as csv (change category and value to the two column names)

Turtle_2007_donut_plot <- read.table("Turtle_2007.csv", header=TRUE, sep=",")


Turtle_2007_donut_plot_rounded <- Turtle_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2007_donut_plot_test <- cbind(Turtle_2007_donut_plot_rounded,Legend)


Turtle_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Turtle_2007.png", width = 6, height = 6)




Turtle_2008 <- filter(Turtle_plot, Year == 2008)
Turtle_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2008_t <- t(Turtle_2008)

Turtle_2008_donut <- data.frame(Turtle_2008_t)
colnames(Turtle_2008_donut) <- c("Value")
Turtle_2008_donut <- Turtle_2008_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2008_donut,"Turtle_2008.csv")


### import as csv (change category and value to the two column names)

Turtle_2008_donut_plot <- read.table("Turtle_2008.csv", header=TRUE, sep=",")


Turtle_2008_donut_plot_rounded <- Turtle_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2008_donut_plot_test <- cbind(Turtle_2008_donut_plot_rounded,Legend)


Turtle_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Turtle_2008.png", width = 6, height = 6)




Turtle_2009 <- filter(Turtle_plot, Year == 2009)
Turtle_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2009_t <- t(Turtle_2009)

Turtle_2009_donut <- data.frame(Turtle_2009_t)
colnames(Turtle_2009_donut) <- c("Value")
Turtle_2009_donut <- Turtle_2009_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2009_donut,"Turtle_2009.csv")


### import as csv (change category and value to the two column names)

Turtle_2009_donut_plot <- read.table("Turtle_2009.csv", header=TRUE, sep=",")


Turtle_2009_donut_plot_rounded <- Turtle_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2009_donut_plot_test <- cbind(Turtle_2009_donut_plot_rounded,Legend)


Turtle_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Turtle_2009.png", width = 6, height = 6)




Turtle_2010 <- filter(Turtle_plot, Year == 2010)
Turtle_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2010_t <- t(Turtle_2010)

Turtle_2010_donut <- data.frame(Turtle_2010_t)
colnames(Turtle_2010_donut) <- c("Value")
Turtle_2010_donut <- Turtle_2010_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2010_donut,"Turtle_2010.csv")


### import as csv (change category and value to the two column names)

Turtle_2010_donut_plot <- read.table("Turtle_2010.csv", header=TRUE, sep=",")


Turtle_2010_donut_plot_rounded <- Turtle_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2010_donut_plot_test <- cbind(Turtle_2010_donut_plot_rounded,Legend)


Turtle_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Turtle_2010.png", width = 6, height = 6)




Turtle_2011 <- filter(Turtle_plot, Year == 2011)
Turtle_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2011_t <- t(Turtle_2011)

Turtle_2011_donut <- data.frame(Turtle_2011_t)
colnames(Turtle_2011_donut) <- c("Value")
Turtle_2011_donut <- Turtle_2011_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2011_donut,"Turtle_2011.csv")


### import as csv (change category and value to the two column names)

Turtle_2011_donut_plot <- read.table("Turtle_2011.csv", header=TRUE, sep=",")


Turtle_2011_donut_plot_rounded <- Turtle_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2011_donut_plot_test <- cbind(Turtle_2011_donut_plot_rounded,Legend)


Turtle_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Turtle_2011.png", width = 6, height = 6)





Turtle_2012 <- filter(Turtle_plot, Year == 2012)
Turtle_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2012_t <- t(Turtle_2012)

Turtle_2012_donut <- data.frame(Turtle_2012_t)
colnames(Turtle_2012_donut) <- c("Value")
Turtle_2012_donut <- Turtle_2012_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2012_donut,"Turtle_2012.csv")


### import as csv (change category and value to the two column names)

Turtle_2012_donut_plot <- read.table("Turtle_2012.csv", header=TRUE, sep=",")


Turtle_2012_donut_plot_rounded <- Turtle_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2012_donut_plot_test <- cbind(Turtle_2012_donut_plot_rounded,Legend)


Turtle_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Turtle_2012.png", width = 6, height = 6)






Turtle_2014 <- filter(Turtle_plot, Year == 2014)
Turtle_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2014_t <- t(Turtle_2014)

Turtle_2014_donut <- data.frame(Turtle_2014_t)
colnames(Turtle_2014_donut) <- c("Value")
Turtle_2014_donut <- Turtle_2014_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2014_donut,"Turtle_2014.csv")


### import as csv (change category and value to the two column names)

Turtle_2014_donut_plot <- read.table("Turtle_2014.csv", header=TRUE, sep=",")


Turtle_2014_donut_plot_rounded <- Turtle_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2014_donut_plot_test <- cbind(Turtle_2014_donut_plot_rounded,Legend)


Turtle_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Turtle_2014.png", width = 6, height = 6)





Turtle_2016 <- filter(Turtle_plot, Year == 2016)
Turtle_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Turtle_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2016_t <- t(Turtle_2016)

Turtle_2016_donut <- data.frame(Turtle_2016_t)
colnames(Turtle_2016_donut) <- c("Value")
Turtle_2016_donut <- Turtle_2016_donut %>%
  rownames_to_column(var = "Category")


export(Turtle_2016_donut,"Turtle_2016.csv")


### import as csv (change category and value to the two column names)

Turtle_2016_donut_plot <- read.table("Turtle_2016.csv", header=TRUE, sep=",")


Turtle_2016_donut_plot_rounded <- Turtle_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Turtle_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Turtle_2016_donut_plot_test <- cbind(Turtle_2016_donut_plot_rounded,Legend)


Turtle_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Turtle 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Turtle_2016.png", width = 6, height = 6)



setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/UK/plots")


library(gridExtra)
library(png)
library(grid)

pdf('UK.pdf')
lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  grid.newpage()
  grid.raster(img, interpolate = FALSE)
  
})
dev.off()

plots <- lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  rasterGrob(img, interpolate = FALSE)
})

ggsave("UK_combined.pdf", marrangeGrob(grobs=plots, nrow=2, ncol=4))








### Dry Tortugas


setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/DT")




Bird_Key_Reef <- filter(RVC_CREMP, sitename == "Bird Key Reef")

## Make percentages of sum, stony coral cover, and macroalgae

Bird_Key_Reef_fish <- Bird_Key_Reef$sum/max(Bird_Key_Reef$sum)
Bird_Key_Reef_biomass <- data.frame(Bird_Key_Reef_fish)

Bird_Key_Reef_biomass <- 100*Bird_Key_Reef_biomass


Bird_Key_Reef_Stony <- Bird_Key_Reef$Stony_coral/max(Bird_Key_Reef$Stony_coral)
Bird_Key_Reef_coral <- data.frame(Bird_Key_Reef_Stony)

Bird_Key_Reef_stony_coral <- 100*Bird_Key_Reef_coral

Bird_Key_Reef_macro <- Bird_Key_Reef$Macroalgae/max(Bird_Key_Reef$Macroalgae)
Bird_Key_Reef_algae <- data.frame(Bird_Key_Reef_macro)


Bird_Key_Reef_macroalgae <- (100*Bird_Key_Reef_algae)


Bird_Key_Reef_plot <- cbind(Bird_Key_Reef_macroalgae,Bird_Key_Reef_biomass,Bird_Key_Reef_stony_coral)

Bird_Key_Reef_plot$Year <- c("1999","2000","2004","2006","2008","2010","2012","2014","2016")

### Filter per year

Bird_Key_Reef_1999 <- filter(Bird_Key_Reef_plot, Year == 1999)
Bird_Key_Reef_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_1999_t <- t(Bird_Key_Reef_1999)

Bird_Key_Reef_1999_donut <- data.frame(Bird_Key_Reef_1999_t)
colnames(Bird_Key_Reef_1999_donut) <- c("Value")
Bird_Key_Reef_1999_donut <- Bird_Key_Reef_1999_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_1999_donut,"Bird_Key_Reef_1999.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_1999_donut_plot <- read.table("Bird_Key_Reef_1999.csv", header=TRUE, sep=",")


Bird_Key_Reef_1999_donut_plot_rounded <- Bird_Key_Reef_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_1999_donut_plot_test <- cbind(Bird_Key_Reef_1999_donut_plot_rounded,Legend)


Bird_Key_Reef_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_1999.png", width = 6, height = 6)



### Bird Key Reef


Bird_Key_Reef_2000 <- filter(Bird_Key_Reef_plot, Year == 2000)
Bird_Key_Reef_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2000_t <- t(Bird_Key_Reef_2000)

Bird_Key_Reef_2000_donut <- data.frame(Bird_Key_Reef_2000_t)
colnames(Bird_Key_Reef_2000_donut) <- c("Value")
Bird_Key_Reef_2000_donut <- Bird_Key_Reef_2000_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2000_donut,"Bird_Key_Reef_2000.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2000_donut_plot <- read.table("Bird_Key_Reef_2000.csv", header=TRUE, sep=",")


Bird_Key_Reef_2000_donut_plot_rounded <- Bird_Key_Reef_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2000_donut_plot_test <- cbind(Bird_Key_Reef_2000_donut_plot_rounded,Legend)


Bird_Key_Reef_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2000.png", width = 6, height = 6)




Bird_Key_Reef_2001 <- filter(Bird_Key_Reef_plot, Year == 2001)
Bird_Key_Reef_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2001_t <- t(Bird_Key_Reef_2001)

Bird_Key_Reef_2001_donut <- data.frame(Bird_Key_Reef_2001_t)
colnames(Bird_Key_Reef_2001_donut) <- c("Value")
Bird_Key_Reef_2001_donut <- Bird_Key_Reef_2001_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2001_donut,"Bird_Key_Reef_2001.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2001_donut_plot <- read.table("Bird_Key_Reef_2001.csv", header=TRUE, sep=",")


Bird_Key_Reef_2001_donut_plot_rounded <- Bird_Key_Reef_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2001_donut_plot_test <- cbind(Bird_Key_Reef_2001_donut_plot_rounded,Legend)


Bird_Key_Reef_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2001.png", width = 6, height = 6)





Bird_Key_Reef_2002 <- filter(Bird_Key_Reef_plot, Year == 2002)
Bird_Key_Reef_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2002_t <- t(Bird_Key_Reef_2002)

Bird_Key_Reef_2002_donut <- data.frame(Bird_Key_Reef_2002_t)
colnames(Bird_Key_Reef_2002_donut) <- c("Value")
Bird_Key_Reef_2002_donut <- Bird_Key_Reef_2002_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2002_donut,"Bird_Key_Reef_2002.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2002_donut_plot <- read.table("Bird_Key_Reef_2002.csv", header=TRUE, sep=",")


Bird_Key_Reef_2002_donut_plot_rounded <- Bird_Key_Reef_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2002_donut_plot_test <- cbind(Bird_Key_Reef_2002_donut_plot_rounded,Legend)


Bird_Key_Reef_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2002.png", width = 6, height = 6)



Bird_Key_Reef_2003 <- filter(Bird_Key_Reef_plot, Year == 2003)
Bird_Key_Reef_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2003_t <- t(Bird_Key_Reef_2003)

Bird_Key_Reef_2003_donut <- data.frame(Bird_Key_Reef_2003_t)
colnames(Bird_Key_Reef_2003_donut) <- c("Value")
Bird_Key_Reef_2003_donut <- Bird_Key_Reef_2003_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2003_donut,"Bird_Key_Reef_2003.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2003_donut_plot <- read.table("Bird_Key_Reef_2003.csv", header=TRUE, sep=",")


Bird_Key_Reef_2003_donut_plot_rounded <- Bird_Key_Reef_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2003_donut_plot_test <- cbind(Bird_Key_Reef_2003_donut_plot_rounded,Legend)


Bird_Key_Reef_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2003.png", width = 6, height = 6)




Bird_Key_Reef_2004 <- filter(Bird_Key_Reef_plot, Year == 2004)
Bird_Key_Reef_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2004_t <- t(Bird_Key_Reef_2004)

Bird_Key_Reef_2004_donut <- data.frame(Bird_Key_Reef_2004_t)
colnames(Bird_Key_Reef_2004_donut) <- c("Value")
Bird_Key_Reef_2004_donut <- Bird_Key_Reef_2004_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2004_donut,"Bird_Key_Reef_2004.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2004_donut_plot <- read.table("Bird_Key_Reef_2004.csv", header=TRUE, sep=",")


Bird_Key_Reef_2004_donut_plot_rounded <- Bird_Key_Reef_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2004_donut_plot_test <- cbind(Bird_Key_Reef_2004_donut_plot_rounded,Legend)


Bird_Key_Reef_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2004.png", width = 6, height = 6)




Bird_Key_Reef_2005 <- filter(Bird_Key_Reef_plot, Year == 2005)
Bird_Key_Reef_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2005_t <- t(Bird_Key_Reef_2005)

Bird_Key_Reef_2005_donut <- data.frame(Bird_Key_Reef_2005_t)
colnames(Bird_Key_Reef_2005_donut) <- c("Value")
Bird_Key_Reef_2005_donut <- Bird_Key_Reef_2005_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2005_donut,"Bird_Key_Reef_2005.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2005_donut_plot <- read.table("Bird_Key_Reef_2005.csv", header=TRUE, sep=",")


Bird_Key_Reef_2005_donut_plot_rounded <- Bird_Key_Reef_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2005_donut_plot_test <- cbind(Bird_Key_Reef_2005_donut_plot_rounded,Legend)


Bird_Key_Reef_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2005.png", width = 6, height = 6)





Bird_Key_Reef_2006 <- filter(Bird_Key_Reef_plot, Year == 2006)
Bird_Key_Reef_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2006_t <- t(Bird_Key_Reef_2006)

Bird_Key_Reef_2006_donut <- data.frame(Bird_Key_Reef_2006_t)
colnames(Bird_Key_Reef_2006_donut) <- c("Value")
Bird_Key_Reef_2006_donut <- Bird_Key_Reef_2006_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2006_donut,"Bird_Key_Reef_2006.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2006_donut_plot <- read.table("Bird_Key_Reef_2006.csv", header=TRUE, sep=",")


Bird_Key_Reef_2006_donut_plot_rounded <- Bird_Key_Reef_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2006_donut_plot_test <- cbind(Bird_Key_Reef_2006_donut_plot_rounded,Legend)


Bird_Key_Reef_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2006.png", width = 6, height = 6)




Bird_Key_Reef_2007 <- filter(Bird_Key_Reef_plot, Year == 2007)
Bird_Key_Reef_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2007_t <- t(Bird_Key_Reef_2007)

Bird_Key_Reef_2007_donut <- data.frame(Bird_Key_Reef_2007_t)
colnames(Bird_Key_Reef_2007_donut) <- c("Value")
Bird_Key_Reef_2007_donut <- Bird_Key_Reef_2007_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2007_donut,"Bird_Key_Reef_2007.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2007_donut_plot <- read.table("Bird_Key_Reef_2007.csv", header=TRUE, sep=",")


Bird_Key_Reef_2007_donut_plot_rounded <- Bird_Key_Reef_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2007_donut_plot_test <- cbind(Bird_Key_Reef_2007_donut_plot_rounded,Legend)


Bird_Key_Reef_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2007.png", width = 6, height = 6)




Bird_Key_Reef_2008 <- filter(Bird_Key_Reef_plot, Year == 2008)
Bird_Key_Reef_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2008_t <- t(Bird_Key_Reef_2008)

Bird_Key_Reef_2008_donut <- data.frame(Bird_Key_Reef_2008_t)
colnames(Bird_Key_Reef_2008_donut) <- c("Value")
Bird_Key_Reef_2008_donut <- Bird_Key_Reef_2008_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2008_donut,"Bird_Key_Reef_2008.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2008_donut_plot <- read.table("Bird_Key_Reef_2008.csv", header=TRUE, sep=",")


Bird_Key_Reef_2008_donut_plot_rounded <- Bird_Key_Reef_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2008_donut_plot_test <- cbind(Bird_Key_Reef_2008_donut_plot_rounded,Legend)


Bird_Key_Reef_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2008.png", width = 6, height = 6)




Bird_Key_Reef_2009 <- filter(Bird_Key_Reef_plot, Year == 2009)
Bird_Key_Reef_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2009_t <- t(Bird_Key_Reef_2009)

Bird_Key_Reef_2009_donut <- data.frame(Bird_Key_Reef_2009_t)
colnames(Bird_Key_Reef_2009_donut) <- c("Value")
Bird_Key_Reef_2009_donut <- Bird_Key_Reef_2009_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2009_donut,"Bird_Key_Reef_2009.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2009_donut_plot <- read.table("Bird_Key_Reef_2009.csv", header=TRUE, sep=",")


Bird_Key_Reef_2009_donut_plot_rounded <- Bird_Key_Reef_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2009_donut_plot_test <- cbind(Bird_Key_Reef_2009_donut_plot_rounded,Legend)


Bird_Key_Reef_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2009.png", width = 6, height = 6)




Bird_Key_Reef_2010 <- filter(Bird_Key_Reef_plot, Year == 2010)
Bird_Key_Reef_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2010_t <- t(Bird_Key_Reef_2010)

Bird_Key_Reef_2010_donut <- data.frame(Bird_Key_Reef_2010_t)
colnames(Bird_Key_Reef_2010_donut) <- c("Value")
Bird_Key_Reef_2010_donut <- Bird_Key_Reef_2010_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2010_donut,"Bird_Key_Reef_2010.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2010_donut_plot <- read.table("Bird_Key_Reef_2010.csv", header=TRUE, sep=",")


Bird_Key_Reef_2010_donut_plot_rounded <- Bird_Key_Reef_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2010_donut_plot_test <- cbind(Bird_Key_Reef_2010_donut_plot_rounded,Legend)


Bird_Key_Reef_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2010.png", width = 6, height = 6)




Bird_Key_Reef_2011 <- filter(Bird_Key_Reef_plot, Year == 2011)
Bird_Key_Reef_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2011_t <- t(Bird_Key_Reef_2011)

Bird_Key_Reef_2011_donut <- data.frame(Bird_Key_Reef_2011_t)
colnames(Bird_Key_Reef_2011_donut) <- c("Value")
Bird_Key_Reef_2011_donut <- Bird_Key_Reef_2011_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2011_donut,"Bird_Key_Reef_2011.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2011_donut_plot <- read.table("Bird_Key_Reef_2011.csv", header=TRUE, sep=",")


Bird_Key_Reef_2011_donut_plot_rounded <- Bird_Key_Reef_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2011_donut_plot_test <- cbind(Bird_Key_Reef_2011_donut_plot_rounded,Legend)


Bird_Key_Reef_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2011.png", width = 6, height = 6)





Bird_Key_Reef_2012 <- filter(Bird_Key_Reef_plot, Year == 2012)
Bird_Key_Reef_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2012_t <- t(Bird_Key_Reef_2012)

Bird_Key_Reef_2012_donut <- data.frame(Bird_Key_Reef_2012_t)
colnames(Bird_Key_Reef_2012_donut) <- c("Value")
Bird_Key_Reef_2012_donut <- Bird_Key_Reef_2012_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2012_donut,"Bird_Key_Reef_2012.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2012_donut_plot <- read.table("Bird_Key_Reef_2012.csv", header=TRUE, sep=",")


Bird_Key_Reef_2012_donut_plot_rounded <- Bird_Key_Reef_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2012_donut_plot_test <- cbind(Bird_Key_Reef_2012_donut_plot_rounded,Legend)


Bird_Key_Reef_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2012.png", width = 6, height = 6)






Bird_Key_Reef_2014 <- filter(Bird_Key_Reef_plot, Year == 2014)
Bird_Key_Reef_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2014_t <- t(Bird_Key_Reef_2014)

Bird_Key_Reef_2014_donut <- data.frame(Bird_Key_Reef_2014_t)
colnames(Bird_Key_Reef_2014_donut) <- c("Value")
Bird_Key_Reef_2014_donut <- Bird_Key_Reef_2014_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2014_donut,"Bird_Key_Reef_2014.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2014_donut_plot <- read.table("Bird_Key_Reef_2014.csv", header=TRUE, sep=",")


Bird_Key_Reef_2014_donut_plot_rounded <- Bird_Key_Reef_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2014_donut_plot_test <- cbind(Bird_Key_Reef_2014_donut_plot_rounded,Legend)


Bird_Key_Reef_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2014.png", width = 6, height = 6)





Bird_Key_Reef_2016 <- filter(Bird_Key_Reef_plot, Year == 2016)
Bird_Key_Reef_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2016_t <- t(Bird_Key_Reef_2016)

Bird_Key_Reef_2016_donut <- data.frame(Bird_Key_Reef_2016_t)
colnames(Bird_Key_Reef_2016_donut) <- c("Value")
Bird_Key_Reef_2016_donut <- Bird_Key_Reef_2016_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2016_donut,"Bird_Key_Reef_2016.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2016_donut_plot <- read.table("Bird_Key_Reef_2016.csv", header=TRUE, sep=",")


Bird_Key_Reef_2016_donut_plot_rounded <- Bird_Key_Reef_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2016_donut_plot_test <- cbind(Bird_Key_Reef_2016_donut_plot_rounded,Legend)


Bird_Key_Reef_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2016.png", width = 6, height = 6)




Bird_Key_Reef <- filter(RVC_CREMP, sitename == "Bird Key Reef")

## Make percentages of sum, stony coral cover, and macroalgae

Bird_Key_Reef_fish <- Bird_Key_Reef$sum/max(Bird_Key_Reef$sum)
Bird_Key_Reef_biomass <- data.frame(Bird_Key_Reef_fish)

Bird_Key_Reef_biomass <- 100*Bird_Key_Reef_biomass


Bird_Key_Reef_Stony <- Bird_Key_Reef$Stony_coral/max(Bird_Key_Reef$Stony_coral)
Bird_Key_Reef_coral <- data.frame(Bird_Key_Reef_Stony)

Bird_Key_Reef_stony_coral <- 100*Bird_Key_Reef_coral

Bird_Key_Reef_macro <- Bird_Key_Reef$Macroalgae/max(Bird_Key_Reef$Macroalgae)
Bird_Key_Reef_algae <- data.frame(Bird_Key_Reef_macro)


Bird_Key_Reef_macroalgae <- (100*Bird_Key_Reef_algae)


Bird_Key_Reef_plot <- cbind(Bird_Key_Reef_macroalgae,Bird_Key_Reef_biomass,Bird_Key_Reef_stony_coral)

Bird_Key_Reef_plot$Year <- c("1999","2000","2004","2006","2008","2010","2012","2014","2016")

### Filter per year

Bird_Key_Reef_1999 <- filter(Bird_Key_Reef_plot, Year == 1999)
Bird_Key_Reef_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_1999_t <- t(Bird_Key_Reef_1999)

Bird_Key_Reef_1999_donut <- data.frame(Bird_Key_Reef_1999_t)
colnames(Bird_Key_Reef_1999_donut) <- c("Value")
Bird_Key_Reef_1999_donut <- Bird_Key_Reef_1999_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_1999_donut,"Bird_Key_Reef_1999.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_1999_donut_plot <- read.table("Bird_Key_Reef_1999.csv", header=TRUE, sep=",")


Bird_Key_Reef_1999_donut_plot_rounded <- Bird_Key_Reef_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_1999_donut_plot_test <- cbind(Bird_Key_Reef_1999_donut_plot_rounded,Legend)


Bird_Key_Reef_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_1999.png", width = 6, height = 6)



### Bird Key Reef


Bird_Key_Reef_2000 <- filter(Bird_Key_Reef_plot, Year == 2000)
Bird_Key_Reef_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2000_t <- t(Bird_Key_Reef_2000)

Bird_Key_Reef_2000_donut <- data.frame(Bird_Key_Reef_2000_t)
colnames(Bird_Key_Reef_2000_donut) <- c("Value")
Bird_Key_Reef_2000_donut <- Bird_Key_Reef_2000_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2000_donut,"Bird_Key_Reef_2000.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2000_donut_plot <- read.table("Bird_Key_Reef_2000.csv", header=TRUE, sep=",")


Bird_Key_Reef_2000_donut_plot_rounded <- Bird_Key_Reef_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2000_donut_plot_test <- cbind(Bird_Key_Reef_2000_donut_plot_rounded,Legend)


Bird_Key_Reef_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2000.png", width = 6, height = 6)




Bird_Key_Reef_2001 <- filter(Bird_Key_Reef_plot, Year == 2001)
Bird_Key_Reef_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2001_t <- t(Bird_Key_Reef_2001)

Bird_Key_Reef_2001_donut <- data.frame(Bird_Key_Reef_2001_t)
colnames(Bird_Key_Reef_2001_donut) <- c("Value")
Bird_Key_Reef_2001_donut <- Bird_Key_Reef_2001_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2001_donut,"Bird_Key_Reef_2001.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2001_donut_plot <- read.table("Bird_Key_Reef_2001.csv", header=TRUE, sep=",")


Bird_Key_Reef_2001_donut_plot_rounded <- Bird_Key_Reef_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2001_donut_plot_test <- cbind(Bird_Key_Reef_2001_donut_plot_rounded,Legend)


Bird_Key_Reef_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2001.png", width = 6, height = 6)





Bird_Key_Reef_2002 <- filter(Bird_Key_Reef_plot, Year == 2002)
Bird_Key_Reef_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2002_t <- t(Bird_Key_Reef_2002)

Bird_Key_Reef_2002_donut <- data.frame(Bird_Key_Reef_2002_t)
colnames(Bird_Key_Reef_2002_donut) <- c("Value")
Bird_Key_Reef_2002_donut <- Bird_Key_Reef_2002_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2002_donut,"Bird_Key_Reef_2002.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2002_donut_plot <- read.table("Bird_Key_Reef_2002.csv", header=TRUE, sep=",")


Bird_Key_Reef_2002_donut_plot_rounded <- Bird_Key_Reef_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2002_donut_plot_test <- cbind(Bird_Key_Reef_2002_donut_plot_rounded,Legend)


Bird_Key_Reef_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2002.png", width = 6, height = 6)



Bird_Key_Reef_2003 <- filter(Bird_Key_Reef_plot, Year == 2003)
Bird_Key_Reef_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2003_t <- t(Bird_Key_Reef_2003)

Bird_Key_Reef_2003_donut <- data.frame(Bird_Key_Reef_2003_t)
colnames(Bird_Key_Reef_2003_donut) <- c("Value")
Bird_Key_Reef_2003_donut <- Bird_Key_Reef_2003_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2003_donut,"Bird_Key_Reef_2003.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2003_donut_plot <- read.table("Bird_Key_Reef_2003.csv", header=TRUE, sep=",")


Bird_Key_Reef_2003_donut_plot_rounded <- Bird_Key_Reef_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2003_donut_plot_test <- cbind(Bird_Key_Reef_2003_donut_plot_rounded,Legend)


Bird_Key_Reef_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2003.png", width = 6, height = 6)




Bird_Key_Reef_2004 <- filter(Bird_Key_Reef_plot, Year == 2004)
Bird_Key_Reef_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2004_t <- t(Bird_Key_Reef_2004)

Bird_Key_Reef_2004_donut <- data.frame(Bird_Key_Reef_2004_t)
colnames(Bird_Key_Reef_2004_donut) <- c("Value")
Bird_Key_Reef_2004_donut <- Bird_Key_Reef_2004_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2004_donut,"Bird_Key_Reef_2004.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2004_donut_plot <- read.table("Bird_Key_Reef_2004.csv", header=TRUE, sep=",")


Bird_Key_Reef_2004_donut_plot_rounded <- Bird_Key_Reef_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2004_donut_plot_test <- cbind(Bird_Key_Reef_2004_donut_plot_rounded,Legend)


Bird_Key_Reef_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2004.png", width = 6, height = 6)




Bird_Key_Reef_2005 <- filter(Bird_Key_Reef_plot, Year == 2005)
Bird_Key_Reef_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2005_t <- t(Bird_Key_Reef_2005)

Bird_Key_Reef_2005_donut <- data.frame(Bird_Key_Reef_2005_t)
colnames(Bird_Key_Reef_2005_donut) <- c("Value")
Bird_Key_Reef_2005_donut <- Bird_Key_Reef_2005_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2005_donut,"Bird_Key_Reef_2005.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2005_donut_plot <- read.table("Bird_Key_Reef_2005.csv", header=TRUE, sep=",")


Bird_Key_Reef_2005_donut_plot_rounded <- Bird_Key_Reef_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2005_donut_plot_test <- cbind(Bird_Key_Reef_2005_donut_plot_rounded,Legend)


Bird_Key_Reef_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2005.png", width = 6, height = 6)





Bird_Key_Reef_2006 <- filter(Bird_Key_Reef_plot, Year == 2006)
Bird_Key_Reef_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2006_t <- t(Bird_Key_Reef_2006)

Bird_Key_Reef_2006_donut <- data.frame(Bird_Key_Reef_2006_t)
colnames(Bird_Key_Reef_2006_donut) <- c("Value")
Bird_Key_Reef_2006_donut <- Bird_Key_Reef_2006_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2006_donut,"Bird_Key_Reef_2006.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2006_donut_plot <- read.table("Bird_Key_Reef_2006.csv", header=TRUE, sep=",")


Bird_Key_Reef_2006_donut_plot_rounded <- Bird_Key_Reef_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2006_donut_plot_test <- cbind(Bird_Key_Reef_2006_donut_plot_rounded,Legend)


Bird_Key_Reef_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2006.png", width = 6, height = 6)




Bird_Key_Reef_2007 <- filter(Bird_Key_Reef_plot, Year == 2007)
Bird_Key_Reef_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2007_t <- t(Bird_Key_Reef_2007)

Bird_Key_Reef_2007_donut <- data.frame(Bird_Key_Reef_2007_t)
colnames(Bird_Key_Reef_2007_donut) <- c("Value")
Bird_Key_Reef_2007_donut <- Bird_Key_Reef_2007_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2007_donut,"Bird_Key_Reef_2007.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2007_donut_plot <- read.table("Bird_Key_Reef_2007.csv", header=TRUE, sep=",")


Bird_Key_Reef_2007_donut_plot_rounded <- Bird_Key_Reef_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2007_donut_plot_test <- cbind(Bird_Key_Reef_2007_donut_plot_rounded,Legend)


Bird_Key_Reef_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2007.png", width = 6, height = 6)




Bird_Key_Reef_2008 <- filter(Bird_Key_Reef_plot, Year == 2008)
Bird_Key_Reef_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2008_t <- t(Bird_Key_Reef_2008)

Bird_Key_Reef_2008_donut <- data.frame(Bird_Key_Reef_2008_t)
colnames(Bird_Key_Reef_2008_donut) <- c("Value")
Bird_Key_Reef_2008_donut <- Bird_Key_Reef_2008_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2008_donut,"Bird_Key_Reef_2008.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2008_donut_plot <- read.table("Bird_Key_Reef_2008.csv", header=TRUE, sep=",")


Bird_Key_Reef_2008_donut_plot_rounded <- Bird_Key_Reef_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2008_donut_plot_test <- cbind(Bird_Key_Reef_2008_donut_plot_rounded,Legend)


Bird_Key_Reef_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2008.png", width = 6, height = 6)




Bird_Key_Reef_2009 <- filter(Bird_Key_Reef_plot, Year == 2009)
Bird_Key_Reef_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2009_t <- t(Bird_Key_Reef_2009)

Bird_Key_Reef_2009_donut <- data.frame(Bird_Key_Reef_2009_t)
colnames(Bird_Key_Reef_2009_donut) <- c("Value")
Bird_Key_Reef_2009_donut <- Bird_Key_Reef_2009_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2009_donut,"Bird_Key_Reef_2009.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2009_donut_plot <- read.table("Bird_Key_Reef_2009.csv", header=TRUE, sep=",")


Bird_Key_Reef_2009_donut_plot_rounded <- Bird_Key_Reef_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2009_donut_plot_test <- cbind(Bird_Key_Reef_2009_donut_plot_rounded,Legend)


Bird_Key_Reef_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2009.png", width = 6, height = 6)




Bird_Key_Reef_2010 <- filter(Bird_Key_Reef_plot, Year == 2010)
Bird_Key_Reef_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2010_t <- t(Bird_Key_Reef_2010)

Bird_Key_Reef_2010_donut <- data.frame(Bird_Key_Reef_2010_t)
colnames(Bird_Key_Reef_2010_donut) <- c("Value")
Bird_Key_Reef_2010_donut <- Bird_Key_Reef_2010_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2010_donut,"Bird_Key_Reef_2010.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2010_donut_plot <- read.table("Bird_Key_Reef_2010.csv", header=TRUE, sep=",")


Bird_Key_Reef_2010_donut_plot_rounded <- Bird_Key_Reef_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2010_donut_plot_test <- cbind(Bird_Key_Reef_2010_donut_plot_rounded,Legend)


Bird_Key_Reef_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2010.png", width = 6, height = 6)




Bird_Key_Reef_2011 <- filter(Bird_Key_Reef_plot, Year == 2011)
Bird_Key_Reef_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2011_t <- t(Bird_Key_Reef_2011)

Bird_Key_Reef_2011_donut <- data.frame(Bird_Key_Reef_2011_t)
colnames(Bird_Key_Reef_2011_donut) <- c("Value")
Bird_Key_Reef_2011_donut <- Bird_Key_Reef_2011_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2011_donut,"Bird_Key_Reef_2011.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2011_donut_plot <- read.table("Bird_Key_Reef_2011.csv", header=TRUE, sep=",")


Bird_Key_Reef_2011_donut_plot_rounded <- Bird_Key_Reef_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2011_donut_plot_test <- cbind(Bird_Key_Reef_2011_donut_plot_rounded,Legend)


Bird_Key_Reef_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2011.png", width = 6, height = 6)





Bird_Key_Reef_2012 <- filter(Bird_Key_Reef_plot, Year == 2012)
Bird_Key_Reef_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2012_t <- t(Bird_Key_Reef_2012)

Bird_Key_Reef_2012_donut <- data.frame(Bird_Key_Reef_2012_t)
colnames(Bird_Key_Reef_2012_donut) <- c("Value")
Bird_Key_Reef_2012_donut <- Bird_Key_Reef_2012_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2012_donut,"Bird_Key_Reef_2012.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2012_donut_plot <- read.table("Bird_Key_Reef_2012.csv", header=TRUE, sep=",")


Bird_Key_Reef_2012_donut_plot_rounded <- Bird_Key_Reef_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2012_donut_plot_test <- cbind(Bird_Key_Reef_2012_donut_plot_rounded,Legend)


Bird_Key_Reef_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2012.png", width = 6, height = 6)






Bird_Key_Reef_2014 <- filter(Bird_Key_Reef_plot, Year == 2014)
Bird_Key_Reef_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2014_t <- t(Bird_Key_Reef_2014)

Bird_Key_Reef_2014_donut <- data.frame(Bird_Key_Reef_2014_t)
colnames(Bird_Key_Reef_2014_donut) <- c("Value")
Bird_Key_Reef_2014_donut <- Bird_Key_Reef_2014_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2014_donut,"Bird_Key_Reef_2014.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2014_donut_plot <- read.table("Bird_Key_Reef_2014.csv", header=TRUE, sep=",")


Bird_Key_Reef_2014_donut_plot_rounded <- Bird_Key_Reef_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2014_donut_plot_test <- cbind(Bird_Key_Reef_2014_donut_plot_rounded,Legend)


Bird_Key_Reef_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Bird_Key_Reef_2014.png", width = 6, height = 6)





Bird_Key_Reef_2016 <- filter(Bird_Key_Reef_plot, Year == 2016)
Bird_Key_Reef_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Bird_Key_Reef_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2016_t <- t(Bird_Key_Reef_2016)

Bird_Key_Reef_2016_donut <- data.frame(Bird_Key_Reef_2016_t)
colnames(Bird_Key_Reef_2016_donut) <- c("Value")
Bird_Key_Reef_2016_donut <- Bird_Key_Reef_2016_donut %>%
  rownames_to_column(var = "Category")


export(Bird_Key_Reef_2016_donut,"Bird_Key_Reef_2016.csv")


### import as csv (change category and value to the two column names)

Bird_Key_Reef_2016_donut_plot <- read.table("Bird_Key_Reef_2016.csv", header=TRUE, sep=",")


Bird_Key_Reef_2016_donut_plot_rounded <- Bird_Key_Reef_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Bird_Key_Reef_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Bird_Key_Reef_2016_donut_plot_test <- cbind(Bird_Key_Reef_2016_donut_plot_rounded,Legend)


Bird_Key_Reef_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Bird Key Reef 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Bird_Key_Reef_2016.png", width = 6, height = 6)






Davis_Rock <- filter(RVC_CREMP, sitename == "Davis Rock")

## Make percentages of sum, stony coral cover, and macroalgae

Davis_Rock_fish <- Davis_Rock$sum/max(Davis_Rock$sum)
Davis_Rock_biomass <- data.frame(Davis_Rock_fish)

Davis_Rock_biomass <- 100*Davis_Rock_biomass


Davis_Rock_Stony <- Davis_Rock$Stony_coral/max(Davis_Rock$Stony_coral)
Davis_Rock_coral <- data.frame(Davis_Rock_Stony)

Davis_Rock_stony_coral <- 100*Davis_Rock_coral

Davis_Rock_macro <- Davis_Rock$Macroalgae/max(Davis_Rock$Macroalgae)
Davis_Rock_algae <- data.frame(Davis_Rock_macro)


Davis_Rock_macroalgae <- (100*Davis_Rock_algae)


Davis_Rock_plot <- cbind(Davis_Rock_macroalgae,Davis_Rock_biomass,Davis_Rock_stony_coral)

Davis_Rock_plot$Year <- c("2010","2014")

### Filter per year

Davis_Rock_1999 <- filter(Davis_Rock_plot, Year == 1999)
Davis_Rock_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_1999_t <- t(Davis_Rock_1999)

Davis_Rock_1999_donut <- data.frame(Davis_Rock_1999_t)
colnames(Davis_Rock_1999_donut) <- c("Value")
Davis_Rock_1999_donut <- Davis_Rock_1999_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_1999_donut,"Davis_Rock_1999.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_1999_donut_plot <- read.table("Davis_Rock_1999.csv", header=TRUE, sep=",")


Davis_Rock_1999_donut_plot_rounded <- Davis_Rock_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_1999_donut_plot_test <- cbind(Davis_Rock_1999_donut_plot_rounded,Legend)


Davis_Rock_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_1999.png", width = 6, height = 6)



### Davis Rock


Davis_Rock_2000 <- filter(Davis_Rock_plot, Year == 2000)
Davis_Rock_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2000_t <- t(Davis_Rock_2000)

Davis_Rock_2000_donut <- data.frame(Davis_Rock_2000_t)
colnames(Davis_Rock_2000_donut) <- c("Value")
Davis_Rock_2000_donut <- Davis_Rock_2000_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2000_donut,"Davis_Rock_2000.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2000_donut_plot <- read.table("Davis_Rock_2000.csv", header=TRUE, sep=",")


Davis_Rock_2000_donut_plot_rounded <- Davis_Rock_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2000_donut_plot_test <- cbind(Davis_Rock_2000_donut_plot_rounded,Legend)


Davis_Rock_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2000.png", width = 6, height = 6)




Davis_Rock_2001 <- filter(Davis_Rock_plot, Year == 2001)
Davis_Rock_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2001_t <- t(Davis_Rock_2001)

Davis_Rock_2001_donut <- data.frame(Davis_Rock_2001_t)
colnames(Davis_Rock_2001_donut) <- c("Value")
Davis_Rock_2001_donut <- Davis_Rock_2001_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2001_donut,"Davis_Rock_2001.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2001_donut_plot <- read.table("Davis_Rock_2001.csv", header=TRUE, sep=",")


Davis_Rock_2001_donut_plot_rounded <- Davis_Rock_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2001_donut_plot_test <- cbind(Davis_Rock_2001_donut_plot_rounded,Legend)


Davis_Rock_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2001.png", width = 6, height = 6)





Davis_Rock_2002 <- filter(Davis_Rock_plot, Year == 2002)
Davis_Rock_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2002_t <- t(Davis_Rock_2002)

Davis_Rock_2002_donut <- data.frame(Davis_Rock_2002_t)
colnames(Davis_Rock_2002_donut) <- c("Value")
Davis_Rock_2002_donut <- Davis_Rock_2002_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2002_donut,"Davis_Rock_2002.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2002_donut_plot <- read.table("Davis_Rock_2002.csv", header=TRUE, sep=",")


Davis_Rock_2002_donut_plot_rounded <- Davis_Rock_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2002_donut_plot_test <- cbind(Davis_Rock_2002_donut_plot_rounded,Legend)


Davis_Rock_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2002.png", width = 6, height = 6)



Davis_Rock_2003 <- filter(Davis_Rock_plot, Year == 2003)
Davis_Rock_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2003_t <- t(Davis_Rock_2003)

Davis_Rock_2003_donut <- data.frame(Davis_Rock_2003_t)
colnames(Davis_Rock_2003_donut) <- c("Value")
Davis_Rock_2003_donut <- Davis_Rock_2003_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2003_donut,"Davis_Rock_2003.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2003_donut_plot <- read.table("Davis_Rock_2003.csv", header=TRUE, sep=",")


Davis_Rock_2003_donut_plot_rounded <- Davis_Rock_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2003_donut_plot_test <- cbind(Davis_Rock_2003_donut_plot_rounded,Legend)


Davis_Rock_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2003.png", width = 6, height = 6)




Davis_Rock_2004 <- filter(Davis_Rock_plot, Year == 2004)
Davis_Rock_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2004_t <- t(Davis_Rock_2004)

Davis_Rock_2004_donut <- data.frame(Davis_Rock_2004_t)
colnames(Davis_Rock_2004_donut) <- c("Value")
Davis_Rock_2004_donut <- Davis_Rock_2004_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2004_donut,"Davis_Rock_2004.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2004_donut_plot <- read.table("Davis_Rock_2004.csv", header=TRUE, sep=",")


Davis_Rock_2004_donut_plot_rounded <- Davis_Rock_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2004_donut_plot_test <- cbind(Davis_Rock_2004_donut_plot_rounded,Legend)


Davis_Rock_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2004.png", width = 6, height = 6)




Davis_Rock_2005 <- filter(Davis_Rock_plot, Year == 2005)
Davis_Rock_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2005_t <- t(Davis_Rock_2005)

Davis_Rock_2005_donut <- data.frame(Davis_Rock_2005_t)
colnames(Davis_Rock_2005_donut) <- c("Value")
Davis_Rock_2005_donut <- Davis_Rock_2005_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2005_donut,"Davis_Rock_2005.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2005_donut_plot <- read.table("Davis_Rock_2005.csv", header=TRUE, sep=",")


Davis_Rock_2005_donut_plot_rounded <- Davis_Rock_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2005_donut_plot_test <- cbind(Davis_Rock_2005_donut_plot_rounded,Legend)


Davis_Rock_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2005.png", width = 6, height = 6)





Davis_Rock_2006 <- filter(Davis_Rock_plot, Year == 2006)
Davis_Rock_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2006_t <- t(Davis_Rock_2006)

Davis_Rock_2006_donut <- data.frame(Davis_Rock_2006_t)
colnames(Davis_Rock_2006_donut) <- c("Value")
Davis_Rock_2006_donut <- Davis_Rock_2006_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2006_donut,"Davis_Rock_2006.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2006_donut_plot <- read.table("Davis_Rock_2006.csv", header=TRUE, sep=",")


Davis_Rock_2006_donut_plot_rounded <- Davis_Rock_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2006_donut_plot_test <- cbind(Davis_Rock_2006_donut_plot_rounded,Legend)


Davis_Rock_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2006.png", width = 6, height = 6)




Davis_Rock_2007 <- filter(Davis_Rock_plot, Year == 2007)
Davis_Rock_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2007_t <- t(Davis_Rock_2007)

Davis_Rock_2007_donut <- data.frame(Davis_Rock_2007_t)
colnames(Davis_Rock_2007_donut) <- c("Value")
Davis_Rock_2007_donut <- Davis_Rock_2007_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2007_donut,"Davis_Rock_2007.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2007_donut_plot <- read.table("Davis_Rock_2007.csv", header=TRUE, sep=",")


Davis_Rock_2007_donut_plot_rounded <- Davis_Rock_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2007_donut_plot_test <- cbind(Davis_Rock_2007_donut_plot_rounded,Legend)


Davis_Rock_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2007.png", width = 6, height = 6)




Davis_Rock_2008 <- filter(Davis_Rock_plot, Year == 2008)
Davis_Rock_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2008_t <- t(Davis_Rock_2008)

Davis_Rock_2008_donut <- data.frame(Davis_Rock_2008_t)
colnames(Davis_Rock_2008_donut) <- c("Value")
Davis_Rock_2008_donut <- Davis_Rock_2008_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2008_donut,"Davis_Rock_2008.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2008_donut_plot <- read.table("Davis_Rock_2008.csv", header=TRUE, sep=",")


Davis_Rock_2008_donut_plot_rounded <- Davis_Rock_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2008_donut_plot_test <- cbind(Davis_Rock_2008_donut_plot_rounded,Legend)


Davis_Rock_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2008.png", width = 6, height = 6)




Davis_Rock_2009 <- filter(Davis_Rock_plot, Year == 2009)
Davis_Rock_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2009_t <- t(Davis_Rock_2009)

Davis_Rock_2009_donut <- data.frame(Davis_Rock_2009_t)
colnames(Davis_Rock_2009_donut) <- c("Value")
Davis_Rock_2009_donut <- Davis_Rock_2009_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2009_donut,"Davis_Rock_2009.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2009_donut_plot <- read.table("Davis_Rock_2009.csv", header=TRUE, sep=",")


Davis_Rock_2009_donut_plot_rounded <- Davis_Rock_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2009_donut_plot_test <- cbind(Davis_Rock_2009_donut_plot_rounded,Legend)


Davis_Rock_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2009.png", width = 6, height = 6)




Davis_Rock_2010 <- filter(Davis_Rock_plot, Year == 2010)
Davis_Rock_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2010_t <- t(Davis_Rock_2010)

Davis_Rock_2010_donut <- data.frame(Davis_Rock_2010_t)
colnames(Davis_Rock_2010_donut) <- c("Value")
Davis_Rock_2010_donut <- Davis_Rock_2010_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2010_donut,"Davis_Rock_2010.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2010_donut_plot <- read.table("Davis_Rock_2010.csv", header=TRUE, sep=",")


Davis_Rock_2010_donut_plot_rounded <- Davis_Rock_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2010_donut_plot_test <- cbind(Davis_Rock_2010_donut_plot_rounded,Legend)


Davis_Rock_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Davis_Rock_2010.png", width = 6, height = 6)




Davis_Rock_2011 <- filter(Davis_Rock_plot, Year == 2011)
Davis_Rock_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2011_t <- t(Davis_Rock_2011)

Davis_Rock_2011_donut <- data.frame(Davis_Rock_2011_t)
colnames(Davis_Rock_2011_donut) <- c("Value")
Davis_Rock_2011_donut <- Davis_Rock_2011_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2011_donut,"Davis_Rock_2011.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2011_donut_plot <- read.table("Davis_Rock_2011.csv", header=TRUE, sep=",")


Davis_Rock_2011_donut_plot_rounded <- Davis_Rock_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2011_donut_plot_test <- cbind(Davis_Rock_2011_donut_plot_rounded,Legend)


Davis_Rock_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2011.png", width = 6, height = 6)





Davis_Rock_2012 <- filter(Davis_Rock_plot, Year == 2012)
Davis_Rock_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2012_t <- t(Davis_Rock_2012)

Davis_Rock_2012_donut <- data.frame(Davis_Rock_2012_t)
colnames(Davis_Rock_2012_donut) <- c("Value")
Davis_Rock_2012_donut <- Davis_Rock_2012_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2012_donut,"Davis_Rock_2012.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2012_donut_plot <- read.table("Davis_Rock_2012.csv", header=TRUE, sep=",")


Davis_Rock_2012_donut_plot_rounded <- Davis_Rock_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2012_donut_plot_test <- cbind(Davis_Rock_2012_donut_plot_rounded,Legend)


Davis_Rock_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2012.png", width = 6, height = 6)






Davis_Rock_2014 <- filter(Davis_Rock_plot, Year == 2014)
Davis_Rock_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2014_t <- t(Davis_Rock_2014)

Davis_Rock_2014_donut <- data.frame(Davis_Rock_2014_t)
colnames(Davis_Rock_2014_donut) <- c("Value")
Davis_Rock_2014_donut <- Davis_Rock_2014_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2014_donut,"Davis_Rock_2014.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2014_donut_plot <- read.table("Davis_Rock_2014.csv", header=TRUE, sep=",")


Davis_Rock_2014_donut_plot_rounded <- Davis_Rock_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2014_donut_plot_test <- cbind(Davis_Rock_2014_donut_plot_rounded,Legend)


Davis_Rock_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Davis_Rock_2014.png", width = 6, height = 6)





Davis_Rock_2016 <- filter(Davis_Rock_plot, Year == 2016)
Davis_Rock_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Davis_Rock_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2016_t <- t(Davis_Rock_2016)

Davis_Rock_2016_donut <- data.frame(Davis_Rock_2016_t)
colnames(Davis_Rock_2016_donut) <- c("Value")
Davis_Rock_2016_donut <- Davis_Rock_2016_donut %>%
  rownames_to_column(var = "Category")


export(Davis_Rock_2016_donut,"Davis_Rock_2016.csv")


### import as csv (change category and value to the two column names)

Davis_Rock_2016_donut_plot <- read.table("Davis_Rock_2016.csv", header=TRUE, sep=",")


Davis_Rock_2016_donut_plot_rounded <- Davis_Rock_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Davis_Rock_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Davis_Rock_2016_donut_plot_test <- cbind(Davis_Rock_2016_donut_plot_rounded,Legend)


Davis_Rock_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Davis Rock 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Davis_Rock_2016.png", width = 6, height = 6)



Loggerhead_Patch <- filter(RVC_CREMP, sitename == "Loggerhead Patch")

## Make percentages of sum, stony coral cover, and macroalgae

Loggerhead_Patch_fish <- Loggerhead_Patch$sum/max(Loggerhead_Patch$sum)
Loggerhead_Patch_biomass <- data.frame(Loggerhead_Patch_fish)

Loggerhead_Patch_biomass <- 100*Loggerhead_Patch_biomass


Loggerhead_Patch_Stony <- Loggerhead_Patch$Stony_coral/max(Loggerhead_Patch$Stony_coral)
Loggerhead_Patch_coral <- data.frame(Loggerhead_Patch_Stony)

Loggerhead_Patch_stony_coral <- 100*Loggerhead_Patch_coral

Loggerhead_Patch_macro <- Loggerhead_Patch$Macroalgae/max(Loggerhead_Patch$Macroalgae)
Loggerhead_Patch_algae <- data.frame(Loggerhead_Patch_macro)


Loggerhead_Patch_macroalgae <- (100*Loggerhead_Patch_algae)


Loggerhead_Patch_plot <- cbind(Loggerhead_Patch_macroalgae,Loggerhead_Patch_biomass,Loggerhead_Patch_stony_coral)

Loggerhead_Patch_plot$Year <- c("2006","2008","2012","2014","2016")

### Filter per year

Loggerhead_Patch_1999 <- filter(Loggerhead_Patch_plot, Year == 1999)
Loggerhead_Patch_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_1999_t <- t(Loggerhead_Patch_1999)

Loggerhead_Patch_1999_donut <- data.frame(Loggerhead_Patch_1999_t)
colnames(Loggerhead_Patch_1999_donut) <- c("Value")
Loggerhead_Patch_1999_donut <- Loggerhead_Patch_1999_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_1999_donut,"Loggerhead_Patch_1999.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_1999_donut_plot <- read.table("Loggerhead_Patch_1999.csv", header=TRUE, sep=",")


Loggerhead_Patch_1999_donut_plot_rounded <- Loggerhead_Patch_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_1999_donut_plot_test <- cbind(Loggerhead_Patch_1999_donut_plot_rounded,Legend)


Loggerhead_Patch_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_1999.png", width = 6, height = 6)



### Loggerhead Patch


Loggerhead_Patch_2000 <- filter(Loggerhead_Patch_plot, Year == 2000)
Loggerhead_Patch_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2000_t <- t(Loggerhead_Patch_2000)

Loggerhead_Patch_2000_donut <- data.frame(Loggerhead_Patch_2000_t)
colnames(Loggerhead_Patch_2000_donut) <- c("Value")
Loggerhead_Patch_2000_donut <- Loggerhead_Patch_2000_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2000_donut,"Loggerhead_Patch_2000.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2000_donut_plot <- read.table("Loggerhead_Patch_2000.csv", header=TRUE, sep=",")


Loggerhead_Patch_2000_donut_plot_rounded <- Loggerhead_Patch_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2000_donut_plot_test <- cbind(Loggerhead_Patch_2000_donut_plot_rounded,Legend)


Loggerhead_Patch_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2000.png", width = 6, height = 6)




Loggerhead_Patch_2001 <- filter(Loggerhead_Patch_plot, Year == 2001)
Loggerhead_Patch_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2001_t <- t(Loggerhead_Patch_2001)

Loggerhead_Patch_2001_donut <- data.frame(Loggerhead_Patch_2001_t)
colnames(Loggerhead_Patch_2001_donut) <- c("Value")
Loggerhead_Patch_2001_donut <- Loggerhead_Patch_2001_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2001_donut,"Loggerhead_Patch_2001.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2001_donut_plot <- read.table("Loggerhead_Patch_2001.csv", header=TRUE, sep=",")


Loggerhead_Patch_2001_donut_plot_rounded <- Loggerhead_Patch_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2001_donut_plot_test <- cbind(Loggerhead_Patch_2001_donut_plot_rounded,Legend)


Loggerhead_Patch_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2001.png", width = 6, height = 6)





Loggerhead_Patch_2002 <- filter(Loggerhead_Patch_plot, Year == 2002)
Loggerhead_Patch_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2002_t <- t(Loggerhead_Patch_2002)

Loggerhead_Patch_2002_donut <- data.frame(Loggerhead_Patch_2002_t)
colnames(Loggerhead_Patch_2002_donut) <- c("Value")
Loggerhead_Patch_2002_donut <- Loggerhead_Patch_2002_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2002_donut,"Loggerhead_Patch_2002.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2002_donut_plot <- read.table("Loggerhead_Patch_2002.csv", header=TRUE, sep=",")


Loggerhead_Patch_2002_donut_plot_rounded <- Loggerhead_Patch_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2002_donut_plot_test <- cbind(Loggerhead_Patch_2002_donut_plot_rounded,Legend)


Loggerhead_Patch_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2002.png", width = 6, height = 6)



Loggerhead_Patch_2003 <- filter(Loggerhead_Patch_plot, Year == 2003)
Loggerhead_Patch_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2003_t <- t(Loggerhead_Patch_2003)

Loggerhead_Patch_2003_donut <- data.frame(Loggerhead_Patch_2003_t)
colnames(Loggerhead_Patch_2003_donut) <- c("Value")
Loggerhead_Patch_2003_donut <- Loggerhead_Patch_2003_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2003_donut,"Loggerhead_Patch_2003.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2003_donut_plot <- read.table("Loggerhead_Patch_2003.csv", header=TRUE, sep=",")


Loggerhead_Patch_2003_donut_plot_rounded <- Loggerhead_Patch_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2003_donut_plot_test <- cbind(Loggerhead_Patch_2003_donut_plot_rounded,Legend)


Loggerhead_Patch_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2003.png", width = 6, height = 6)




Loggerhead_Patch_2004 <- filter(Loggerhead_Patch_plot, Year == 2004)
Loggerhead_Patch_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2004_t <- t(Loggerhead_Patch_2004)

Loggerhead_Patch_2004_donut <- data.frame(Loggerhead_Patch_2004_t)
colnames(Loggerhead_Patch_2004_donut) <- c("Value")
Loggerhead_Patch_2004_donut <- Loggerhead_Patch_2004_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2004_donut,"Loggerhead_Patch_2004.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2004_donut_plot <- read.table("Loggerhead_Patch_2004.csv", header=TRUE, sep=",")


Loggerhead_Patch_2004_donut_plot_rounded <- Loggerhead_Patch_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2004_donut_plot_test <- cbind(Loggerhead_Patch_2004_donut_plot_rounded,Legend)


Loggerhead_Patch_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2004.png", width = 6, height = 6)




Loggerhead_Patch_2005 <- filter(Loggerhead_Patch_plot, Year == 2005)
Loggerhead_Patch_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2005_t <- t(Loggerhead_Patch_2005)

Loggerhead_Patch_2005_donut <- data.frame(Loggerhead_Patch_2005_t)
colnames(Loggerhead_Patch_2005_donut) <- c("Value")
Loggerhead_Patch_2005_donut <- Loggerhead_Patch_2005_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2005_donut,"Loggerhead_Patch_2005.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2005_donut_plot <- read.table("Loggerhead_Patch_2005.csv", header=TRUE, sep=",")


Loggerhead_Patch_2005_donut_plot_rounded <- Loggerhead_Patch_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2005_donut_plot_test <- cbind(Loggerhead_Patch_2005_donut_plot_rounded,Legend)


Loggerhead_Patch_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2005.png", width = 6, height = 6)





Loggerhead_Patch_2006 <- filter(Loggerhead_Patch_plot, Year == 2006)
Loggerhead_Patch_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2006_t <- t(Loggerhead_Patch_2006)

Loggerhead_Patch_2006_donut <- data.frame(Loggerhead_Patch_2006_t)
colnames(Loggerhead_Patch_2006_donut) <- c("Value")
Loggerhead_Patch_2006_donut <- Loggerhead_Patch_2006_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2006_donut,"Loggerhead_Patch_2006.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2006_donut_plot <- read.table("Loggerhead_Patch_2006.csv", header=TRUE, sep=",")


Loggerhead_Patch_2006_donut_plot_rounded <- Loggerhead_Patch_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2006_donut_plot_test <- cbind(Loggerhead_Patch_2006_donut_plot_rounded,Legend)


Loggerhead_Patch_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Loggerhead_Patch_2006.png", width = 6, height = 6)




Loggerhead_Patch_2007 <- filter(Loggerhead_Patch_plot, Year == 2007)
Loggerhead_Patch_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2007_t <- t(Loggerhead_Patch_2007)

Loggerhead_Patch_2007_donut <- data.frame(Loggerhead_Patch_2007_t)
colnames(Loggerhead_Patch_2007_donut) <- c("Value")
Loggerhead_Patch_2007_donut <- Loggerhead_Patch_2007_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2007_donut,"Loggerhead_Patch_2007.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2007_donut_plot <- read.table("Loggerhead_Patch_2007.csv", header=TRUE, sep=",")


Loggerhead_Patch_2007_donut_plot_rounded <- Loggerhead_Patch_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2007_donut_plot_test <- cbind(Loggerhead_Patch_2007_donut_plot_rounded,Legend)


Loggerhead_Patch_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2007.png", width = 6, height = 6)




Loggerhead_Patch_2008 <- filter(Loggerhead_Patch_plot, Year == 2008)
Loggerhead_Patch_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2008_t <- t(Loggerhead_Patch_2008)

Loggerhead_Patch_2008_donut <- data.frame(Loggerhead_Patch_2008_t)
colnames(Loggerhead_Patch_2008_donut) <- c("Value")
Loggerhead_Patch_2008_donut <- Loggerhead_Patch_2008_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2008_donut,"Loggerhead_Patch_2008.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2008_donut_plot <- read.table("Loggerhead_Patch_2008.csv", header=TRUE, sep=",")


Loggerhead_Patch_2008_donut_plot_rounded <- Loggerhead_Patch_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2008_donut_plot_test <- cbind(Loggerhead_Patch_2008_donut_plot_rounded,Legend)


Loggerhead_Patch_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2008.png", width = 6, height = 6)




Loggerhead_Patch_2009 <- filter(Loggerhead_Patch_plot, Year == 2009)
Loggerhead_Patch_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2009_t <- t(Loggerhead_Patch_2009)

Loggerhead_Patch_2009_donut <- data.frame(Loggerhead_Patch_2009_t)
colnames(Loggerhead_Patch_2009_donut) <- c("Value")
Loggerhead_Patch_2009_donut <- Loggerhead_Patch_2009_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2009_donut,"Loggerhead_Patch_2009.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2009_donut_plot <- read.table("Loggerhead_Patch_2009.csv", header=TRUE, sep=",")


Loggerhead_Patch_2009_donut_plot_rounded <- Loggerhead_Patch_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2009_donut_plot_test <- cbind(Loggerhead_Patch_2009_donut_plot_rounded,Legend)


Loggerhead_Patch_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2009.png", width = 6, height = 6)




Loggerhead_Patch_2010 <- filter(Loggerhead_Patch_plot, Year == 2010)
Loggerhead_Patch_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2010_t <- t(Loggerhead_Patch_2010)

Loggerhead_Patch_2010_donut <- data.frame(Loggerhead_Patch_2010_t)
colnames(Loggerhead_Patch_2010_donut) <- c("Value")
Loggerhead_Patch_2010_donut <- Loggerhead_Patch_2010_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2010_donut,"Loggerhead_Patch_2010.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2010_donut_plot <- read.table("Loggerhead_Patch_2010.csv", header=TRUE, sep=",")


Loggerhead_Patch_2010_donut_plot_rounded <- Loggerhead_Patch_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2010_donut_plot_test <- cbind(Loggerhead_Patch_2010_donut_plot_rounded,Legend)


Loggerhead_Patch_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2010.png", width = 6, height = 6)




Loggerhead_Patch_2011 <- filter(Loggerhead_Patch_plot, Year == 2011)
Loggerhead_Patch_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2011_t <- t(Loggerhead_Patch_2011)

Loggerhead_Patch_2011_donut <- data.frame(Loggerhead_Patch_2011_t)
colnames(Loggerhead_Patch_2011_donut) <- c("Value")
Loggerhead_Patch_2011_donut <- Loggerhead_Patch_2011_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2011_donut,"Loggerhead_Patch_2011.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2011_donut_plot <- read.table("Loggerhead_Patch_2011.csv", header=TRUE, sep=",")


Loggerhead_Patch_2011_donut_plot_rounded <- Loggerhead_Patch_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2011_donut_plot_test <- cbind(Loggerhead_Patch_2011_donut_plot_rounded,Legend)


Loggerhead_Patch_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2011.png", width = 6, height = 6)





Loggerhead_Patch_2012 <- filter(Loggerhead_Patch_plot, Year == 2012)
Loggerhead_Patch_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2012_t <- t(Loggerhead_Patch_2012)

Loggerhead_Patch_2012_donut <- data.frame(Loggerhead_Patch_2012_t)
colnames(Loggerhead_Patch_2012_donut) <- c("Value")
Loggerhead_Patch_2012_donut <- Loggerhead_Patch_2012_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2012_donut,"Loggerhead_Patch_2012.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2012_donut_plot <- read.table("Loggerhead_Patch_2012.csv", header=TRUE, sep=",")


Loggerhead_Patch_2012_donut_plot_rounded <- Loggerhead_Patch_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2012_donut_plot_test <- cbind(Loggerhead_Patch_2012_donut_plot_rounded,Legend)


Loggerhead_Patch_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Loggerhead_Patch_2012.png", width = 6, height = 6)






Loggerhead_Patch_2014 <- filter(Loggerhead_Patch_plot, Year == 2014)
Loggerhead_Patch_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2014_t <- t(Loggerhead_Patch_2014)

Loggerhead_Patch_2014_donut <- data.frame(Loggerhead_Patch_2014_t)
colnames(Loggerhead_Patch_2014_donut) <- c("Value")
Loggerhead_Patch_2014_donut <- Loggerhead_Patch_2014_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2014_donut,"Loggerhead_Patch_2014.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2014_donut_plot <- read.table("Loggerhead_Patch_2014.csv", header=TRUE, sep=",")


Loggerhead_Patch_2014_donut_plot_rounded <- Loggerhead_Patch_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2014_donut_plot_test <- cbind(Loggerhead_Patch_2014_donut_plot_rounded,Legend)


Loggerhead_Patch_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Loggerhead_Patch_2014.png", width = 6, height = 6)





Loggerhead_Patch_2016 <- filter(Loggerhead_Patch_plot, Year == 2016)
Loggerhead_Patch_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Loggerhead_Patch_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2016_t <- t(Loggerhead_Patch_2016)

Loggerhead_Patch_2016_donut <- data.frame(Loggerhead_Patch_2016_t)
colnames(Loggerhead_Patch_2016_donut) <- c("Value")
Loggerhead_Patch_2016_donut <- Loggerhead_Patch_2016_donut %>%
  rownames_to_column(var = "Category")


export(Loggerhead_Patch_2016_donut,"Loggerhead_Patch_2016.csv")


### import as csv (change category and value to the two column names)

Loggerhead_Patch_2016_donut_plot <- read.table("Loggerhead_Patch_2016.csv", header=TRUE, sep=",")


Loggerhead_Patch_2016_donut_plot_rounded <- Loggerhead_Patch_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Loggerhead_Patch_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Loggerhead_Patch_2016_donut_plot_test <- cbind(Loggerhead_Patch_2016_donut_plot_rounded,Legend)


Loggerhead_Patch_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Loggerhead Patch 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Loggerhead_Patch_2016.png", width = 6, height = 6)




Palmata_Patch <- filter(RVC_CREMP, sitename == "Palmata Patch")

## Make percentages of sum, stony coral cover, and macroalgae

Palmata_Patch_fish <- Palmata_Patch$sum/max(Palmata_Patch$sum)
Palmata_Patch_biomass <- data.frame(Palmata_Patch_fish)

Palmata_Patch_biomass <- 100*Palmata_Patch_biomass


Palmata_Patch_Stony <- Palmata_Patch$Stony_coral/max(Palmata_Patch$Stony_coral)
Palmata_Patch_coral <- data.frame(Palmata_Patch_Stony)

Palmata_Patch_stony_coral <- 100*Palmata_Patch_coral

Palmata_Patch_macro <- Palmata_Patch$Macroalgae/max(Palmata_Patch$Macroalgae)
Palmata_Patch_algae <- data.frame(Palmata_Patch_macro)


Palmata_Patch_macroalgae <- (100*Palmata_Patch_algae)


Palmata_Patch_plot <- cbind(Palmata_Patch_macroalgae,Palmata_Patch_biomass,Palmata_Patch_stony_coral)

Palmata_Patch_plot$Year <- c("2004","2006","2008","2012","2014")

### Filter per year

Palmata_Patch_1999 <- filter(Palmata_Patch_plot, Year == 1999)
Palmata_Patch_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_1999_t <- t(Palmata_Patch_1999)

Palmata_Patch_1999_donut <- data.frame(Palmata_Patch_1999_t)
colnames(Palmata_Patch_1999_donut) <- c("Value")
Palmata_Patch_1999_donut <- Palmata_Patch_1999_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_1999_donut,"Palmata_Patch_1999.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_1999_donut_plot <- read.table("Palmata_Patch_1999.csv", header=TRUE, sep=",")


Palmata_Patch_1999_donut_plot_rounded <- Palmata_Patch_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_1999_donut_plot_test <- cbind(Palmata_Patch_1999_donut_plot_rounded,Legend)


Palmata_Patch_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_1999.png", width = 6, height = 6)



### Palmata Patch


Palmata_Patch_2000 <- filter(Palmata_Patch_plot, Year == 2000)
Palmata_Patch_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2000_t <- t(Palmata_Patch_2000)

Palmata_Patch_2000_donut <- data.frame(Palmata_Patch_2000_t)
colnames(Palmata_Patch_2000_donut) <- c("Value")
Palmata_Patch_2000_donut <- Palmata_Patch_2000_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2000_donut,"Palmata_Patch_2000.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2000_donut_plot <- read.table("Palmata_Patch_2000.csv", header=TRUE, sep=",")


Palmata_Patch_2000_donut_plot_rounded <- Palmata_Patch_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2000_donut_plot_test <- cbind(Palmata_Patch_2000_donut_plot_rounded,Legend)


Palmata_Patch_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2000.png", width = 6, height = 6)




Palmata_Patch_2001 <- filter(Palmata_Patch_plot, Year == 2001)
Palmata_Patch_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2001_t <- t(Palmata_Patch_2001)

Palmata_Patch_2001_donut <- data.frame(Palmata_Patch_2001_t)
colnames(Palmata_Patch_2001_donut) <- c("Value")
Palmata_Patch_2001_donut <- Palmata_Patch_2001_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2001_donut,"Palmata_Patch_2001.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2001_donut_plot <- read.table("Palmata_Patch_2001.csv", header=TRUE, sep=",")


Palmata_Patch_2001_donut_plot_rounded <- Palmata_Patch_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2001_donut_plot_test <- cbind(Palmata_Patch_2001_donut_plot_rounded,Legend)


Palmata_Patch_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2001.png", width = 6, height = 6)





Palmata_Patch_2002 <- filter(Palmata_Patch_plot, Year == 2002)
Palmata_Patch_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2002_t <- t(Palmata_Patch_2002)

Palmata_Patch_2002_donut <- data.frame(Palmata_Patch_2002_t)
colnames(Palmata_Patch_2002_donut) <- c("Value")
Palmata_Patch_2002_donut <- Palmata_Patch_2002_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2002_donut,"Palmata_Patch_2002.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2002_donut_plot <- read.table("Palmata_Patch_2002.csv", header=TRUE, sep=",")


Palmata_Patch_2002_donut_plot_rounded <- Palmata_Patch_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2002_donut_plot_test <- cbind(Palmata_Patch_2002_donut_plot_rounded,Legend)


Palmata_Patch_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2002.png", width = 6, height = 6)



Palmata_Patch_2003 <- filter(Palmata_Patch_plot, Year == 2003)
Palmata_Patch_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2003_t <- t(Palmata_Patch_2003)

Palmata_Patch_2003_donut <- data.frame(Palmata_Patch_2003_t)
colnames(Palmata_Patch_2003_donut) <- c("Value")
Palmata_Patch_2003_donut <- Palmata_Patch_2003_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2003_donut,"Palmata_Patch_2003.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2003_donut_plot <- read.table("Palmata_Patch_2003.csv", header=TRUE, sep=",")


Palmata_Patch_2003_donut_plot_rounded <- Palmata_Patch_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2003_donut_plot_test <- cbind(Palmata_Patch_2003_donut_plot_rounded,Legend)


Palmata_Patch_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2003.png", width = 6, height = 6)




Palmata_Patch_2004 <- filter(Palmata_Patch_plot, Year == 2004)
Palmata_Patch_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2004_t <- t(Palmata_Patch_2004)

Palmata_Patch_2004_donut <- data.frame(Palmata_Patch_2004_t)
colnames(Palmata_Patch_2004_donut) <- c("Value")
Palmata_Patch_2004_donut <- Palmata_Patch_2004_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2004_donut,"Palmata_Patch_2004.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2004_donut_plot <- read.table("Palmata_Patch_2004.csv", header=TRUE, sep=",")


Palmata_Patch_2004_donut_plot_rounded <- Palmata_Patch_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2004_donut_plot_test <- cbind(Palmata_Patch_2004_donut_plot_rounded,Legend)


Palmata_Patch_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palmata_Patch_2004.png", width = 6, height = 6)




Palmata_Patch_2005 <- filter(Palmata_Patch_plot, Year == 2005)
Palmata_Patch_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2005_t <- t(Palmata_Patch_2005)

Palmata_Patch_2005_donut <- data.frame(Palmata_Patch_2005_t)
colnames(Palmata_Patch_2005_donut) <- c("Value")
Palmata_Patch_2005_donut <- Palmata_Patch_2005_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2005_donut,"Palmata_Patch_2005.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2005_donut_plot <- read.table("Palmata_Patch_2005.csv", header=TRUE, sep=",")


Palmata_Patch_2005_donut_plot_rounded <- Palmata_Patch_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2005_donut_plot_test <- cbind(Palmata_Patch_2005_donut_plot_rounded,Legend)


Palmata_Patch_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2005.png", width = 6, height = 6)





Palmata_Patch_2006 <- filter(Palmata_Patch_plot, Year == 2006)
Palmata_Patch_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2006_t <- t(Palmata_Patch_2006)

Palmata_Patch_2006_donut <- data.frame(Palmata_Patch_2006_t)
colnames(Palmata_Patch_2006_donut) <- c("Value")
Palmata_Patch_2006_donut <- Palmata_Patch_2006_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2006_donut,"Palmata_Patch_2006.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2006_donut_plot <- read.table("Palmata_Patch_2006.csv", header=TRUE, sep=",")


Palmata_Patch_2006_donut_plot_rounded <- Palmata_Patch_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2006_donut_plot_test <- cbind(Palmata_Patch_2006_donut_plot_rounded,Legend)


Palmata_Patch_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palmata_Patch_2006.png", width = 6, height = 6)




Palmata_Patch_2007 <- filter(Palmata_Patch_plot, Year == 2007)
Palmata_Patch_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2007_t <- t(Palmata_Patch_2007)

Palmata_Patch_2007_donut <- data.frame(Palmata_Patch_2007_t)
colnames(Palmata_Patch_2007_donut) <- c("Value")
Palmata_Patch_2007_donut <- Palmata_Patch_2007_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2007_donut,"Palmata_Patch_2007.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2007_donut_plot <- read.table("Palmata_Patch_2007.csv", header=TRUE, sep=",")


Palmata_Patch_2007_donut_plot_rounded <- Palmata_Patch_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2007_donut_plot_test <- cbind(Palmata_Patch_2007_donut_plot_rounded,Legend)


Palmata_Patch_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2007.png", width = 6, height = 6)




Palmata_Patch_2008 <- filter(Palmata_Patch_plot, Year == 2008)
Palmata_Patch_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2008_t <- t(Palmata_Patch_2008)

Palmata_Patch_2008_donut <- data.frame(Palmata_Patch_2008_t)
colnames(Palmata_Patch_2008_donut) <- c("Value")
Palmata_Patch_2008_donut <- Palmata_Patch_2008_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2008_donut,"Palmata_Patch_2008.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2008_donut_plot <- read.table("Palmata_Patch_2008.csv", header=TRUE, sep=",")


Palmata_Patch_2008_donut_plot_rounded <- Palmata_Patch_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2008_donut_plot_test <- cbind(Palmata_Patch_2008_donut_plot_rounded,Legend)


Palmata_Patch_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palmata_Patch_2008.png", width = 6, height = 6)




Palmata_Patch_2009 <- filter(Palmata_Patch_plot, Year == 2009)
Palmata_Patch_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2009_t <- t(Palmata_Patch_2009)

Palmata_Patch_2009_donut <- data.frame(Palmata_Patch_2009_t)
colnames(Palmata_Patch_2009_donut) <- c("Value")
Palmata_Patch_2009_donut <- Palmata_Patch_2009_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2009_donut,"Palmata_Patch_2009.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2009_donut_plot <- read.table("Palmata_Patch_2009.csv", header=TRUE, sep=",")


Palmata_Patch_2009_donut_plot_rounded <- Palmata_Patch_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2009_donut_plot_test <- cbind(Palmata_Patch_2009_donut_plot_rounded,Legend)


Palmata_Patch_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2009.png", width = 6, height = 6)




Palmata_Patch_2010 <- filter(Palmata_Patch_plot, Year == 2010)
Palmata_Patch_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2010_t <- t(Palmata_Patch_2010)

Palmata_Patch_2010_donut <- data.frame(Palmata_Patch_2010_t)
colnames(Palmata_Patch_2010_donut) <- c("Value")
Palmata_Patch_2010_donut <- Palmata_Patch_2010_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2010_donut,"Palmata_Patch_2010.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2010_donut_plot <- read.table("Palmata_Patch_2010.csv", header=TRUE, sep=",")


Palmata_Patch_2010_donut_plot_rounded <- Palmata_Patch_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2010_donut_plot_test <- cbind(Palmata_Patch_2010_donut_plot_rounded,Legend)


Palmata_Patch_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2010.png", width = 6, height = 6)




Palmata_Patch_2011 <- filter(Palmata_Patch_plot, Year == 2011)
Palmata_Patch_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2011_t <- t(Palmata_Patch_2011)

Palmata_Patch_2011_donut <- data.frame(Palmata_Patch_2011_t)
colnames(Palmata_Patch_2011_donut) <- c("Value")
Palmata_Patch_2011_donut <- Palmata_Patch_2011_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2011_donut,"Palmata_Patch_2011.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2011_donut_plot <- read.table("Palmata_Patch_2011.csv", header=TRUE, sep=",")


Palmata_Patch_2011_donut_plot_rounded <- Palmata_Patch_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2011_donut_plot_test <- cbind(Palmata_Patch_2011_donut_plot_rounded,Legend)


Palmata_Patch_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2011.png", width = 6, height = 6)





Palmata_Patch_2012 <- filter(Palmata_Patch_plot, Year == 2012)
Palmata_Patch_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2012_t <- t(Palmata_Patch_2012)

Palmata_Patch_2012_donut <- data.frame(Palmata_Patch_2012_t)
colnames(Palmata_Patch_2012_donut) <- c("Value")
Palmata_Patch_2012_donut <- Palmata_Patch_2012_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2012_donut,"Palmata_Patch_2012.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2012_donut_plot <- read.table("Palmata_Patch_2012.csv", header=TRUE, sep=",")


Palmata_Patch_2012_donut_plot_rounded <- Palmata_Patch_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2012_donut_plot_test <- cbind(Palmata_Patch_2012_donut_plot_rounded,Legend)


Palmata_Patch_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palmata_Patch_2012.png", width = 6, height = 6)






Palmata_Patch_2014 <- filter(Palmata_Patch_plot, Year == 2014)
Palmata_Patch_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2014_t <- t(Palmata_Patch_2014)

Palmata_Patch_2014_donut <- data.frame(Palmata_Patch_2014_t)
colnames(Palmata_Patch_2014_donut) <- c("Value")
Palmata_Patch_2014_donut <- Palmata_Patch_2014_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2014_donut,"Palmata_Patch_2014.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2014_donut_plot <- read.table("Palmata_Patch_2014.csv", header=TRUE, sep=",")


Palmata_Patch_2014_donut_plot_rounded <- Palmata_Patch_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2014_donut_plot_test <- cbind(Palmata_Patch_2014_donut_plot_rounded,Legend)


Palmata_Patch_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palmata_Patch_2014.png", width = 6, height = 6)





Palmata_Patch_2016 <- filter(Palmata_Patch_plot, Year == 2016)
Palmata_Patch_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palmata_Patch_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2016_t <- t(Palmata_Patch_2016)

Palmata_Patch_2016_donut <- data.frame(Palmata_Patch_2016_t)
colnames(Palmata_Patch_2016_donut) <- c("Value")
Palmata_Patch_2016_donut <- Palmata_Patch_2016_donut %>%
  rownames_to_column(var = "Category")


export(Palmata_Patch_2016_donut,"Palmata_Patch_2016.csv")


### import as csv (change category and value to the two column names)

Palmata_Patch_2016_donut_plot <- read.table("Palmata_Patch_2016.csv", header=TRUE, sep=",")


Palmata_Patch_2016_donut_plot_rounded <- Palmata_Patch_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palmata_Patch_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palmata_Patch_2016_donut_plot_test <- cbind(Palmata_Patch_2016_donut_plot_rounded,Legend)


Palmata_Patch_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palmata Patch 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palmata_Patch_2016.png", width = 6, height = 6)




Prolifera_Patch <- filter(RVC_CREMP, sitename == "Prolifera Patch")

## Make percentages of sum, stony coral cover, and macroalgae

Prolifera_Patch_fish <- Prolifera_Patch$sum/max(Prolifera_Patch$sum)
Prolifera_Patch_biomass <- data.frame(Prolifera_Patch_fish)

Prolifera_Patch_biomass <- 100*Prolifera_Patch_biomass


Prolifera_Patch_Stony <- Prolifera_Patch$Stony_coral/max(Prolifera_Patch$Stony_coral)
Prolifera_Patch_coral <- data.frame(Prolifera_Patch_Stony)

Prolifera_Patch_stony_coral <- 100*Prolifera_Patch_coral

Prolifera_Patch_macro <- Prolifera_Patch$Macroalgae/max(Prolifera_Patch$Macroalgae)
Prolifera_Patch_algae <- data.frame(Prolifera_Patch_macro)


Prolifera_Patch_macroalgae <- (100*Prolifera_Patch_algae)


Prolifera_Patch_plot <- cbind(Prolifera_Patch_macroalgae,Prolifera_Patch_biomass,Prolifera_Patch_stony_coral)

Prolifera_Patch_plot$Year <- c("2004","2006","2008","2012","2014")

### Filter per year

Prolifera_Patch_1999 <- filter(Prolifera_Patch_plot, Year == 1999)
Prolifera_Patch_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_1999_t <- t(Prolifera_Patch_1999)

Prolifera_Patch_1999_donut <- data.frame(Prolifera_Patch_1999_t)
colnames(Prolifera_Patch_1999_donut) <- c("Value")
Prolifera_Patch_1999_donut <- Prolifera_Patch_1999_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_1999_donut,"Prolifera_Patch_1999.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_1999_donut_plot <- read.table("Prolifera_Patch_1999.csv", header=TRUE, sep=",")


Prolifera_Patch_1999_donut_plot_rounded <- Prolifera_Patch_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_1999_donut_plot_test <- cbind(Prolifera_Patch_1999_donut_plot_rounded,Legend)


Prolifera_Patch_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_1999.png", width = 6, height = 6)



### Prolifera Patch


Prolifera_Patch_2000 <- filter(Prolifera_Patch_plot, Year == 2000)
Prolifera_Patch_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2000_t <- t(Prolifera_Patch_2000)

Prolifera_Patch_2000_donut <- data.frame(Prolifera_Patch_2000_t)
colnames(Prolifera_Patch_2000_donut) <- c("Value")
Prolifera_Patch_2000_donut <- Prolifera_Patch_2000_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2000_donut,"Prolifera_Patch_2000.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2000_donut_plot <- read.table("Prolifera_Patch_2000.csv", header=TRUE, sep=",")


Prolifera_Patch_2000_donut_plot_rounded <- Prolifera_Patch_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2000_donut_plot_test <- cbind(Prolifera_Patch_2000_donut_plot_rounded,Legend)


Prolifera_Patch_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2000.png", width = 6, height = 6)




Prolifera_Patch_2001 <- filter(Prolifera_Patch_plot, Year == 2001)
Prolifera_Patch_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2001_t <- t(Prolifera_Patch_2001)

Prolifera_Patch_2001_donut <- data.frame(Prolifera_Patch_2001_t)
colnames(Prolifera_Patch_2001_donut) <- c("Value")
Prolifera_Patch_2001_donut <- Prolifera_Patch_2001_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2001_donut,"Prolifera_Patch_2001.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2001_donut_plot <- read.table("Prolifera_Patch_2001.csv", header=TRUE, sep=",")


Prolifera_Patch_2001_donut_plot_rounded <- Prolifera_Patch_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2001_donut_plot_test <- cbind(Prolifera_Patch_2001_donut_plot_rounded,Legend)


Prolifera_Patch_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2001.png", width = 6, height = 6)





Prolifera_Patch_2002 <- filter(Prolifera_Patch_plot, Year == 2002)
Prolifera_Patch_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2002_t <- t(Prolifera_Patch_2002)

Prolifera_Patch_2002_donut <- data.frame(Prolifera_Patch_2002_t)
colnames(Prolifera_Patch_2002_donut) <- c("Value")
Prolifera_Patch_2002_donut <- Prolifera_Patch_2002_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2002_donut,"Prolifera_Patch_2002.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2002_donut_plot <- read.table("Prolifera_Patch_2002.csv", header=TRUE, sep=",")


Prolifera_Patch_2002_donut_plot_rounded <- Prolifera_Patch_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2002_donut_plot_test <- cbind(Prolifera_Patch_2002_donut_plot_rounded,Legend)


Prolifera_Patch_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2002.png", width = 6, height = 6)



Prolifera_Patch_2003 <- filter(Prolifera_Patch_plot, Year == 2003)
Prolifera_Patch_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2003_t <- t(Prolifera_Patch_2003)

Prolifera_Patch_2003_donut <- data.frame(Prolifera_Patch_2003_t)
colnames(Prolifera_Patch_2003_donut) <- c("Value")
Prolifera_Patch_2003_donut <- Prolifera_Patch_2003_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2003_donut,"Prolifera_Patch_2003.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2003_donut_plot <- read.table("Prolifera_Patch_2003.csv", header=TRUE, sep=",")


Prolifera_Patch_2003_donut_plot_rounded <- Prolifera_Patch_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2003_donut_plot_test <- cbind(Prolifera_Patch_2003_donut_plot_rounded,Legend)


Prolifera_Patch_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2003.png", width = 6, height = 6)




Prolifera_Patch_2004 <- filter(Prolifera_Patch_plot, Year == 2004)
Prolifera_Patch_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2004_t <- t(Prolifera_Patch_2004)

Prolifera_Patch_2004_donut <- data.frame(Prolifera_Patch_2004_t)
colnames(Prolifera_Patch_2004_donut) <- c("Value")
Prolifera_Patch_2004_donut <- Prolifera_Patch_2004_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2004_donut,"Prolifera_Patch_2004.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2004_donut_plot <- read.table("Prolifera_Patch_2004.csv", header=TRUE, sep=",")


Prolifera_Patch_2004_donut_plot_rounded <- Prolifera_Patch_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2004_donut_plot_test <- cbind(Prolifera_Patch_2004_donut_plot_rounded,Legend)


Prolifera_Patch_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Prolifera_Patch_2004.png", width = 6, height = 6)




Prolifera_Patch_2005 <- filter(Prolifera_Patch_plot, Year == 2005)
Prolifera_Patch_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2005_t <- t(Prolifera_Patch_2005)

Prolifera_Patch_2005_donut <- data.frame(Prolifera_Patch_2005_t)
colnames(Prolifera_Patch_2005_donut) <- c("Value")
Prolifera_Patch_2005_donut <- Prolifera_Patch_2005_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2005_donut,"Prolifera_Patch_2005.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2005_donut_plot <- read.table("Prolifera_Patch_2005.csv", header=TRUE, sep=",")


Prolifera_Patch_2005_donut_plot_rounded <- Prolifera_Patch_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2005_donut_plot_test <- cbind(Prolifera_Patch_2005_donut_plot_rounded,Legend)


Prolifera_Patch_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2005.png", width = 6, height = 6)





Prolifera_Patch_2006 <- filter(Prolifera_Patch_plot, Year == 2006)
Prolifera_Patch_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2006_t <- t(Prolifera_Patch_2006)

Prolifera_Patch_2006_donut <- data.frame(Prolifera_Patch_2006_t)
colnames(Prolifera_Patch_2006_donut) <- c("Value")
Prolifera_Patch_2006_donut <- Prolifera_Patch_2006_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2006_donut,"Prolifera_Patch_2006.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2006_donut_plot <- read.table("Prolifera_Patch_2006.csv", header=TRUE, sep=",")


Prolifera_Patch_2006_donut_plot_rounded <- Prolifera_Patch_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2006_donut_plot_test <- cbind(Prolifera_Patch_2006_donut_plot_rounded,Legend)


Prolifera_Patch_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Prolifera_Patch_2006.png", width = 6, height = 6)




Prolifera_Patch_2007 <- filter(Prolifera_Patch_plot, Year == 2007)
Prolifera_Patch_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2007_t <- t(Prolifera_Patch_2007)

Prolifera_Patch_2007_donut <- data.frame(Prolifera_Patch_2007_t)
colnames(Prolifera_Patch_2007_donut) <- c("Value")
Prolifera_Patch_2007_donut <- Prolifera_Patch_2007_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2007_donut,"Prolifera_Patch_2007.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2007_donut_plot <- read.table("Prolifera_Patch_2007.csv", header=TRUE, sep=",")


Prolifera_Patch_2007_donut_plot_rounded <- Prolifera_Patch_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2007_donut_plot_test <- cbind(Prolifera_Patch_2007_donut_plot_rounded,Legend)


Prolifera_Patch_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2007.png", width = 6, height = 6)




Prolifera_Patch_2008 <- filter(Prolifera_Patch_plot, Year == 2008)
Prolifera_Patch_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2008_t <- t(Prolifera_Patch_2008)

Prolifera_Patch_2008_donut <- data.frame(Prolifera_Patch_2008_t)
colnames(Prolifera_Patch_2008_donut) <- c("Value")
Prolifera_Patch_2008_donut <- Prolifera_Patch_2008_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2008_donut,"Prolifera_Patch_2008.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2008_donut_plot <- read.table("Prolifera_Patch_2008.csv", header=TRUE, sep=",")


Prolifera_Patch_2008_donut_plot_rounded <- Prolifera_Patch_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2008_donut_plot_test <- cbind(Prolifera_Patch_2008_donut_plot_rounded,Legend)


Prolifera_Patch_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Prolifera_Patch_2008.png", width = 6, height = 6)




Prolifera_Patch_2009 <- filter(Prolifera_Patch_plot, Year == 2009)
Prolifera_Patch_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2009_t <- t(Prolifera_Patch_2009)

Prolifera_Patch_2009_donut <- data.frame(Prolifera_Patch_2009_t)
colnames(Prolifera_Patch_2009_donut) <- c("Value")
Prolifera_Patch_2009_donut <- Prolifera_Patch_2009_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2009_donut,"Prolifera_Patch_2009.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2009_donut_plot <- read.table("Prolifera_Patch_2009.csv", header=TRUE, sep=",")


Prolifera_Patch_2009_donut_plot_rounded <- Prolifera_Patch_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2009_donut_plot_test <- cbind(Prolifera_Patch_2009_donut_plot_rounded,Legend)


Prolifera_Patch_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2009.png", width = 6, height = 6)




Prolifera_Patch_2010 <- filter(Prolifera_Patch_plot, Year == 2010)
Prolifera_Patch_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2010_t <- t(Prolifera_Patch_2010)

Prolifera_Patch_2010_donut <- data.frame(Prolifera_Patch_2010_t)
colnames(Prolifera_Patch_2010_donut) <- c("Value")
Prolifera_Patch_2010_donut <- Prolifera_Patch_2010_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2010_donut,"Prolifera_Patch_2010.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2010_donut_plot <- read.table("Prolifera_Patch_2010.csv", header=TRUE, sep=",")


Prolifera_Patch_2010_donut_plot_rounded <- Prolifera_Patch_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2010_donut_plot_test <- cbind(Prolifera_Patch_2010_donut_plot_rounded,Legend)


Prolifera_Patch_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2010.png", width = 6, height = 6)




Prolifera_Patch_2011 <- filter(Prolifera_Patch_plot, Year == 2011)
Prolifera_Patch_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2011_t <- t(Prolifera_Patch_2011)

Prolifera_Patch_2011_donut <- data.frame(Prolifera_Patch_2011_t)
colnames(Prolifera_Patch_2011_donut) <- c("Value")
Prolifera_Patch_2011_donut <- Prolifera_Patch_2011_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2011_donut,"Prolifera_Patch_2011.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2011_donut_plot <- read.table("Prolifera_Patch_2011.csv", header=TRUE, sep=",")


Prolifera_Patch_2011_donut_plot_rounded <- Prolifera_Patch_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2011_donut_plot_test <- cbind(Prolifera_Patch_2011_donut_plot_rounded,Legend)


Prolifera_Patch_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2011.png", width = 6, height = 6)





Prolifera_Patch_2012 <- filter(Prolifera_Patch_plot, Year == 2012)
Prolifera_Patch_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2012_t <- t(Prolifera_Patch_2012)

Prolifera_Patch_2012_donut <- data.frame(Prolifera_Patch_2012_t)
colnames(Prolifera_Patch_2012_donut) <- c("Value")
Prolifera_Patch_2012_donut <- Prolifera_Patch_2012_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2012_donut,"Prolifera_Patch_2012.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2012_donut_plot <- read.table("Prolifera_Patch_2012.csv", header=TRUE, sep=",")


Prolifera_Patch_2012_donut_plot_rounded <- Prolifera_Patch_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2012_donut_plot_test <- cbind(Prolifera_Patch_2012_donut_plot_rounded,Legend)


Prolifera_Patch_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Prolifera_Patch_2012.png", width = 6, height = 6)






Prolifera_Patch_2014 <- filter(Prolifera_Patch_plot, Year == 2014)
Prolifera_Patch_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2014_t <- t(Prolifera_Patch_2014)

Prolifera_Patch_2014_donut <- data.frame(Prolifera_Patch_2014_t)
colnames(Prolifera_Patch_2014_donut) <- c("Value")
Prolifera_Patch_2014_donut <- Prolifera_Patch_2014_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2014_donut,"Prolifera_Patch_2014.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2014_donut_plot <- read.table("Prolifera_Patch_2014.csv", header=TRUE, sep=",")


Prolifera_Patch_2014_donut_plot_rounded <- Prolifera_Patch_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2014_donut_plot_test <- cbind(Prolifera_Patch_2014_donut_plot_rounded,Legend)


Prolifera_Patch_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Prolifera_Patch_2014.png", width = 6, height = 6)





Prolifera_Patch_2016 <- filter(Prolifera_Patch_plot, Year == 2016)
Prolifera_Patch_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Prolifera_Patch_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2016_t <- t(Prolifera_Patch_2016)

Prolifera_Patch_2016_donut <- data.frame(Prolifera_Patch_2016_t)
colnames(Prolifera_Patch_2016_donut) <- c("Value")
Prolifera_Patch_2016_donut <- Prolifera_Patch_2016_donut %>%
  rownames_to_column(var = "Category")


export(Prolifera_Patch_2016_donut,"Prolifera_Patch_2016.csv")


### import as csv (change category and value to the two column names)

Prolifera_Patch_2016_donut_plot <- read.table("Prolifera_Patch_2016.csv", header=TRUE, sep=",")


Prolifera_Patch_2016_donut_plot_rounded <- Prolifera_Patch_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Prolifera_Patch_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Prolifera_Patch_2016_donut_plot_test <- cbind(Prolifera_Patch_2016_donut_plot_rounded,Legend)


Prolifera_Patch_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Prolifera Patch 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Prolifera_Patch_2016.png", width = 6, height = 6)




Temptation_Rock <- filter(RVC_CREMP, sitename == "Temptation Rock")

## Make percentages of sum, stony coral cover, and macroalgae

Temptation_Rock_fish <- Temptation_Rock$sum/max(Temptation_Rock$sum)
Temptation_Rock_biomass <- data.frame(Temptation_Rock_fish)

Temptation_Rock_biomass <- 100*Temptation_Rock_biomass


Temptation_Rock_Stony <- Temptation_Rock$Stony_coral/max(Temptation_Rock$Stony_coral)
Temptation_Rock_coral <- data.frame(Temptation_Rock_Stony)

Temptation_Rock_stony_coral <- 100*Temptation_Rock_coral

Temptation_Rock_macro <- Temptation_Rock$Macroalgae/max(Temptation_Rock$Macroalgae)
Temptation_Rock_algae <- data.frame(Temptation_Rock_macro)


Temptation_Rock_macroalgae <- (100*Temptation_Rock_algae)


Temptation_Rock_plot <- cbind(Temptation_Rock_macroalgae,Temptation_Rock_biomass,Temptation_Rock_stony_coral)

Temptation_Rock_plot$Year <- c("2004","2006","2008","2012","2014")

### Filter per year

Temptation_Rock_1999 <- filter(Temptation_Rock_plot, Year == 1999)
Temptation_Rock_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_1999_t <- t(Temptation_Rock_1999)

Temptation_Rock_1999_donut <- data.frame(Temptation_Rock_1999_t)
colnames(Temptation_Rock_1999_donut) <- c("Value")
Temptation_Rock_1999_donut <- Temptation_Rock_1999_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_1999_donut,"Temptation_Rock_1999.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_1999_donut_plot <- read.table("Temptation_Rock_1999.csv", header=TRUE, sep=",")


Temptation_Rock_1999_donut_plot_rounded <- Temptation_Rock_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_1999_donut_plot_test <- cbind(Temptation_Rock_1999_donut_plot_rounded,Legend)


Temptation_Rock_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_1999.png", width = 6, height = 6)



### Temptation Rock


Temptation_Rock_2000 <- filter(Temptation_Rock_plot, Year == 2000)
Temptation_Rock_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2000_t <- t(Temptation_Rock_2000)

Temptation_Rock_2000_donut <- data.frame(Temptation_Rock_2000_t)
colnames(Temptation_Rock_2000_donut) <- c("Value")
Temptation_Rock_2000_donut <- Temptation_Rock_2000_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2000_donut,"Temptation_Rock_2000.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2000_donut_plot <- read.table("Temptation_Rock_2000.csv", header=TRUE, sep=",")


Temptation_Rock_2000_donut_plot_rounded <- Temptation_Rock_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2000_donut_plot_test <- cbind(Temptation_Rock_2000_donut_plot_rounded,Legend)


Temptation_Rock_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2000.png", width = 6, height = 6)




Temptation_Rock_2001 <- filter(Temptation_Rock_plot, Year == 2001)
Temptation_Rock_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2001_t <- t(Temptation_Rock_2001)

Temptation_Rock_2001_donut <- data.frame(Temptation_Rock_2001_t)
colnames(Temptation_Rock_2001_donut) <- c("Value")
Temptation_Rock_2001_donut <- Temptation_Rock_2001_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2001_donut,"Temptation_Rock_2001.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2001_donut_plot <- read.table("Temptation_Rock_2001.csv", header=TRUE, sep=",")


Temptation_Rock_2001_donut_plot_rounded <- Temptation_Rock_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2001_donut_plot_test <- cbind(Temptation_Rock_2001_donut_plot_rounded,Legend)


Temptation_Rock_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2001.png", width = 6, height = 6)





Temptation_Rock_2002 <- filter(Temptation_Rock_plot, Year == 2002)
Temptation_Rock_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2002_t <- t(Temptation_Rock_2002)

Temptation_Rock_2002_donut <- data.frame(Temptation_Rock_2002_t)
colnames(Temptation_Rock_2002_donut) <- c("Value")
Temptation_Rock_2002_donut <- Temptation_Rock_2002_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2002_donut,"Temptation_Rock_2002.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2002_donut_plot <- read.table("Temptation_Rock_2002.csv", header=TRUE, sep=",")


Temptation_Rock_2002_donut_plot_rounded <- Temptation_Rock_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2002_donut_plot_test <- cbind(Temptation_Rock_2002_donut_plot_rounded,Legend)


Temptation_Rock_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2002.png", width = 6, height = 6)



Temptation_Rock_2003 <- filter(Temptation_Rock_plot, Year == 2003)
Temptation_Rock_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2003_t <- t(Temptation_Rock_2003)

Temptation_Rock_2003_donut <- data.frame(Temptation_Rock_2003_t)
colnames(Temptation_Rock_2003_donut) <- c("Value")
Temptation_Rock_2003_donut <- Temptation_Rock_2003_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2003_donut,"Temptation_Rock_2003.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2003_donut_plot <- read.table("Temptation_Rock_2003.csv", header=TRUE, sep=",")


Temptation_Rock_2003_donut_plot_rounded <- Temptation_Rock_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2003_donut_plot_test <- cbind(Temptation_Rock_2003_donut_plot_rounded,Legend)


Temptation_Rock_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2003.png", width = 6, height = 6)




Temptation_Rock_2004 <- filter(Temptation_Rock_plot, Year == 2004)
Temptation_Rock_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2004_t <- t(Temptation_Rock_2004)

Temptation_Rock_2004_donut <- data.frame(Temptation_Rock_2004_t)
colnames(Temptation_Rock_2004_donut) <- c("Value")
Temptation_Rock_2004_donut <- Temptation_Rock_2004_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2004_donut,"Temptation_Rock_2004.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2004_donut_plot <- read.table("Temptation_Rock_2004.csv", header=TRUE, sep=",")


Temptation_Rock_2004_donut_plot_rounded <- Temptation_Rock_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2004_donut_plot_test <- cbind(Temptation_Rock_2004_donut_plot_rounded,Legend)


Temptation_Rock_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Temptation_Rock_2004.png", width = 6, height = 6)




Temptation_Rock_2005 <- filter(Temptation_Rock_plot, Year == 2005)
Temptation_Rock_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2005_t <- t(Temptation_Rock_2005)

Temptation_Rock_2005_donut <- data.frame(Temptation_Rock_2005_t)
colnames(Temptation_Rock_2005_donut) <- c("Value")
Temptation_Rock_2005_donut <- Temptation_Rock_2005_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2005_donut,"Temptation_Rock_2005.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2005_donut_plot <- read.table("Temptation_Rock_2005.csv", header=TRUE, sep=",")


Temptation_Rock_2005_donut_plot_rounded <- Temptation_Rock_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2005_donut_plot_test <- cbind(Temptation_Rock_2005_donut_plot_rounded,Legend)


Temptation_Rock_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2005.png", width = 6, height = 6)





Temptation_Rock_2006 <- filter(Temptation_Rock_plot, Year == 2006)
Temptation_Rock_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2006_t <- t(Temptation_Rock_2006)

Temptation_Rock_2006_donut <- data.frame(Temptation_Rock_2006_t)
colnames(Temptation_Rock_2006_donut) <- c("Value")
Temptation_Rock_2006_donut <- Temptation_Rock_2006_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2006_donut,"Temptation_Rock_2006.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2006_donut_plot <- read.table("Temptation_Rock_2006.csv", header=TRUE, sep=",")


Temptation_Rock_2006_donut_plot_rounded <- Temptation_Rock_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2006_donut_plot_test <- cbind(Temptation_Rock_2006_donut_plot_rounded,Legend)


Temptation_Rock_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Temptation_Rock_2006.png", width = 6, height = 6)




Temptation_Rock_2007 <- filter(Temptation_Rock_plot, Year == 2007)
Temptation_Rock_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2007_t <- t(Temptation_Rock_2007)

Temptation_Rock_2007_donut <- data.frame(Temptation_Rock_2007_t)
colnames(Temptation_Rock_2007_donut) <- c("Value")
Temptation_Rock_2007_donut <- Temptation_Rock_2007_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2007_donut,"Temptation_Rock_2007.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2007_donut_plot <- read.table("Temptation_Rock_2007.csv", header=TRUE, sep=",")


Temptation_Rock_2007_donut_plot_rounded <- Temptation_Rock_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2007_donut_plot_test <- cbind(Temptation_Rock_2007_donut_plot_rounded,Legend)


Temptation_Rock_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2007.png", width = 6, height = 6)




Temptation_Rock_2008 <- filter(Temptation_Rock_plot, Year == 2008)
Temptation_Rock_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2008_t <- t(Temptation_Rock_2008)

Temptation_Rock_2008_donut <- data.frame(Temptation_Rock_2008_t)
colnames(Temptation_Rock_2008_donut) <- c("Value")
Temptation_Rock_2008_donut <- Temptation_Rock_2008_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2008_donut,"Temptation_Rock_2008.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2008_donut_plot <- read.table("Temptation_Rock_2008.csv", header=TRUE, sep=",")


Temptation_Rock_2008_donut_plot_rounded <- Temptation_Rock_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2008_donut_plot_test <- cbind(Temptation_Rock_2008_donut_plot_rounded,Legend)


Temptation_Rock_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Temptation_Rock_2008.png", width = 6, height = 6)




Temptation_Rock_2009 <- filter(Temptation_Rock_plot, Year == 2009)
Temptation_Rock_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2009_t <- t(Temptation_Rock_2009)

Temptation_Rock_2009_donut <- data.frame(Temptation_Rock_2009_t)
colnames(Temptation_Rock_2009_donut) <- c("Value")
Temptation_Rock_2009_donut <- Temptation_Rock_2009_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2009_donut,"Temptation_Rock_2009.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2009_donut_plot <- read.table("Temptation_Rock_2009.csv", header=TRUE, sep=",")


Temptation_Rock_2009_donut_plot_rounded <- Temptation_Rock_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2009_donut_plot_test <- cbind(Temptation_Rock_2009_donut_plot_rounded,Legend)


Temptation_Rock_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2009.png", width = 6, height = 6)




Temptation_Rock_2010 <- filter(Temptation_Rock_plot, Year == 2010)
Temptation_Rock_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2010_t <- t(Temptation_Rock_2010)

Temptation_Rock_2010_donut <- data.frame(Temptation_Rock_2010_t)
colnames(Temptation_Rock_2010_donut) <- c("Value")
Temptation_Rock_2010_donut <- Temptation_Rock_2010_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2010_donut,"Temptation_Rock_2010.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2010_donut_plot <- read.table("Temptation_Rock_2010.csv", header=TRUE, sep=",")


Temptation_Rock_2010_donut_plot_rounded <- Temptation_Rock_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2010_donut_plot_test <- cbind(Temptation_Rock_2010_donut_plot_rounded,Legend)


Temptation_Rock_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2010.png", width = 6, height = 6)




Temptation_Rock_2011 <- filter(Temptation_Rock_plot, Year == 2011)
Temptation_Rock_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2011_t <- t(Temptation_Rock_2011)

Temptation_Rock_2011_donut <- data.frame(Temptation_Rock_2011_t)
colnames(Temptation_Rock_2011_donut) <- c("Value")
Temptation_Rock_2011_donut <- Temptation_Rock_2011_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2011_donut,"Temptation_Rock_2011.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2011_donut_plot <- read.table("Temptation_Rock_2011.csv", header=TRUE, sep=",")


Temptation_Rock_2011_donut_plot_rounded <- Temptation_Rock_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2011_donut_plot_test <- cbind(Temptation_Rock_2011_donut_plot_rounded,Legend)


Temptation_Rock_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2011.png", width = 6, height = 6)





Temptation_Rock_2012 <- filter(Temptation_Rock_plot, Year == 2012)
Temptation_Rock_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2012_t <- t(Temptation_Rock_2012)

Temptation_Rock_2012_donut <- data.frame(Temptation_Rock_2012_t)
colnames(Temptation_Rock_2012_donut) <- c("Value")
Temptation_Rock_2012_donut <- Temptation_Rock_2012_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2012_donut,"Temptation_Rock_2012.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2012_donut_plot <- read.table("Temptation_Rock_2012.csv", header=TRUE, sep=",")


Temptation_Rock_2012_donut_plot_rounded <- Temptation_Rock_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2012_donut_plot_test <- cbind(Temptation_Rock_2012_donut_plot_rounded,Legend)


Temptation_Rock_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Temptation_Rock_2012.png", width = 6, height = 6)






Temptation_Rock_2014 <- filter(Temptation_Rock_plot, Year == 2014)
Temptation_Rock_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2014_t <- t(Temptation_Rock_2014)

Temptation_Rock_2014_donut <- data.frame(Temptation_Rock_2014_t)
colnames(Temptation_Rock_2014_donut) <- c("Value")
Temptation_Rock_2014_donut <- Temptation_Rock_2014_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2014_donut,"Temptation_Rock_2014.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2014_donut_plot <- read.table("Temptation_Rock_2014.csv", header=TRUE, sep=",")


Temptation_Rock_2014_donut_plot_rounded <- Temptation_Rock_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2014_donut_plot_test <- cbind(Temptation_Rock_2014_donut_plot_rounded,Legend)


Temptation_Rock_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Temptation_Rock_2014.png", width = 6, height = 6)





Temptation_Rock_2016 <- filter(Temptation_Rock_plot, Year == 2016)
Temptation_Rock_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Temptation_Rock_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2016_t <- t(Temptation_Rock_2016)

Temptation_Rock_2016_donut <- data.frame(Temptation_Rock_2016_t)
colnames(Temptation_Rock_2016_donut) <- c("Value")
Temptation_Rock_2016_donut <- Temptation_Rock_2016_donut %>%
  rownames_to_column(var = "Category")


export(Temptation_Rock_2016_donut,"Temptation_Rock_2016.csv")


### import as csv (change category and value to the two column names)

Temptation_Rock_2016_donut_plot <- read.table("Temptation_Rock_2016.csv", header=TRUE, sep=",")


Temptation_Rock_2016_donut_plot_rounded <- Temptation_Rock_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Temptation_Rock_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Temptation_Rock_2016_donut_plot_test <- cbind(Temptation_Rock_2016_donut_plot_rounded,Legend)


Temptation_Rock_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Temptation Rock 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Temptation_Rock_2016.png", width = 6, height = 6)




Texas_Rock <- filter(RVC_CREMP, sitename == "Texas Rock")

## Make percentages of sum, stony coral cover, and macroalgae

Texas_Rock_fish <- Texas_Rock$sum/max(Texas_Rock$sum)
Texas_Rock_biomass <- data.frame(Texas_Rock_fish)

Texas_Rock_biomass <- 100*Texas_Rock_biomass


Texas_Rock_Stony <- Texas_Rock$Stony_coral/max(Texas_Rock$Stony_coral)
Texas_Rock_coral <- data.frame(Texas_Rock_Stony)

Texas_Rock_stony_coral <- 100*Texas_Rock_coral

Texas_Rock_macro <- Texas_Rock$Macroalgae/max(Texas_Rock$Macroalgae)
Texas_Rock_algae <- data.frame(Texas_Rock_macro)


Texas_Rock_macroalgae <- (100*Texas_Rock_algae)


Texas_Rock_plot <- cbind(Texas_Rock_macroalgae,Texas_Rock_biomass,Texas_Rock_stony_coral)

Texas_Rock_plot$Year <- c("2010","2014")

### Filter per year

Texas_Rock_1999 <- filter(Texas_Rock_plot, Year == 1999)
Texas_Rock_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_1999_t <- t(Texas_Rock_1999)

Texas_Rock_1999_donut <- data.frame(Texas_Rock_1999_t)
colnames(Texas_Rock_1999_donut) <- c("Value")
Texas_Rock_1999_donut <- Texas_Rock_1999_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_1999_donut,"Texas_Rock_1999.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_1999_donut_plot <- read.table("Texas_Rock_1999.csv", header=TRUE, sep=",")


Texas_Rock_1999_donut_plot_rounded <- Texas_Rock_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_1999_donut_plot_test <- cbind(Texas_Rock_1999_donut_plot_rounded,Legend)


Texas_Rock_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_1999.png", width = 6, height = 6)



### Texas Rock


Texas_Rock_2000 <- filter(Texas_Rock_plot, Year == 2000)
Texas_Rock_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2000_t <- t(Texas_Rock_2000)

Texas_Rock_2000_donut <- data.frame(Texas_Rock_2000_t)
colnames(Texas_Rock_2000_donut) <- c("Value")
Texas_Rock_2000_donut <- Texas_Rock_2000_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2000_donut,"Texas_Rock_2000.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2000_donut_plot <- read.table("Texas_Rock_2000.csv", header=TRUE, sep=",")


Texas_Rock_2000_donut_plot_rounded <- Texas_Rock_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2000_donut_plot_test <- cbind(Texas_Rock_2000_donut_plot_rounded,Legend)


Texas_Rock_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2000.png", width = 6, height = 6)




Texas_Rock_2001 <- filter(Texas_Rock_plot, Year == 2001)
Texas_Rock_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2001_t <- t(Texas_Rock_2001)

Texas_Rock_2001_donut <- data.frame(Texas_Rock_2001_t)
colnames(Texas_Rock_2001_donut) <- c("Value")
Texas_Rock_2001_donut <- Texas_Rock_2001_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2001_donut,"Texas_Rock_2001.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2001_donut_plot <- read.table("Texas_Rock_2001.csv", header=TRUE, sep=",")


Texas_Rock_2001_donut_plot_rounded <- Texas_Rock_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2001_donut_plot_test <- cbind(Texas_Rock_2001_donut_plot_rounded,Legend)


Texas_Rock_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2001.png", width = 6, height = 6)





Texas_Rock_2002 <- filter(Texas_Rock_plot, Year == 2002)
Texas_Rock_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2002_t <- t(Texas_Rock_2002)

Texas_Rock_2002_donut <- data.frame(Texas_Rock_2002_t)
colnames(Texas_Rock_2002_donut) <- c("Value")
Texas_Rock_2002_donut <- Texas_Rock_2002_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2002_donut,"Texas_Rock_2002.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2002_donut_plot <- read.table("Texas_Rock_2002.csv", header=TRUE, sep=",")


Texas_Rock_2002_donut_plot_rounded <- Texas_Rock_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2002_donut_plot_test <- cbind(Texas_Rock_2002_donut_plot_rounded,Legend)


Texas_Rock_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2002.png", width = 6, height = 6)



Texas_Rock_2003 <- filter(Texas_Rock_plot, Year == 2003)
Texas_Rock_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2003_t <- t(Texas_Rock_2003)

Texas_Rock_2003_donut <- data.frame(Texas_Rock_2003_t)
colnames(Texas_Rock_2003_donut) <- c("Value")
Texas_Rock_2003_donut <- Texas_Rock_2003_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2003_donut,"Texas_Rock_2003.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2003_donut_plot <- read.table("Texas_Rock_2003.csv", header=TRUE, sep=",")


Texas_Rock_2003_donut_plot_rounded <- Texas_Rock_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2003_donut_plot_test <- cbind(Texas_Rock_2003_donut_plot_rounded,Legend)


Texas_Rock_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2003.png", width = 6, height = 6)




Texas_Rock_2004 <- filter(Texas_Rock_plot, Year == 2004)
Texas_Rock_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2004_t <- t(Texas_Rock_2004)

Texas_Rock_2004_donut <- data.frame(Texas_Rock_2004_t)
colnames(Texas_Rock_2004_donut) <- c("Value")
Texas_Rock_2004_donut <- Texas_Rock_2004_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2004_donut,"Texas_Rock_2004.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2004_donut_plot <- read.table("Texas_Rock_2004.csv", header=TRUE, sep=",")


Texas_Rock_2004_donut_plot_rounded <- Texas_Rock_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2004_donut_plot_test <- cbind(Texas_Rock_2004_donut_plot_rounded,Legend)


Texas_Rock_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2004.png", width = 6, height = 6)




Texas_Rock_2005 <- filter(Texas_Rock_plot, Year == 2005)
Texas_Rock_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2005_t <- t(Texas_Rock_2005)

Texas_Rock_2005_donut <- data.frame(Texas_Rock_2005_t)
colnames(Texas_Rock_2005_donut) <- c("Value")
Texas_Rock_2005_donut <- Texas_Rock_2005_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2005_donut,"Texas_Rock_2005.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2005_donut_plot <- read.table("Texas_Rock_2005.csv", header=TRUE, sep=",")


Texas_Rock_2005_donut_plot_rounded <- Texas_Rock_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2005_donut_plot_test <- cbind(Texas_Rock_2005_donut_plot_rounded,Legend)


Texas_Rock_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2005.png", width = 6, height = 6)





Texas_Rock_2006 <- filter(Texas_Rock_plot, Year == 2006)
Texas_Rock_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2006_t <- t(Texas_Rock_2006)

Texas_Rock_2006_donut <- data.frame(Texas_Rock_2006_t)
colnames(Texas_Rock_2006_donut) <- c("Value")
Texas_Rock_2006_donut <- Texas_Rock_2006_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2006_donut,"Texas_Rock_2006.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2006_donut_plot <- read.table("Texas_Rock_2006.csv", header=TRUE, sep=",")


Texas_Rock_2006_donut_plot_rounded <- Texas_Rock_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2006_donut_plot_test <- cbind(Texas_Rock_2006_donut_plot_rounded,Legend)


Texas_Rock_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2006.png", width = 6, height = 6)




Texas_Rock_2007 <- filter(Texas_Rock_plot, Year == 2007)
Texas_Rock_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2007_t <- t(Texas_Rock_2007)

Texas_Rock_2007_donut <- data.frame(Texas_Rock_2007_t)
colnames(Texas_Rock_2007_donut) <- c("Value")
Texas_Rock_2007_donut <- Texas_Rock_2007_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2007_donut,"Texas_Rock_2007.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2007_donut_plot <- read.table("Texas_Rock_2007.csv", header=TRUE, sep=",")


Texas_Rock_2007_donut_plot_rounded <- Texas_Rock_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2007_donut_plot_test <- cbind(Texas_Rock_2007_donut_plot_rounded,Legend)


Texas_Rock_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2007.png", width = 6, height = 6)




Texas_Rock_2008 <- filter(Texas_Rock_plot, Year == 2008)
Texas_Rock_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2008_t <- t(Texas_Rock_2008)

Texas_Rock_2008_donut <- data.frame(Texas_Rock_2008_t)
colnames(Texas_Rock_2008_donut) <- c("Value")
Texas_Rock_2008_donut <- Texas_Rock_2008_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2008_donut,"Texas_Rock_2008.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2008_donut_plot <- read.table("Texas_Rock_2008.csv", header=TRUE, sep=",")


Texas_Rock_2008_donut_plot_rounded <- Texas_Rock_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2008_donut_plot_test <- cbind(Texas_Rock_2008_donut_plot_rounded,Legend)


Texas_Rock_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2008.png", width = 6, height = 6)




Texas_Rock_2009 <- filter(Texas_Rock_plot, Year == 2009)
Texas_Rock_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2009_t <- t(Texas_Rock_2009)

Texas_Rock_2009_donut <- data.frame(Texas_Rock_2009_t)
colnames(Texas_Rock_2009_donut) <- c("Value")
Texas_Rock_2009_donut <- Texas_Rock_2009_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2009_donut,"Texas_Rock_2009.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2009_donut_plot <- read.table("Texas_Rock_2009.csv", header=TRUE, sep=",")


Texas_Rock_2009_donut_plot_rounded <- Texas_Rock_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2009_donut_plot_test <- cbind(Texas_Rock_2009_donut_plot_rounded,Legend)


Texas_Rock_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2009.png", width = 6, height = 6)




Texas_Rock_2010 <- filter(Texas_Rock_plot, Year == 2010)
Texas_Rock_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2010_t <- t(Texas_Rock_2010)

Texas_Rock_2010_donut <- data.frame(Texas_Rock_2010_t)
colnames(Texas_Rock_2010_donut) <- c("Value")
Texas_Rock_2010_donut <- Texas_Rock_2010_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2010_donut,"Texas_Rock_2010.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2010_donut_plot <- read.table("Texas_Rock_2010.csv", header=TRUE, sep=",")


Texas_Rock_2010_donut_plot_rounded <- Texas_Rock_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2010_donut_plot_test <- cbind(Texas_Rock_2010_donut_plot_rounded,Legend)


Texas_Rock_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Texas_Rock_2010.png", width = 6, height = 6)




Texas_Rock_2011 <- filter(Texas_Rock_plot, Year == 2011)
Texas_Rock_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2011_t <- t(Texas_Rock_2011)

Texas_Rock_2011_donut <- data.frame(Texas_Rock_2011_t)
colnames(Texas_Rock_2011_donut) <- c("Value")
Texas_Rock_2011_donut <- Texas_Rock_2011_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2011_donut,"Texas_Rock_2011.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2011_donut_plot <- read.table("Texas_Rock_2011.csv", header=TRUE, sep=",")


Texas_Rock_2011_donut_plot_rounded <- Texas_Rock_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2011_donut_plot_test <- cbind(Texas_Rock_2011_donut_plot_rounded,Legend)


Texas_Rock_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2011.png", width = 6, height = 6)





Texas_Rock_2012 <- filter(Texas_Rock_plot, Year == 2012)
Texas_Rock_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2012_t <- t(Texas_Rock_2012)

Texas_Rock_2012_donut <- data.frame(Texas_Rock_2012_t)
colnames(Texas_Rock_2012_donut) <- c("Value")
Texas_Rock_2012_donut <- Texas_Rock_2012_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2012_donut,"Texas_Rock_2012.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2012_donut_plot <- read.table("Texas_Rock_2012.csv", header=TRUE, sep=",")


Texas_Rock_2012_donut_plot_rounded <- Texas_Rock_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2012_donut_plot_test <- cbind(Texas_Rock_2012_donut_plot_rounded,Legend)


Texas_Rock_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2012.png", width = 6, height = 6)






Texas_Rock_2014 <- filter(Texas_Rock_plot, Year == 2014)
Texas_Rock_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2014_t <- t(Texas_Rock_2014)

Texas_Rock_2014_donut <- data.frame(Texas_Rock_2014_t)
colnames(Texas_Rock_2014_donut) <- c("Value")
Texas_Rock_2014_donut <- Texas_Rock_2014_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2014_donut,"Texas_Rock_2014.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2014_donut_plot <- read.table("Texas_Rock_2014.csv", header=TRUE, sep=",")


Texas_Rock_2014_donut_plot_rounded <- Texas_Rock_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2014_donut_plot_test <- cbind(Texas_Rock_2014_donut_plot_rounded,Legend)


Texas_Rock_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Texas_Rock_2014.png", width = 6, height = 6)





Texas_Rock_2016 <- filter(Texas_Rock_plot, Year == 2016)
Texas_Rock_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Texas_Rock_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2016_t <- t(Texas_Rock_2016)

Texas_Rock_2016_donut <- data.frame(Texas_Rock_2016_t)
colnames(Texas_Rock_2016_donut) <- c("Value")
Texas_Rock_2016_donut <- Texas_Rock_2016_donut %>%
  rownames_to_column(var = "Category")


export(Texas_Rock_2016_donut,"Texas_Rock_2016.csv")


### import as csv (change category and value to the two column names)

Texas_Rock_2016_donut_plot <- read.table("Texas_Rock_2016.csv", header=TRUE, sep=",")


Texas_Rock_2016_donut_plot_rounded <- Texas_Rock_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Texas_Rock_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Texas_Rock_2016_donut_plot_test <- cbind(Texas_Rock_2016_donut_plot_rounded,Legend)


Texas_Rock_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Texas Rock 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Texas_Rock_2016.png", width = 6, height = 6)




White_Shoal <- filter(RVC_CREMP, sitename == "White Shoal")

## Make percentages of sum, stony coral cover, and macroalgae

White_Shoal_fish <- White_Shoal$sum/max(White_Shoal$sum)
White_Shoal_biomass <- data.frame(White_Shoal_fish)

White_Shoal_biomass <- 100*White_Shoal_biomass


White_Shoal_Stony <- White_Shoal$Stony_coral/max(White_Shoal$Stony_coral)
White_Shoal_coral <- data.frame(White_Shoal_Stony)

White_Shoal_stony_coral <- 100*White_Shoal_coral

White_Shoal_macro <- White_Shoal$Macroalgae/max(White_Shoal$Macroalgae)
White_Shoal_algae <- data.frame(White_Shoal_macro)


White_Shoal_macroalgae <- (100*White_Shoal_algae)


White_Shoal_plot <- cbind(White_Shoal_macroalgae,White_Shoal_biomass,White_Shoal_stony_coral)

White_Shoal_plot$Year <- c("1999","2000","2004","2006","2008","2012","2014")

### Filter per year

White_Shoal_1999 <- filter(White_Shoal_plot, Year == 1999)
White_Shoal_1999$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_1999) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_1999_t <- t(White_Shoal_1999)

White_Shoal_1999_donut <- data.frame(White_Shoal_1999_t)
colnames(White_Shoal_1999_donut) <- c("Value")
White_Shoal_1999_donut <- White_Shoal_1999_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_1999_donut,"White_Shoal_1999.csv")


### import as csv (change category and value to the two column names)

White_Shoal_1999_donut_plot <- read.table("White_Shoal_1999.csv", header=TRUE, sep=",")


White_Shoal_1999_donut_plot_rounded <- White_Shoal_1999_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_1999_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_1999_donut_plot_test <- cbind(White_Shoal_1999_donut_plot_rounded,Legend)


White_Shoal_1999_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 1999") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/White_Shoal_1999.png", width = 6, height = 6)



### White Shoal


White_Shoal_2000 <- filter(White_Shoal_plot, Year == 2000)
White_Shoal_2000$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2000) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2000_t <- t(White_Shoal_2000)

White_Shoal_2000_donut <- data.frame(White_Shoal_2000_t)
colnames(White_Shoal_2000_donut) <- c("Value")
White_Shoal_2000_donut <- White_Shoal_2000_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2000_donut,"White_Shoal_2000.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2000_donut_plot <- read.table("White_Shoal_2000.csv", header=TRUE, sep=",")


White_Shoal_2000_donut_plot_rounded <- White_Shoal_2000_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2000_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2000_donut_plot_test <- cbind(White_Shoal_2000_donut_plot_rounded,Legend)


White_Shoal_2000_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2000") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/White_Shoal_2000.png", width = 6, height = 6)




White_Shoal_2001 <- filter(White_Shoal_plot, Year == 2001)
White_Shoal_2001$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2001) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2001_t <- t(White_Shoal_2001)

White_Shoal_2001_donut <- data.frame(White_Shoal_2001_t)
colnames(White_Shoal_2001_donut) <- c("Value")
White_Shoal_2001_donut <- White_Shoal_2001_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2001_donut,"White_Shoal_2001.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2001_donut_plot <- read.table("White_Shoal_2001.csv", header=TRUE, sep=",")


White_Shoal_2001_donut_plot_rounded <- White_Shoal_2001_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2001_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2001_donut_plot_test <- cbind(White_Shoal_2001_donut_plot_rounded,Legend)


White_Shoal_2001_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2001") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2001.png", width = 6, height = 6)





White_Shoal_2002 <- filter(White_Shoal_plot, Year == 2002)
White_Shoal_2002$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2002) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2002_t <- t(White_Shoal_2002)

White_Shoal_2002_donut <- data.frame(White_Shoal_2002_t)
colnames(White_Shoal_2002_donut) <- c("Value")
White_Shoal_2002_donut <- White_Shoal_2002_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2002_donut,"White_Shoal_2002.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2002_donut_plot <- read.table("White_Shoal_2002.csv", header=TRUE, sep=",")


White_Shoal_2002_donut_plot_rounded <- White_Shoal_2002_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2002_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2002_donut_plot_test <- cbind(White_Shoal_2002_donut_plot_rounded,Legend)


White_Shoal_2002_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2002") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2002.png", width = 6, height = 6)



White_Shoal_2003 <- filter(White_Shoal_plot, Year == 2003)
White_Shoal_2003$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2003) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2003_t <- t(White_Shoal_2003)

White_Shoal_2003_donut <- data.frame(White_Shoal_2003_t)
colnames(White_Shoal_2003_donut) <- c("Value")
White_Shoal_2003_donut <- White_Shoal_2003_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2003_donut,"White_Shoal_2003.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2003_donut_plot <- read.table("White_Shoal_2003.csv", header=TRUE, sep=",")


White_Shoal_2003_donut_plot_rounded <- White_Shoal_2003_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2003_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2003_donut_plot_test <- cbind(White_Shoal_2003_donut_plot_rounded,Legend)


White_Shoal_2003_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2003") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2003.png", width = 6, height = 6)




White_Shoal_2004 <- filter(White_Shoal_plot, Year == 2004)
White_Shoal_2004$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2004) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2004_t <- t(White_Shoal_2004)

White_Shoal_2004_donut <- data.frame(White_Shoal_2004_t)
colnames(White_Shoal_2004_donut) <- c("Value")
White_Shoal_2004_donut <- White_Shoal_2004_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2004_donut,"White_Shoal_2004.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2004_donut_plot <- read.table("White_Shoal_2004.csv", header=TRUE, sep=",")


White_Shoal_2004_donut_plot_rounded <- White_Shoal_2004_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2004_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2004_donut_plot_test <- cbind(White_Shoal_2004_donut_plot_rounded,Legend)


White_Shoal_2004_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2004") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/White_Shoal_2004.png", width = 6, height = 6)




White_Shoal_2005 <- filter(White_Shoal_plot, Year == 2005)
White_Shoal_2005$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2005) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2005_t <- t(White_Shoal_2005)

White_Shoal_2005_donut <- data.frame(White_Shoal_2005_t)
colnames(White_Shoal_2005_donut) <- c("Value")
White_Shoal_2005_donut <- White_Shoal_2005_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2005_donut,"White_Shoal_2005.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2005_donut_plot <- read.table("White_Shoal_2005.csv", header=TRUE, sep=",")


White_Shoal_2005_donut_plot_rounded <- White_Shoal_2005_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2005_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2005_donut_plot_test <- cbind(White_Shoal_2005_donut_plot_rounded,Legend)


White_Shoal_2005_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2005") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2005.png", width = 6, height = 6)





White_Shoal_2006 <- filter(White_Shoal_plot, Year == 2006)
White_Shoal_2006$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2006) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2006_t <- t(White_Shoal_2006)

White_Shoal_2006_donut <- data.frame(White_Shoal_2006_t)
colnames(White_Shoal_2006_donut) <- c("Value")
White_Shoal_2006_donut <- White_Shoal_2006_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2006_donut,"White_Shoal_2006.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2006_donut_plot <- read.table("White_Shoal_2006.csv", header=TRUE, sep=",")


White_Shoal_2006_donut_plot_rounded <- White_Shoal_2006_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2006_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2006_donut_plot_test <- cbind(White_Shoal_2006_donut_plot_rounded,Legend)


White_Shoal_2006_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2006") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/White_Shoal_2006.png", width = 6, height = 6)




White_Shoal_2007 <- filter(White_Shoal_plot, Year == 2007)
White_Shoal_2007$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2007) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2007_t <- t(White_Shoal_2007)

White_Shoal_2007_donut <- data.frame(White_Shoal_2007_t)
colnames(White_Shoal_2007_donut) <- c("Value")
White_Shoal_2007_donut <- White_Shoal_2007_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2007_donut,"White_Shoal_2007.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2007_donut_plot <- read.table("White_Shoal_2007.csv", header=TRUE, sep=",")


White_Shoal_2007_donut_plot_rounded <- White_Shoal_2007_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2007_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2007_donut_plot_test <- cbind(White_Shoal_2007_donut_plot_rounded,Legend)


White_Shoal_2007_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2007") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2007.png", width = 6, height = 6)




White_Shoal_2008 <- filter(White_Shoal_plot, Year == 2008)
White_Shoal_2008$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2008) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2008_t <- t(White_Shoal_2008)

White_Shoal_2008_donut <- data.frame(White_Shoal_2008_t)
colnames(White_Shoal_2008_donut) <- c("Value")
White_Shoal_2008_donut <- White_Shoal_2008_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2008_donut,"White_Shoal_2008.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2008_donut_plot <- read.table("White_Shoal_2008.csv", header=TRUE, sep=",")


White_Shoal_2008_donut_plot_rounded <- White_Shoal_2008_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2008_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2008_donut_plot_test <- cbind(White_Shoal_2008_donut_plot_rounded,Legend)


White_Shoal_2008_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2008") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/White_Shoal_2008.png", width = 6, height = 6)




White_Shoal_2009 <- filter(White_Shoal_plot, Year == 2009)
White_Shoal_2009$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2009) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2009_t <- t(White_Shoal_2009)

White_Shoal_2009_donut <- data.frame(White_Shoal_2009_t)
colnames(White_Shoal_2009_donut) <- c("Value")
White_Shoal_2009_donut <- White_Shoal_2009_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2009_donut,"White_Shoal_2009.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2009_donut_plot <- read.table("White_Shoal_2009.csv", header=TRUE, sep=",")


White_Shoal_2009_donut_plot_rounded <- White_Shoal_2009_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2009_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2009_donut_plot_test <- cbind(White_Shoal_2009_donut_plot_rounded,Legend)


White_Shoal_2009_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2009") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2009.png", width = 6, height = 6)




White_Shoal_2010 <- filter(White_Shoal_plot, Year == 2010)
White_Shoal_2010$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2010) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2010_t <- t(White_Shoal_2010)

White_Shoal_2010_donut <- data.frame(White_Shoal_2010_t)
colnames(White_Shoal_2010_donut) <- c("Value")
White_Shoal_2010_donut <- White_Shoal_2010_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2010_donut,"White_Shoal_2010.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2010_donut_plot <- read.table("White_Shoal_2010.csv", header=TRUE, sep=",")


White_Shoal_2010_donut_plot_rounded <- White_Shoal_2010_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2010_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2010_donut_plot_test <- cbind(White_Shoal_2010_donut_plot_rounded,Legend)


White_Shoal_2010_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2010") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2010.png", width = 6, height = 6)




White_Shoal_2011 <- filter(White_Shoal_plot, Year == 2011)
White_Shoal_2011$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2011) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2011_t <- t(White_Shoal_2011)

White_Shoal_2011_donut <- data.frame(White_Shoal_2011_t)
colnames(White_Shoal_2011_donut) <- c("Value")
White_Shoal_2011_donut <- White_Shoal_2011_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2011_donut,"White_Shoal_2011.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2011_donut_plot <- read.table("White_Shoal_2011.csv", header=TRUE, sep=",")


White_Shoal_2011_donut_plot_rounded <- White_Shoal_2011_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2011_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2011_donut_plot_test <- cbind(White_Shoal_2011_donut_plot_rounded,Legend)


White_Shoal_2011_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2011") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2011.png", width = 6, height = 6)





White_Shoal_2012 <- filter(White_Shoal_plot, Year == 2012)
White_Shoal_2012$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2012) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2012_t <- t(White_Shoal_2012)

White_Shoal_2012_donut <- data.frame(White_Shoal_2012_t)
colnames(White_Shoal_2012_donut) <- c("Value")
White_Shoal_2012_donut <- White_Shoal_2012_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2012_donut,"White_Shoal_2012.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2012_donut_plot <- read.table("White_Shoal_2012.csv", header=TRUE, sep=",")


White_Shoal_2012_donut_plot_rounded <- White_Shoal_2012_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2012_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2012_donut_plot_test <- cbind(White_Shoal_2012_donut_plot_rounded,Legend)


White_Shoal_2012_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2012") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2012.png", width = 6, height = 6)






White_Shoal_2014 <- filter(White_Shoal_plot, Year == 2014)
White_Shoal_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2014_t <- t(White_Shoal_2014)

White_Shoal_2014_donut <- data.frame(White_Shoal_2014_t)
colnames(White_Shoal_2014_donut) <- c("Value")
White_Shoal_2014_donut <- White_Shoal_2014_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2014_donut,"White_Shoal_2014.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2014_donut_plot <- read.table("White_Shoal_2014.csv", header=TRUE, sep=",")


White_Shoal_2014_donut_plot_rounded <- White_Shoal_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2014_donut_plot_test <- cbind(White_Shoal_2014_donut_plot_rounded,Legend)


White_Shoal_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/White_Shoal_2014.png", width = 6, height = 6)





White_Shoal_2016 <- filter(White_Shoal_plot, Year == 2016)
White_Shoal_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(White_Shoal_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2016_t <- t(White_Shoal_2016)

White_Shoal_2016_donut <- data.frame(White_Shoal_2016_t)
colnames(White_Shoal_2016_donut) <- c("Value")
White_Shoal_2016_donut <- White_Shoal_2016_donut %>%
  rownames_to_column(var = "Category")


export(White_Shoal_2016_donut,"White_Shoal_2016.csv")


### import as csv (change category and value to the two column names)

White_Shoal_2016_donut_plot <- read.table("White_Shoal_2016.csv", header=TRUE, sep=",")


White_Shoal_2016_donut_plot_rounded <- White_Shoal_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
White_Shoal_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
White_Shoal_2016_donut_plot_test <- cbind(White_Shoal_2016_donut_plot_rounded,Legend)


White_Shoal_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "White Shoal 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/White_Shoal_2016.png", width = 6, height = 6)



setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/DT/plots")


library(gridExtra)
library(png)
library(grid)

pdf('DT.pdf')
lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  grid.newpage()
  grid.raster(img, interpolate = FALSE)
  
})
dev.off()

plots <- lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  rasterGrob(img, interpolate = FALSE)
})

ggsave("DT_combined.pdf", marrangeGrob(grobs=plots, nrow=2, ncol=4))




### SE Florida 

setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/SEF")




Broward_County_1 <- filter(RVC_CREMP, sitename == "Broward County 1")

## Make percentages of sum, stony coral cover, and macroalgae

Broward_County_1_fish <- Broward_County_1$sum/max(Broward_County_1$sum)
Broward_County_1_biomass <- data.frame(Broward_County_1_fish)

Broward_County_1_biomass <- 100*Broward_County_1_biomass


Broward_County_1_Stony <- Broward_County_1$Stony_coral/max(Broward_County_1$Stony_coral)
Broward_County_1_coral <- data.frame(Broward_County_1_Stony)

Broward_County_1_stony_coral <- 100*Broward_County_1_coral

Broward_County_1_macro <- Broward_County_1$Macroalgae/max(Broward_County_1$Macroalgae)
Broward_County_1_algae <- data.frame(Broward_County_1_macro)


Broward_County_1_macroalgae <- (100*Broward_County_1_algae)


Broward_County_1_plot <- cbind(Broward_County_1_macroalgae,Broward_County_1_biomass,Broward_County_1_stony_coral)

Broward_County_1_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Broward_County_1_2013 <- filter(Broward_County_1_plot, Year == 2013)
Broward_County_1_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_1_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_1_2013_t <- t(Broward_County_1_2013)

Broward_County_1_2013_donut <- data.frame(Broward_County_1_2013_t)
colnames(Broward_County_1_2013_donut) <- c("Value")
Broward_County_1_2013_donut <- Broward_County_1_2013_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_1_2013_donut,"Broward_County_1_2013.csv")


### import as csv (change category and value to the two column names)

Broward_County_1_2013_donut_plot <- read.table("Broward_County_1_2013.csv", header=TRUE, sep=",")


Broward_County_1_2013_donut_plot_rounded <- Broward_County_1_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_1_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_1_2013_donut_plot_test <- cbind(Broward_County_1_2013_donut_plot_rounded,Legend)


Broward_County_1_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 1 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_1_2013.png", width = 6, height = 6)





Broward_County_1_2014 <- filter(Broward_County_1_plot, Year == 2014)
Broward_County_1_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_1_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_1_2014_t <- t(Broward_County_1_2014)

Broward_County_1_2014_donut <- data.frame(Broward_County_1_2014_t)
colnames(Broward_County_1_2014_donut) <- c("Value")
Broward_County_1_2014_donut <- Broward_County_1_2014_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_1_2014_donut,"Broward_County_1_2014.csv")


### import as csv (change category and value to the two column names)

Broward_County_1_2014_donut_plot <- read.table("Broward_County_1_2014.csv", header=TRUE, sep=",")


Broward_County_1_2014_donut_plot_rounded <- Broward_County_1_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_1_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_1_2014_donut_plot_test <- cbind(Broward_County_1_2014_donut_plot_rounded,Legend)


Broward_County_1_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 1 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_1_2014.png", width = 6, height = 6)





Broward_County_1_2015 <- filter(Broward_County_1_plot, Year == 2015)
Broward_County_1_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_1_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_1_2015_t <- t(Broward_County_1_2015)

Broward_County_1_2015_donut <- data.frame(Broward_County_1_2015_t)
colnames(Broward_County_1_2015_donut) <- c("Value")
Broward_County_1_2015_donut <- Broward_County_1_2015_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_1_2015_donut,"Broward_County_1_2015.csv")


### import as csv (change category and value to the two column names)

Broward_County_1_2015_donut_plot <- read.table("Broward_County_1_2015.csv", header=TRUE, sep=",")


Broward_County_1_2015_donut_plot_rounded <- Broward_County_1_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_1_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_1_2015_donut_plot_test <- cbind(Broward_County_1_2015_donut_plot_rounded,Legend)


Broward_County_1_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 1 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_1_2015.png", width = 6, height = 6)





Broward_County_1_2016 <- filter(Broward_County_1_plot, Year == 2016)
Broward_County_1_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_1_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_1_2016_t <- t(Broward_County_1_2016)

Broward_County_1_2016_donut <- data.frame(Broward_County_1_2016_t)
colnames(Broward_County_1_2016_donut) <- c("Value")
Broward_County_1_2016_donut <- Broward_County_1_2016_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_1_2016_donut,"Broward_County_1_2016.csv")


### import as csv (change category and value to the two column names)

Broward_County_1_2016_donut_plot <- read.table("Broward_County_1_2016.csv", header=TRUE, sep=",")


Broward_County_1_2016_donut_plot_rounded <- Broward_County_1_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_1_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_1_2016_donut_plot_test <- cbind(Broward_County_1_2016_donut_plot_rounded,Legend)


Broward_County_1_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 1 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_1_2016.png", width = 6, height = 6)




Broward_County_2 <- filter(RVC_CREMP, sitename == "Broward County 2")

## Make percentages of sum, stony coral cover, and macroalgae

Broward_County_2_fish <- Broward_County_2$sum/max(Broward_County_2$sum)
Broward_County_2_biomass <- data.frame(Broward_County_2_fish)

Broward_County_2_biomass <- 100*Broward_County_2_biomass


Broward_County_2_Stony <- Broward_County_2$Stony_coral/max(Broward_County_2$Stony_coral)
Broward_County_2_coral <- data.frame(Broward_County_2_Stony)

Broward_County_2_stony_coral <- 100*Broward_County_2_coral

Broward_County_2_macro <- Broward_County_2$Macroalgae/max(Broward_County_2$Macroalgae)
Broward_County_2_algae <- data.frame(Broward_County_2_macro)


Broward_County_2_macroalgae <- (100*Broward_County_2_algae)


Broward_County_2_plot <- cbind(Broward_County_2_macroalgae,Broward_County_2_biomass,Broward_County_2_stony_coral)

Broward_County_2_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Broward_County_2_2013 <- filter(Broward_County_2_plot, Year == 2013)
Broward_County_2_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_2_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_2_2013_t <- t(Broward_County_2_2013)

Broward_County_2_2013_donut <- data.frame(Broward_County_2_2013_t)
colnames(Broward_County_2_2013_donut) <- c("Value")
Broward_County_2_2013_donut <- Broward_County_2_2013_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_2_2013_donut,"Broward_County_2_2013.csv")


### import as csv (change category and value to the two column names)

Broward_County_2_2013_donut_plot <- read.table("Broward_County_2_2013.csv", header=TRUE, sep=",")


Broward_County_2_2013_donut_plot_rounded <- Broward_County_2_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_2_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_2_2013_donut_plot_test <- cbind(Broward_County_2_2013_donut_plot_rounded,Legend)


Broward_County_2_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 2 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_2_2013.png", width = 6, height = 6)





Broward_County_2_2014 <- filter(Broward_County_2_plot, Year == 2014)
Broward_County_2_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_2_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_2_2014_t <- t(Broward_County_2_2014)

Broward_County_2_2014_donut <- data.frame(Broward_County_2_2014_t)
colnames(Broward_County_2_2014_donut) <- c("Value")
Broward_County_2_2014_donut <- Broward_County_2_2014_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_2_2014_donut,"Broward_County_2_2014.csv")


### import as csv (change category and value to the two column names)

Broward_County_2_2014_donut_plot <- read.table("Broward_County_2_2014.csv", header=TRUE, sep=",")


Broward_County_2_2014_donut_plot_rounded <- Broward_County_2_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_2_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_2_2014_donut_plot_test <- cbind(Broward_County_2_2014_donut_plot_rounded,Legend)


Broward_County_2_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 2 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_2_2014.png", width = 6, height = 6)





Broward_County_2_2015 <- filter(Broward_County_2_plot, Year == 2015)
Broward_County_2_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_2_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_2_2015_t <- t(Broward_County_2_2015)

Broward_County_2_2015_donut <- data.frame(Broward_County_2_2015_t)
colnames(Broward_County_2_2015_donut) <- c("Value")
Broward_County_2_2015_donut <- Broward_County_2_2015_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_2_2015_donut,"Broward_County_2_2015.csv")


### import as csv (change category and value to the two column names)

Broward_County_2_2015_donut_plot <- read.table("Broward_County_2_2015.csv", header=TRUE, sep=",")


Broward_County_2_2015_donut_plot_rounded <- Broward_County_2_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_2_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_2_2015_donut_plot_test <- cbind(Broward_County_2_2015_donut_plot_rounded,Legend)


Broward_County_2_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 2 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_2_2015.png", width = 6, height = 6)





Broward_County_2_2016 <- filter(Broward_County_2_plot, Year == 2016)
Broward_County_2_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_2_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_2_2016_t <- t(Broward_County_2_2016)

Broward_County_2_2016_donut <- data.frame(Broward_County_2_2016_t)
colnames(Broward_County_2_2016_donut) <- c("Value")
Broward_County_2_2016_donut <- Broward_County_2_2016_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_2_2016_donut,"Broward_County_2_2016.csv")


### import as csv (change category and value to the two column names)

Broward_County_2_2016_donut_plot <- read.table("Broward_County_2_2016.csv", header=TRUE, sep=",")


Broward_County_2_2016_donut_plot_rounded <- Broward_County_2_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_2_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_2_2016_donut_plot_test <- cbind(Broward_County_2_2016_donut_plot_rounded,Legend)


Broward_County_2_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 2 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_2_2016.png", width = 6, height = 6)



Broward_County_3 <- filter(RVC_CREMP, sitename == "Broward County 3")

## Make percentages of sum, stony coral cover, and macroalgae

Broward_County_3_fish <- Broward_County_3$sum/max(Broward_County_3$sum)
Broward_County_3_biomass <- data.frame(Broward_County_3_fish)

Broward_County_3_biomass <- 100*Broward_County_3_biomass


Broward_County_3_Stony <- Broward_County_3$Stony_coral/max(Broward_County_3$Stony_coral)
Broward_County_3_coral <- data.frame(Broward_County_3_Stony)

Broward_County_3_stony_coral <- 100*Broward_County_3_coral

Broward_County_3_macro <- Broward_County_3$Macroalgae/max(Broward_County_3$Macroalgae)
Broward_County_3_algae <- data.frame(Broward_County_3_macro)


Broward_County_3_macroalgae <- (100*Broward_County_3_algae)


Broward_County_3_plot <- cbind(Broward_County_3_macroalgae,Broward_County_3_biomass,Broward_County_3_stony_coral)

Broward_County_3_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Broward_County_3_2013 <- filter(Broward_County_3_plot, Year == 2013)
Broward_County_3_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_3_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_3_2013_t <- t(Broward_County_3_2013)

Broward_County_3_2013_donut <- data.frame(Broward_County_3_2013_t)
colnames(Broward_County_3_2013_donut) <- c("Value")
Broward_County_3_2013_donut <- Broward_County_3_2013_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_3_2013_donut,"Broward_County_3_2013.csv")


### import as csv (change category and value to the two column names)

Broward_County_3_2013_donut_plot <- read.table("Broward_County_3_2013.csv", header=TRUE, sep=",")


Broward_County_3_2013_donut_plot_rounded <- Broward_County_3_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_3_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_3_2013_donut_plot_test <- cbind(Broward_County_3_2013_donut_plot_rounded,Legend)


Broward_County_3_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 3 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_3_2013.png", width = 6, height = 6)





Broward_County_3_2014 <- filter(Broward_County_3_plot, Year == 2014)
Broward_County_3_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_3_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_3_2014_t <- t(Broward_County_3_2014)

Broward_County_3_2014_donut <- data.frame(Broward_County_3_2014_t)
colnames(Broward_County_3_2014_donut) <- c("Value")
Broward_County_3_2014_donut <- Broward_County_3_2014_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_3_2014_donut,"Broward_County_3_2014.csv")


### import as csv (change category and value to the two column names)

Broward_County_3_2014_donut_plot <- read.table("Broward_County_3_2014.csv", header=TRUE, sep=",")


Broward_County_3_2014_donut_plot_rounded <- Broward_County_3_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_3_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_3_2014_donut_plot_test <- cbind(Broward_County_3_2014_donut_plot_rounded,Legend)


Broward_County_3_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 3 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_3_2014.png", width = 6, height = 6)





Broward_County_3_2015 <- filter(Broward_County_3_plot, Year == 2015)
Broward_County_3_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_3_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_3_2015_t <- t(Broward_County_3_2015)

Broward_County_3_2015_donut <- data.frame(Broward_County_3_2015_t)
colnames(Broward_County_3_2015_donut) <- c("Value")
Broward_County_3_2015_donut <- Broward_County_3_2015_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_3_2015_donut,"Broward_County_3_2015.csv")


### import as csv (change category and value to the two column names)

Broward_County_3_2015_donut_plot <- read.table("Broward_County_3_2015.csv", header=TRUE, sep=",")


Broward_County_3_2015_donut_plot_rounded <- Broward_County_3_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_3_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_3_2015_donut_plot_test <- cbind(Broward_County_3_2015_donut_plot_rounded,Legend)


Broward_County_3_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 3 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_3_2015.png", width = 6, height = 6)





Broward_County_3_2016 <- filter(Broward_County_3_plot, Year == 2016)
Broward_County_3_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_3_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_3_2016_t <- t(Broward_County_3_2016)

Broward_County_3_2016_donut <- data.frame(Broward_County_3_2016_t)
colnames(Broward_County_3_2016_donut) <- c("Value")
Broward_County_3_2016_donut <- Broward_County_3_2016_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_3_2016_donut,"Broward_County_3_2016.csv")


### import as csv (change category and value to the two column names)

Broward_County_3_2016_donut_plot <- read.table("Broward_County_3_2016.csv", header=TRUE, sep=",")


Broward_County_3_2016_donut_plot_rounded <- Broward_County_3_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_3_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_3_2016_donut_plot_test <- cbind(Broward_County_3_2016_donut_plot_rounded,Legend)


Broward_County_3_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County 3 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_3_2016.png", width = 6, height = 6)



Broward_County_A <- filter(RVC_CREMP, sitename == "Broward County A")

## Make percentages of sum, stony coral cover, and macroalgae

Broward_County_A_fish <- Broward_County_A$sum/max(Broward_County_A$sum)
Broward_County_A_biomass <- data.frame(Broward_County_A_fish)

Broward_County_A_biomass <- 100*Broward_County_A_biomass


Broward_County_A_Stony <- Broward_County_A$Stony_coral/max(Broward_County_A$Stony_coral)
Broward_County_A_coral <- data.frame(Broward_County_A_Stony)

Broward_County_A_stony_coral <- 100*Broward_County_A_coral

Broward_County_A_macro <- Broward_County_A$Macroalgae/max(Broward_County_A$Macroalgae)
Broward_County_A_algae <- data.frame(Broward_County_A_macro)


Broward_County_A_macroalgae <- (100*Broward_County_A_algae)


Broward_County_A_plot <- cbind(Broward_County_A_macroalgae,Broward_County_A_biomass,Broward_County_A_stony_coral)

Broward_County_A_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Broward_County_A_2013 <- filter(Broward_County_A_plot, Year == 2013)
Broward_County_A_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_A_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_A_2013_t <- t(Broward_County_A_2013)

Broward_County_A_2013_donut <- data.frame(Broward_County_A_2013_t)
colnames(Broward_County_A_2013_donut) <- c("Value")
Broward_County_A_2013_donut <- Broward_County_A_2013_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_A_2013_donut,"Broward_County_A_2013.csv")


### import as csv (change category and value to the two column names)

Broward_County_A_2013_donut_plot <- read.table("Broward_County_A_2013.csv", header=TRUE, sep=",")


Broward_County_A_2013_donut_plot_rounded <- Broward_County_A_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_A_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_A_2013_donut_plot_test <- cbind(Broward_County_A_2013_donut_plot_rounded,Legend)


Broward_County_A_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County A 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_A_2013.png", width = 6, height = 6)





Broward_County_A_2014 <- filter(Broward_County_A_plot, Year == 2014)
Broward_County_A_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_A_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_A_2014_t <- t(Broward_County_A_2014)

Broward_County_A_2014_donut <- data.frame(Broward_County_A_2014_t)
colnames(Broward_County_A_2014_donut) <- c("Value")
Broward_County_A_2014_donut <- Broward_County_A_2014_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_A_2014_donut,"Broward_County_A_2014.csv")


### import as csv (change category and value to the two column names)

Broward_County_A_2014_donut_plot <- read.table("Broward_County_A_2014.csv", header=TRUE, sep=",")


Broward_County_A_2014_donut_plot_rounded <- Broward_County_A_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_A_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_A_2014_donut_plot_test <- cbind(Broward_County_A_2014_donut_plot_rounded,Legend)


Broward_County_A_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County A 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_A_2014.png", width = 6, height = 6)





Broward_County_A_2015 <- filter(Broward_County_A_plot, Year == 2015)
Broward_County_A_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_A_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_A_2015_t <- t(Broward_County_A_2015)

Broward_County_A_2015_donut <- data.frame(Broward_County_A_2015_t)
colnames(Broward_County_A_2015_donut) <- c("Value")
Broward_County_A_2015_donut <- Broward_County_A_2015_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_A_2015_donut,"Broward_County_A_2015.csv")


### import as csv (change category and value to the two column names)

Broward_County_A_2015_donut_plot <- read.table("Broward_County_A_2015.csv", header=TRUE, sep=",")


Broward_County_A_2015_donut_plot_rounded <- Broward_County_A_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_A_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_A_2015_donut_plot_test <- cbind(Broward_County_A_2015_donut_plot_rounded,Legend)


Broward_County_A_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County A 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_A_2015.png", width = 6, height = 6)





Broward_County_A_2016 <- filter(Broward_County_A_plot, Year == 2016)
Broward_County_A_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Broward_County_A_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_A_2016_t <- t(Broward_County_A_2016)

Broward_County_A_2016_donut <- data.frame(Broward_County_A_2016_t)
colnames(Broward_County_A_2016_donut) <- c("Value")
Broward_County_A_2016_donut <- Broward_County_A_2016_donut %>%
  rownames_to_column(var = "Category")


export(Broward_County_A_2016_donut,"Broward_County_A_2016.csv")


### import as csv (change category and value to the two column names)

Broward_County_A_2016_donut_plot <- read.table("Broward_County_A_2016.csv", header=TRUE, sep=",")


Broward_County_A_2016_donut_plot_rounded <- Broward_County_A_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Broward_County_A_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Broward_County_A_2016_donut_plot_test <- cbind(Broward_County_A_2016_donut_plot_rounded,Legend)


Broward_County_A_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Broward County A 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Broward_County_A_2016.png", width = 6, height = 6)




Dade_County_1 <- filter(RVC_CREMP, sitename == "Dade County 1")

## Make percentages of sum, stony coral cover, and macroalgae

Dade_County_1_fish <- Dade_County_1$sum/max(Dade_County_1$sum)
Dade_County_1_biomass <- data.frame(Dade_County_1_fish)

Dade_County_1_biomass <- 100*Dade_County_1_biomass


Dade_County_1_Stony <- Dade_County_1$Stony_coral/max(Dade_County_1$Stony_coral)
Dade_County_1_coral <- data.frame(Dade_County_1_Stony)

Dade_County_1_stony_coral <- 100*Dade_County_1_coral

Dade_County_1_macro <- Dade_County_1$Macroalgae/max(Dade_County_1$Macroalgae)
Dade_County_1_algae <- data.frame(Dade_County_1_macro)


Dade_County_1_macroalgae <- (100*Dade_County_1_algae)


Dade_County_1_plot <- cbind(Dade_County_1_macroalgae,Dade_County_1_biomass,Dade_County_1_stony_coral)

Dade_County_1_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Dade_County_1_2013 <- filter(Dade_County_1_plot, Year == 2013)
Dade_County_1_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_1_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_1_2013_t <- t(Dade_County_1_2013)

Dade_County_1_2013_donut <- data.frame(Dade_County_1_2013_t)
colnames(Dade_County_1_2013_donut) <- c("Value")
Dade_County_1_2013_donut <- Dade_County_1_2013_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_1_2013_donut,"Dade_County_1_2013.csv")


### import as csv (change category and value to the two column names)

Dade_County_1_2013_donut_plot <- read.table("Dade_County_1_2013.csv", header=TRUE, sep=",")


Dade_County_1_2013_donut_plot_rounded <- Dade_County_1_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_1_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_1_2013_donut_plot_test <- cbind(Dade_County_1_2013_donut_plot_rounded,Legend)


Dade_County_1_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 1 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_1_2013.png", width = 6, height = 6)





Dade_County_1_2014 <- filter(Dade_County_1_plot, Year == 2014)
Dade_County_1_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_1_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_1_2014_t <- t(Dade_County_1_2014)

Dade_County_1_2014_donut <- data.frame(Dade_County_1_2014_t)
colnames(Dade_County_1_2014_donut) <- c("Value")
Dade_County_1_2014_donut <- Dade_County_1_2014_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_1_2014_donut,"Dade_County_1_2014.csv")


### import as csv (change category and value to the two column names)

Dade_County_1_2014_donut_plot <- read.table("Dade_County_1_2014.csv", header=TRUE, sep=",")


Dade_County_1_2014_donut_plot_rounded <- Dade_County_1_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_1_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_1_2014_donut_plot_test <- cbind(Dade_County_1_2014_donut_plot_rounded,Legend)


Dade_County_1_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 1 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_1_2014.png", width = 6, height = 6)





Dade_County_1_2015 <- filter(Dade_County_1_plot, Year == 2015)
Dade_County_1_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_1_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_1_2015_t <- t(Dade_County_1_2015)

Dade_County_1_2015_donut <- data.frame(Dade_County_1_2015_t)
colnames(Dade_County_1_2015_donut) <- c("Value")
Dade_County_1_2015_donut <- Dade_County_1_2015_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_1_2015_donut,"Dade_County_1_2015.csv")


### import as csv (change category and value to the two column names)

Dade_County_1_2015_donut_plot <- read.table("Dade_County_1_2015.csv", header=TRUE, sep=",")


Dade_County_1_2015_donut_plot_rounded <- Dade_County_1_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_1_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_1_2015_donut_plot_test <- cbind(Dade_County_1_2015_donut_plot_rounded,Legend)


Dade_County_1_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 1 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_1_2015.png", width = 6, height = 6)





Dade_County_1_2016 <- filter(Dade_County_1_plot, Year == 2016)
Dade_County_1_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_1_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_1_2016_t <- t(Dade_County_1_2016)

Dade_County_1_2016_donut <- data.frame(Dade_County_1_2016_t)
colnames(Dade_County_1_2016_donut) <- c("Value")
Dade_County_1_2016_donut <- Dade_County_1_2016_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_1_2016_donut,"Dade_County_1_2016.csv")


### import as csv (change category and value to the two column names)

Dade_County_1_2016_donut_plot <- read.table("Dade_County_1_2016.csv", header=TRUE, sep=",")


Dade_County_1_2016_donut_plot_rounded <- Dade_County_1_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_1_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_1_2016_donut_plot_test <- cbind(Dade_County_1_2016_donut_plot_rounded,Legend)


Dade_County_1_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 1 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_1_2016.png", width = 6, height = 6)



Dade_County_2 <- filter(RVC_CREMP, sitename == "Dade County 2")

## Make percentages of sum, stony coral cover, and macroalgae

Dade_County_2_fish <- Dade_County_2$sum/max(Dade_County_2$sum)
Dade_County_2_biomass <- data.frame(Dade_County_2_fish)

Dade_County_2_biomass <- 100*Dade_County_2_biomass


Dade_County_2_Stony <- Dade_County_2$Stony_coral/max(Dade_County_2$Stony_coral)
Dade_County_2_coral <- data.frame(Dade_County_2_Stony)

Dade_County_2_stony_coral <- 100*Dade_County_2_coral

Dade_County_2_macro <- Dade_County_2$Macroalgae/max(Dade_County_2$Macroalgae)
Dade_County_2_algae <- data.frame(Dade_County_2_macro)


Dade_County_2_macroalgae <- (100*Dade_County_2_algae)


Dade_County_2_plot <- cbind(Dade_County_2_macroalgae,Dade_County_2_biomass,Dade_County_2_stony_coral)

Dade_County_2_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Dade_County_2_2013 <- filter(Dade_County_2_plot, Year == 2013)
Dade_County_2_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_2_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_2_2013_t <- t(Dade_County_2_2013)

Dade_County_2_2013_donut <- data.frame(Dade_County_2_2013_t)
colnames(Dade_County_2_2013_donut) <- c("Value")
Dade_County_2_2013_donut <- Dade_County_2_2013_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_2_2013_donut,"Dade_County_2_2013.csv")


### import as csv (change category and value to the two column names)

Dade_County_2_2013_donut_plot <- read.table("Dade_County_2_2013.csv", header=TRUE, sep=",")


Dade_County_2_2013_donut_plot_rounded <- Dade_County_2_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_2_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_2_2013_donut_plot_test <- cbind(Dade_County_2_2013_donut_plot_rounded,Legend)


Dade_County_2_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 2 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_2_2013.png", width = 6, height = 6)





Dade_County_2_2014 <- filter(Dade_County_2_plot, Year == 2014)
Dade_County_2_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_2_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_2_2014_t <- t(Dade_County_2_2014)

Dade_County_2_2014_donut <- data.frame(Dade_County_2_2014_t)
colnames(Dade_County_2_2014_donut) <- c("Value")
Dade_County_2_2014_donut <- Dade_County_2_2014_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_2_2014_donut,"Dade_County_2_2014.csv")


### import as csv (change category and value to the two column names)

Dade_County_2_2014_donut_plot <- read.table("Dade_County_2_2014.csv", header=TRUE, sep=",")


Dade_County_2_2014_donut_plot_rounded <- Dade_County_2_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_2_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_2_2014_donut_plot_test <- cbind(Dade_County_2_2014_donut_plot_rounded,Legend)


Dade_County_2_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 2 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_2_2014.png", width = 6, height = 6)





Dade_County_2_2015 <- filter(Dade_County_2_plot, Year == 2015)
Dade_County_2_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_2_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_2_2015_t <- t(Dade_County_2_2015)

Dade_County_2_2015_donut <- data.frame(Dade_County_2_2015_t)
colnames(Dade_County_2_2015_donut) <- c("Value")
Dade_County_2_2015_donut <- Dade_County_2_2015_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_2_2015_donut,"Dade_County_2_2015.csv")


### import as csv (change category and value to the two column names)

Dade_County_2_2015_donut_plot <- read.table("Dade_County_2_2015.csv", header=TRUE, sep=",")


Dade_County_2_2015_donut_plot_rounded <- Dade_County_2_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_2_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_2_2015_donut_plot_test <- cbind(Dade_County_2_2015_donut_plot_rounded,Legend)


Dade_County_2_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 2 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_2_2015.png", width = 6, height = 6)





Dade_County_2_2016 <- filter(Dade_County_2_plot, Year == 2016)
Dade_County_2_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_2_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_2_2016_t <- t(Dade_County_2_2016)

Dade_County_2_2016_donut <- data.frame(Dade_County_2_2016_t)
colnames(Dade_County_2_2016_donut) <- c("Value")
Dade_County_2_2016_donut <- Dade_County_2_2016_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_2_2016_donut,"Dade_County_2_2016.csv")


### import as csv (change category and value to the two column names)

Dade_County_2_2016_donut_plot <- read.table("Dade_County_2_2016.csv", header=TRUE, sep=",")


Dade_County_2_2016_donut_plot_rounded <- Dade_County_2_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_2_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_2_2016_donut_plot_test <- cbind(Dade_County_2_2016_donut_plot_rounded,Legend)


Dade_County_2_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 2 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_2_2016.png", width = 6, height = 6)




Dade_County_3 <- filter(RVC_CREMP, sitename == "Dade County 3")

## Make percentages of sum, stony coral cover, and macroalgae

Dade_County_3_fish <- Dade_County_3$sum/max(Dade_County_3$sum)
Dade_County_3_biomass <- data.frame(Dade_County_3_fish)

Dade_County_3_biomass <- 100*Dade_County_3_biomass


Dade_County_3_Stony <- Dade_County_3$Stony_coral/max(Dade_County_3$Stony_coral)
Dade_County_3_coral <- data.frame(Dade_County_3_Stony)

Dade_County_3_stony_coral <- 100*Dade_County_3_coral

Dade_County_3_macro <- Dade_County_3$Macroalgae/max(Dade_County_3$Macroalgae)
Dade_County_3_algae <- data.frame(Dade_County_3_macro)


Dade_County_3_macroalgae <- (100*Dade_County_3_algae)


Dade_County_3_plot <- cbind(Dade_County_3_macroalgae,Dade_County_3_biomass,Dade_County_3_stony_coral)

Dade_County_3_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Dade_County_3_2013 <- filter(Dade_County_3_plot, Year == 2013)
Dade_County_3_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_3_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_3_2013_t <- t(Dade_County_3_2013)

Dade_County_3_2013_donut <- data.frame(Dade_County_3_2013_t)
colnames(Dade_County_3_2013_donut) <- c("Value")
Dade_County_3_2013_donut <- Dade_County_3_2013_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_3_2013_donut,"Dade_County_3_2013.csv")


### import as csv (change category and value to the two column names)

Dade_County_3_2013_donut_plot <- read.table("Dade_County_3_2013.csv", header=TRUE, sep=",")


Dade_County_3_2013_donut_plot_rounded <- Dade_County_3_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_3_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_3_2013_donut_plot_test <- cbind(Dade_County_3_2013_donut_plot_rounded,Legend)


Dade_County_3_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 3 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_3_2013.png", width = 6, height = 6)





Dade_County_3_2014 <- filter(Dade_County_3_plot, Year == 2014)
Dade_County_3_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_3_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_3_2014_t <- t(Dade_County_3_2014)

Dade_County_3_2014_donut <- data.frame(Dade_County_3_2014_t)
colnames(Dade_County_3_2014_donut) <- c("Value")
Dade_County_3_2014_donut <- Dade_County_3_2014_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_3_2014_donut,"Dade_County_3_2014.csv")


### import as csv (change category and value to the two column names)

Dade_County_3_2014_donut_plot <- read.table("Dade_County_3_2014.csv", header=TRUE, sep=",")


Dade_County_3_2014_donut_plot_rounded <- Dade_County_3_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_3_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_3_2014_donut_plot_test <- cbind(Dade_County_3_2014_donut_plot_rounded,Legend)


Dade_County_3_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 3 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_3_2014.png", width = 6, height = 6)





Dade_County_3_2015 <- filter(Dade_County_3_plot, Year == 2015)
Dade_County_3_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_3_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_3_2015_t <- t(Dade_County_3_2015)

Dade_County_3_2015_donut <- data.frame(Dade_County_3_2015_t)
colnames(Dade_County_3_2015_donut) <- c("Value")
Dade_County_3_2015_donut <- Dade_County_3_2015_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_3_2015_donut,"Dade_County_3_2015.csv")


### import as csv (change category and value to the two column names)

Dade_County_3_2015_donut_plot <- read.table("Dade_County_3_2015.csv", header=TRUE, sep=",")


Dade_County_3_2015_donut_plot_rounded <- Dade_County_3_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_3_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_3_2015_donut_plot_test <- cbind(Dade_County_3_2015_donut_plot_rounded,Legend)


Dade_County_3_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 3 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_3_2015.png", width = 6, height = 6)





Dade_County_3_2016 <- filter(Dade_County_3_plot, Year == 2016)
Dade_County_3_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Dade_County_3_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_3_2016_t <- t(Dade_County_3_2016)

Dade_County_3_2016_donut <- data.frame(Dade_County_3_2016_t)
colnames(Dade_County_3_2016_donut) <- c("Value")
Dade_County_3_2016_donut <- Dade_County_3_2016_donut %>%
  rownames_to_column(var = "Category")


export(Dade_County_3_2016_donut,"Dade_County_3_2016.csv")


### import as csv (change category and value to the two column names)

Dade_County_3_2016_donut_plot <- read.table("Dade_County_3_2016.csv", header=TRUE, sep=",")


Dade_County_3_2016_donut_plot_rounded <- Dade_County_3_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Dade_County_3_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Dade_County_3_2016_donut_plot_test <- cbind(Dade_County_3_2016_donut_plot_rounded,Legend)


Dade_County_3_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Dade County 3 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Dade_County_3_2016.png", width = 6, height = 6)



Martin_County_1 <- filter(RVC_CREMP, sitename == "Martin County 1")

## Make percentages of sum, stony coral cover, and macroalgae

Martin_County_1_fish <- Martin_County_1$sum/max(Martin_County_1$sum)
Martin_County_1_biomass <- data.frame(Martin_County_1_fish)

Martin_County_1_biomass <- 100*Martin_County_1_biomass


Martin_County_1_Stony <- Martin_County_1$Stony_coral/max(Martin_County_1$Stony_coral)
Martin_County_1_coral <- data.frame(Martin_County_1_Stony)

Martin_County_1_stony_coral <- 100*Martin_County_1_coral

Martin_County_1_macro <- Martin_County_1$Macroalgae/max(Martin_County_1$Macroalgae)
Martin_County_1_algae <- data.frame(Martin_County_1_macro)


Martin_County_1_macroalgae <- (100*Martin_County_1_algae)


Martin_County_1_plot <- cbind(Martin_County_1_macroalgae,Martin_County_1_biomass,Martin_County_1_stony_coral)

Martin_County_1_plot$Year <- c("2014","2015","2016")

### Filter per year


Martin_County_1_2013 <- filter(Martin_County_1_plot, Year == 2013)
Martin_County_1_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Martin_County_1_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_1_2013_t <- t(Martin_County_1_2013)

Martin_County_1_2013_donut <- data.frame(Martin_County_1_2013_t)
colnames(Martin_County_1_2013_donut) <- c("Value")
Martin_County_1_2013_donut <- Martin_County_1_2013_donut %>%
  rownames_to_column(var = "Category")


export(Martin_County_1_2013_donut,"Martin_County_1_2013.csv")


### import as csv (change category and value to the two column names)

Martin_County_1_2013_donut_plot <- read.table("Martin_County_1_2013.csv", header=TRUE, sep=",")


Martin_County_1_2013_donut_plot_rounded <- Martin_County_1_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Martin_County_1_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_1_2013_donut_plot_test <- cbind(Martin_County_1_2013_donut_plot_rounded,Legend)


Martin_County_1_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Martin County 1 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Martin_County_1_2013.png", width = 6, height = 6)





Martin_County_1_2014 <- filter(Martin_County_1_plot, Year == 2014)
Martin_County_1_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Martin_County_1_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_1_2014_t <- t(Martin_County_1_2014)

Martin_County_1_2014_donut <- data.frame(Martin_County_1_2014_t)
colnames(Martin_County_1_2014_donut) <- c("Value")
Martin_County_1_2014_donut <- Martin_County_1_2014_donut %>%
  rownames_to_column(var = "Category")


export(Martin_County_1_2014_donut,"Martin_County_1_2014.csv")


### import as csv (change category and value to the two column names)

Martin_County_1_2014_donut_plot <- read.table("Martin_County_1_2014.csv", header=TRUE, sep=",")


Martin_County_1_2014_donut_plot_rounded <- Martin_County_1_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Martin_County_1_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_1_2014_donut_plot_test <- cbind(Martin_County_1_2014_donut_plot_rounded,Legend)


Martin_County_1_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Martin County 1 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Martin_County_1_2014.png", width = 6, height = 6)





Martin_County_1_2015 <- filter(Martin_County_1_plot, Year == 2015)
Martin_County_1_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Martin_County_1_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_1_2015_t <- t(Martin_County_1_2015)

Martin_County_1_2015_donut <- data.frame(Martin_County_1_2015_t)
colnames(Martin_County_1_2015_donut) <- c("Value")
Martin_County_1_2015_donut <- Martin_County_1_2015_donut %>%
  rownames_to_column(var = "Category")


export(Martin_County_1_2015_donut,"Martin_County_1_2015.csv")


### import as csv (change category and value to the two column names)

Martin_County_1_2015_donut_plot <- read.table("Martin_County_1_2015.csv", header=TRUE, sep=",")


Martin_County_1_2015_donut_plot_rounded <- Martin_County_1_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Martin_County_1_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_1_2015_donut_plot_test <- cbind(Martin_County_1_2015_donut_plot_rounded,Legend)


Martin_County_1_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Martin County 1 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Martin_County_1_2015.png", width = 6, height = 6)





Martin_County_1_2016 <- filter(Martin_County_1_plot, Year == 2016)
Martin_County_1_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Martin_County_1_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_1_2016_t <- t(Martin_County_1_2016)

Martin_County_1_2016_donut <- data.frame(Martin_County_1_2016_t)
colnames(Martin_County_1_2016_donut) <- c("Value")
Martin_County_1_2016_donut <- Martin_County_1_2016_donut %>%
  rownames_to_column(var = "Category")


export(Martin_County_1_2016_donut,"Martin_County_1_2016.csv")


### import as csv (change category and value to the two column names)

Martin_County_1_2016_donut_plot <- read.table("Martin_County_1_2016.csv", header=TRUE, sep=",")


Martin_County_1_2016_donut_plot_rounded <- Martin_County_1_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Martin_County_1_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_1_2016_donut_plot_test <- cbind(Martin_County_1_2016_donut_plot_rounded,Legend)


Martin_County_1_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Martin County 1 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Martin_County_1_2016.png", width = 6, height = 6)




Martin_County_2 <- filter(RVC_CREMP, sitename == "Martin County 2")

## Make percentages of sum, stony coral cover, and macroalgae

Martin_County_2_fish <- Martin_County_2$sum/max(Martin_County_2$sum)
Martin_County_2_biomass <- data.frame(Martin_County_2_fish)

Martin_County_2_biomass <- 100*Martin_County_2_biomass


Martin_County_2_Stony <- Martin_County_2$Stony_coral/max(Martin_County_2$Stony_coral)
Martin_County_2_coral <- data.frame(Martin_County_2_Stony)

Martin_County_2_stony_coral <- 100*Martin_County_2_coral

Martin_County_2_macro <- Martin_County_2$Macroalgae/max(Martin_County_2$Macroalgae)
Martin_County_2_algae <- data.frame(Martin_County_2_macro)


Martin_County_2_macroalgae <- (100*Martin_County_2_algae)


Martin_County_2_plot <- cbind(Martin_County_2_macroalgae,Martin_County_2_biomass,Martin_County_2_stony_coral)

Martin_County_2_plot$Year <- c("2014","2015","2016")

### Filter per year


Martin_County_2_2013 <- filter(Martin_County_2_plot, Year == 2013)
Martin_County_2_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Martin_County_2_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_2_2013_t <- t(Martin_County_2_2013)

Martin_County_2_2013_donut <- data.frame(Martin_County_2_2013_t)
colnames(Martin_County_2_2013_donut) <- c("Value")
Martin_County_2_2013_donut <- Martin_County_2_2013_donut %>%
  rownames_to_column(var = "Category")


export(Martin_County_2_2013_donut,"Martin_County_2_2013.csv")


### import as csv (change category and value to the two column names)

Martin_County_2_2013_donut_plot <- read.table("Martin_County_2_2013.csv", header=TRUE, sep=",")


Martin_County_2_2013_donut_plot_rounded <- Martin_County_2_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Martin_County_2_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_2_2013_donut_plot_test <- cbind(Martin_County_2_2013_donut_plot_rounded,Legend)


Martin_County_2_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Martin County 2 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Martin_County_2_2013.png", width = 6, height = 6)





Martin_County_2_2014 <- filter(Martin_County_2_plot, Year == 2014)
Martin_County_2_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Martin_County_2_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_2_2014_t <- t(Martin_County_2_2014)

Martin_County_2_2014_donut <- data.frame(Martin_County_2_2014_t)
colnames(Martin_County_2_2014_donut) <- c("Value")
Martin_County_2_2014_donut <- Martin_County_2_2014_donut %>%
  rownames_to_column(var = "Category")


export(Martin_County_2_2014_donut,"Martin_County_2_2014.csv")


### import as csv (change category and value to the two column names)

Martin_County_2_2014_donut_plot <- read.table("Martin_County_2_2014.csv", header=TRUE, sep=",")


Martin_County_2_2014_donut_plot_rounded <- Martin_County_2_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Martin_County_2_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_2_2014_donut_plot_test <- cbind(Martin_County_2_2014_donut_plot_rounded,Legend)


Martin_County_2_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Martin County 2 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Martin_County_2_2014.png", width = 6, height = 6)





Martin_County_2_2015 <- filter(Martin_County_2_plot, Year == 2015)
Martin_County_2_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Martin_County_2_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_2_2015_t <- t(Martin_County_2_2015)

Martin_County_2_2015_donut <- data.frame(Martin_County_2_2015_t)
colnames(Martin_County_2_2015_donut) <- c("Value")
Martin_County_2_2015_donut <- Martin_County_2_2015_donut %>%
  rownames_to_column(var = "Category")


export(Martin_County_2_2015_donut,"Martin_County_2_2015.csv")


### import as csv (change category and value to the two column names)

Martin_County_2_2015_donut_plot <- read.table("Martin_County_2_2015.csv", header=TRUE, sep=",")


Martin_County_2_2015_donut_plot_rounded <- Martin_County_2_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Martin_County_2_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_2_2015_donut_plot_test <- cbind(Martin_County_2_2015_donut_plot_rounded,Legend)


Martin_County_2_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Martin County 2 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Martin_County_2_2015.png", width = 6, height = 6)





Martin_County_2_2016 <- filter(Martin_County_2_plot, Year == 2016)
Martin_County_2_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Martin_County_2_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_2_2016_t <- t(Martin_County_2_2016)

Martin_County_2_2016_donut <- data.frame(Martin_County_2_2016_t)
colnames(Martin_County_2_2016_donut) <- c("Value")
Martin_County_2_2016_donut <- Martin_County_2_2016_donut %>%
  rownames_to_column(var = "Category")


export(Martin_County_2_2016_donut,"Martin_County_2_2016.csv")


### import as csv (change category and value to the two column names)

Martin_County_2_2016_donut_plot <- read.table("Martin_County_2_2016.csv", header=TRUE, sep=",")


Martin_County_2_2016_donut_plot_rounded <- Martin_County_2_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Martin_County_2_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Martin_County_2_2016_donut_plot_test <- cbind(Martin_County_2_2016_donut_plot_rounded,Legend)


Martin_County_2_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Martin County 2 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Martin_County_2_2016.png", width = 6, height = 6)




Palm_Beach_1<- filter(RVC_CREMP, sitename == "Palm Beach 1")

## Make percentages of sum, stony coral cover, and macroalgae

Palm_Beach_1_fish <- Palm_Beach_1$sum/max(Palm_Beach_1$sum)
Palm_Beach_1_biomass <- data.frame(Palm_Beach_1_fish)

Palm_Beach_1_biomass <- 100*Palm_Beach_1_biomass


Palm_Beach_1_Stony <- Palm_Beach_1$Stony_coral/max(Palm_Beach_1$Stony_coral)
Palm_Beach_1_coral <- data.frame(Palm_Beach_1_Stony)

Palm_Beach_1_stony_coral <- 100*Palm_Beach_1_coral

Palm_Beach_1_macro <- Palm_Beach_1$Macroalgae/max(Palm_Beach_1$Macroalgae)
Palm_Beach_1_algae <- data.frame(Palm_Beach_1_macro)


Palm_Beach_1_macroalgae <- (100*Palm_Beach_1_algae)


Palm_Beach_1_plot <- cbind(Palm_Beach_1_macroalgae,Palm_Beach_1_biomass,Palm_Beach_1_stony_coral)

Palm_Beach_1_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Palm_Beach_1_2013 <- filter(Palm_Beach_1_plot, Year == 2013)
Palm_Beach_1_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_1_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_1_2013_t <- t(Palm_Beach_1_2013)

Palm_Beach_1_2013_donut <- data.frame(Palm_Beach_1_2013_t)
colnames(Palm_Beach_1_2013_donut) <- c("Value")
Palm_Beach_1_2013_donut <- Palm_Beach_1_2013_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_1_2013_donut,"Palm_Beach_1_2013.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_1_2013_donut_plot <- read.table("Palm_Beach_1_2013.csv", header=TRUE, sep=",")


Palm_Beach_1_2013_donut_plot_rounded <- Palm_Beach_1_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_1_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_1_2013_donut_plot_test <- cbind(Palm_Beach_1_2013_donut_plot_rounded,Legend)


Palm_Beach_1_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 1 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_1_2013.png", width = 6, height = 6)





Palm_Beach_1_2014 <- filter(Palm_Beach_1_plot, Year == 2014)
Palm_Beach_1_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_1_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_1_2014_t <- t(Palm_Beach_1_2014)

Palm_Beach_1_2014_donut <- data.frame(Palm_Beach_1_2014_t)
colnames(Palm_Beach_1_2014_donut) <- c("Value")
Palm_Beach_1_2014_donut <- Palm_Beach_1_2014_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_1_2014_donut,"Palm_Beach_1_2014.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_1_2014_donut_plot <- read.table("Palm_Beach_1_2014.csv", header=TRUE, sep=",")


Palm_Beach_1_2014_donut_plot_rounded <- Palm_Beach_1_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_1_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_1_2014_donut_plot_test <- cbind(Palm_Beach_1_2014_donut_plot_rounded,Legend)


Palm_Beach_1_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 1 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_1_2014.png", width = 6, height = 6)





Palm_Beach_1_2015 <- filter(Palm_Beach_1_plot, Year == 2015)
Palm_Beach_1_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_1_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_1_2015_t <- t(Palm_Beach_1_2015)

Palm_Beach_1_2015_donut <- data.frame(Palm_Beach_1_2015_t)
colnames(Palm_Beach_1_2015_donut) <- c("Value")
Palm_Beach_1_2015_donut <- Palm_Beach_1_2015_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_1_2015_donut,"Palm_Beach_1_2015.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_1_2015_donut_plot <- read.table("Palm_Beach_1_2015.csv", header=TRUE, sep=",")


Palm_Beach_1_2015_donut_plot_rounded <- Palm_Beach_1_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_1_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_1_2015_donut_plot_test <- cbind(Palm_Beach_1_2015_donut_plot_rounded,Legend)


Palm_Beach_1_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 1 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_1_2015.png", width = 6, height = 6)





Palm_Beach_1_2016 <- filter(Palm_Beach_1_plot, Year == 2016)
Palm_Beach_1_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_1_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_1_2016_t <- t(Palm_Beach_1_2016)

Palm_Beach_1_2016_donut <- data.frame(Palm_Beach_1_2016_t)
colnames(Palm_Beach_1_2016_donut) <- c("Value")
Palm_Beach_1_2016_donut <- Palm_Beach_1_2016_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_1_2016_donut,"Palm_Beach_1_2016.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_1_2016_donut_plot <- read.table("Palm_Beach_1_2016.csv", header=TRUE, sep=",")


Palm_Beach_1_2016_donut_plot_rounded <- Palm_Beach_1_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_1_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_1_2016_donut_plot_test <- cbind(Palm_Beach_1_2016_donut_plot_rounded,Legend)


Palm_Beach_1_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 1 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_1_2016.png", width = 6, height = 6)







Palm_Beach_2<- filter(RVC_CREMP, sitename == "Palm Beach 2")

## Make percentages of sum, stony coral cover, and macroalgae

Palm_Beach_2_fish <- Palm_Beach_2$sum/max(Palm_Beach_2$sum)
Palm_Beach_2_biomass <- data.frame(Palm_Beach_2_fish)

Palm_Beach_2_biomass <- 100*Palm_Beach_2_biomass


Palm_Beach_2_Stony <- Palm_Beach_2$Stony_coral/max(Palm_Beach_2$Stony_coral)
Palm_Beach_2_coral <- data.frame(Palm_Beach_2_Stony)

Palm_Beach_2_stony_coral <- 100*Palm_Beach_2_coral

Palm_Beach_2_macro <- Palm_Beach_2$Macroalgae/max(Palm_Beach_2$Macroalgae)
Palm_Beach_2_algae <- data.frame(Palm_Beach_2_macro)


Palm_Beach_2_macroalgae <- (100*Palm_Beach_2_algae)


Palm_Beach_2_plot <- cbind(Palm_Beach_2_macroalgae,Palm_Beach_2_biomass,Palm_Beach_2_stony_coral)

Palm_Beach_2_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Palm_Beach_2_2013 <- filter(Palm_Beach_2_plot, Year == 2013)
Palm_Beach_2_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_2_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_2_2013_t <- t(Palm_Beach_2_2013)

Palm_Beach_2_2013_donut <- data.frame(Palm_Beach_2_2013_t)
colnames(Palm_Beach_2_2013_donut) <- c("Value")
Palm_Beach_2_2013_donut <- Palm_Beach_2_2013_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_2_2013_donut,"Palm_Beach_2_2013.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_2_2013_donut_plot <- read.table("Palm_Beach_2_2013.csv", header=TRUE, sep=",")


Palm_Beach_2_2013_donut_plot_rounded <- Palm_Beach_2_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_2_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_2_2013_donut_plot_test <- cbind(Palm_Beach_2_2013_donut_plot_rounded,Legend)


Palm_Beach_2_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 2 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_2_2013.png", width = 6, height = 6)





Palm_Beach_2_2014 <- filter(Palm_Beach_2_plot, Year == 2014)
Palm_Beach_2_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_2_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_2_2014_t <- t(Palm_Beach_2_2014)

Palm_Beach_2_2014_donut <- data.frame(Palm_Beach_2_2014_t)
colnames(Palm_Beach_2_2014_donut) <- c("Value")
Palm_Beach_2_2014_donut <- Palm_Beach_2_2014_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_2_2014_donut,"Palm_Beach_2_2014.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_2_2014_donut_plot <- read.table("Palm_Beach_2_2014.csv", header=TRUE, sep=",")


Palm_Beach_2_2014_donut_plot_rounded <- Palm_Beach_2_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_2_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_2_2014_donut_plot_test <- cbind(Palm_Beach_2_2014_donut_plot_rounded,Legend)


Palm_Beach_2_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 2 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_2_2014.png", width = 6, height = 6)





Palm_Beach_2_2015 <- filter(Palm_Beach_2_plot, Year == 2015)
Palm_Beach_2_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_2_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_2_2015_t <- t(Palm_Beach_2_2015)

Palm_Beach_2_2015_donut <- data.frame(Palm_Beach_2_2015_t)
colnames(Palm_Beach_2_2015_donut) <- c("Value")
Palm_Beach_2_2015_donut <- Palm_Beach_2_2015_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_2_2015_donut,"Palm_Beach_2_2015.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_2_2015_donut_plot <- read.table("Palm_Beach_2_2015.csv", header=TRUE, sep=",")


Palm_Beach_2_2015_donut_plot_rounded <- Palm_Beach_2_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_2_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_2_2015_donut_plot_test <- cbind(Palm_Beach_2_2015_donut_plot_rounded,Legend)


Palm_Beach_2_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 2 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_2_2015.png", width = 6, height = 6)





Palm_Beach_2_2016 <- filter(Palm_Beach_2_plot, Year == 2016)
Palm_Beach_2_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_2_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_2_2016_t <- t(Palm_Beach_2_2016)

Palm_Beach_2_2016_donut <- data.frame(Palm_Beach_2_2016_t)
colnames(Palm_Beach_2_2016_donut) <- c("Value")
Palm_Beach_2_2016_donut <- Palm_Beach_2_2016_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_2_2016_donut,"Palm_Beach_2_2016.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_2_2016_donut_plot <- read.table("Palm_Beach_2_2016.csv", header=TRUE, sep=",")


Palm_Beach_2_2016_donut_plot_rounded <- Palm_Beach_2_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_2_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_2_2016_donut_plot_test <- cbind(Palm_Beach_2_2016_donut_plot_rounded,Legend)


Palm_Beach_2_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 2 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_2_2016.png", width = 6, height = 6)




Palm_Beach_3<- filter(RVC_CREMP, sitename == "Palm Beach 3")

## Make percentages of sum, stony coral cover, and macroalgae

Palm_Beach_3_fish <- Palm_Beach_3$sum/max(Palm_Beach_3$sum)
Palm_Beach_3_biomass <- data.frame(Palm_Beach_3_fish)

Palm_Beach_3_biomass <- 100*Palm_Beach_3_biomass


Palm_Beach_3_Stony <- Palm_Beach_3$Stony_coral/max(Palm_Beach_3$Stony_coral)
Palm_Beach_3_coral <- data.frame(Palm_Beach_3_Stony)

Palm_Beach_3_stony_coral <- 100*Palm_Beach_3_coral

Palm_Beach_3_macro <- Palm_Beach_3$Macroalgae/max(Palm_Beach_3$Macroalgae)
Palm_Beach_3_algae <- data.frame(Palm_Beach_3_macro)


Palm_Beach_3_macroalgae <- (100*Palm_Beach_3_algae)


Palm_Beach_3_plot <- cbind(Palm_Beach_3_macroalgae,Palm_Beach_3_biomass,Palm_Beach_3_stony_coral)

Palm_Beach_3_plot$Year <- c("2013","2014","2015","2016")

### Filter per year


Palm_Beach_3_2013 <- filter(Palm_Beach_3_plot, Year == 2013)
Palm_Beach_3_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_3_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_3_2013_t <- t(Palm_Beach_3_2013)

Palm_Beach_3_2013_donut <- data.frame(Palm_Beach_3_2013_t)
colnames(Palm_Beach_3_2013_donut) <- c("Value")
Palm_Beach_3_2013_donut <- Palm_Beach_3_2013_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_3_2013_donut,"Palm_Beach_3_2013.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_3_2013_donut_plot <- read.table("Palm_Beach_3_2013.csv", header=TRUE, sep=",")


Palm_Beach_3_2013_donut_plot_rounded <- Palm_Beach_3_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_3_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_3_2013_donut_plot_test <- cbind(Palm_Beach_3_2013_donut_plot_rounded,Legend)


Palm_Beach_3_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 3 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_3_2013.png", width = 6, height = 6)





Palm_Beach_3_2014 <- filter(Palm_Beach_3_plot, Year == 2014)
Palm_Beach_3_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_3_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_3_2014_t <- t(Palm_Beach_3_2014)

Palm_Beach_3_2014_donut <- data.frame(Palm_Beach_3_2014_t)
colnames(Palm_Beach_3_2014_donut) <- c("Value")
Palm_Beach_3_2014_donut <- Palm_Beach_3_2014_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_3_2014_donut,"Palm_Beach_3_2014.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_3_2014_donut_plot <- read.table("Palm_Beach_3_2014.csv", header=TRUE, sep=",")


Palm_Beach_3_2014_donut_plot_rounded <- Palm_Beach_3_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_3_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_3_2014_donut_plot_test <- cbind(Palm_Beach_3_2014_donut_plot_rounded,Legend)


Palm_Beach_3_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 3 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_3_2014.png", width = 6, height = 6)





Palm_Beach_3_2015 <- filter(Palm_Beach_3_plot, Year == 2015)
Palm_Beach_3_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_3_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_3_2015_t <- t(Palm_Beach_3_2015)

Palm_Beach_3_2015_donut <- data.frame(Palm_Beach_3_2015_t)
colnames(Palm_Beach_3_2015_donut) <- c("Value")
Palm_Beach_3_2015_donut <- Palm_Beach_3_2015_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_3_2015_donut,"Palm_Beach_3_2015.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_3_2015_donut_plot <- read.table("Palm_Beach_3_2015.csv", header=TRUE, sep=",")


Palm_Beach_3_2015_donut_plot_rounded <- Palm_Beach_3_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_3_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_3_2015_donut_plot_test <- cbind(Palm_Beach_3_2015_donut_plot_rounded,Legend)


Palm_Beach_3_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 3 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_3_2015.png", width = 6, height = 6)





Palm_Beach_3_2016 <- filter(Palm_Beach_3_plot, Year == 2016)
Palm_Beach_3_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_3_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_3_2016_t <- t(Palm_Beach_3_2016)

Palm_Beach_3_2016_donut <- data.frame(Palm_Beach_3_2016_t)
colnames(Palm_Beach_3_2016_donut) <- c("Value")
Palm_Beach_3_2016_donut <- Palm_Beach_3_2016_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_3_2016_donut,"Palm_Beach_3_2016.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_3_2016_donut_plot <- read.table("Palm_Beach_3_2016.csv", header=TRUE, sep=",")


Palm_Beach_3_2016_donut_plot_rounded <- Palm_Beach_3_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_3_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_3_2016_donut_plot_test <- cbind(Palm_Beach_3_2016_donut_plot_rounded,Legend)


Palm_Beach_3_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 3 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_3_2016.png", width = 6, height = 6)





Palm_Beach_4<- filter(RVC_CREMP, sitename == "Palm Beach 4")

## Make percentages of sum, stony coral cover, and macroalgae

Palm_Beach_4_fish <- Palm_Beach_4$sum/max(Palm_Beach_4$sum)
Palm_Beach_4_biomass <- data.frame(Palm_Beach_4_fish)

Palm_Beach_4_biomass <- 100*Palm_Beach_4_biomass


Palm_Beach_4_Stony <- Palm_Beach_4$Stony_coral/max(Palm_Beach_4$Stony_coral)
Palm_Beach_4_coral <- data.frame(Palm_Beach_4_Stony)

Palm_Beach_4_stony_coral <- 100*Palm_Beach_4_coral

Palm_Beach_4_macro <- Palm_Beach_4$Macroalgae/max(Palm_Beach_4$Macroalgae)
Palm_Beach_4_algae <- data.frame(Palm_Beach_4_macro)


Palm_Beach_4_macroalgae <- (100*Palm_Beach_4_algae)


Palm_Beach_4_plot <- cbind(Palm_Beach_4_macroalgae,Palm_Beach_4_biomass,Palm_Beach_4_stony_coral)

Palm_Beach_4_plot$Year <- c("2014","2015","2016")

### Filter per year


Palm_Beach_4_2013 <- filter(Palm_Beach_4_plot, Year == 2013)
Palm_Beach_4_2013$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_4_2013) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_4_2013_t <- t(Palm_Beach_4_2013)

Palm_Beach_4_2013_donut <- data.frame(Palm_Beach_4_2013_t)
colnames(Palm_Beach_4_2013_donut) <- c("Value")
Palm_Beach_4_2013_donut <- Palm_Beach_4_2013_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_4_2013_donut,"Palm_Beach_4_2013.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_4_2013_donut_plot <- read.table("Palm_Beach_4_2013.csv", header=TRUE, sep=",")


Palm_Beach_4_2013_donut_plot_rounded <- Palm_Beach_4_2013_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_4_2013_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_4_2013_donut_plot_test <- cbind(Palm_Beach_4_2013_donut_plot_rounded,Legend)


Palm_Beach_4_2013_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 4 2013") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

#ggsave ("plots/Palm_Beach_4_2013.png", width = 6, height = 6)





Palm_Beach_4_2014 <- filter(Palm_Beach_4_plot, Year == 2014)
Palm_Beach_4_2014$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_4_2014) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_4_2014_t <- t(Palm_Beach_4_2014)

Palm_Beach_4_2014_donut <- data.frame(Palm_Beach_4_2014_t)
colnames(Palm_Beach_4_2014_donut) <- c("Value")
Palm_Beach_4_2014_donut <- Palm_Beach_4_2014_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_4_2014_donut,"Palm_Beach_4_2014.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_4_2014_donut_plot <- read.table("Palm_Beach_4_2014.csv", header=TRUE, sep=",")


Palm_Beach_4_2014_donut_plot_rounded <- Palm_Beach_4_2014_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_4_2014_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_4_2014_donut_plot_test <- cbind(Palm_Beach_4_2014_donut_plot_rounded,Legend)


Palm_Beach_4_2014_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 4 2014") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_4_2014.png", width = 6, height = 6)





Palm_Beach_4_2015 <- filter(Palm_Beach_4_plot, Year == 2015)
Palm_Beach_4_2015$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_4_2015) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_4_2015_t <- t(Palm_Beach_4_2015)

Palm_Beach_4_2015_donut <- data.frame(Palm_Beach_4_2015_t)
colnames(Palm_Beach_4_2015_donut) <- c("Value")
Palm_Beach_4_2015_donut <- Palm_Beach_4_2015_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_4_2015_donut,"Palm_Beach_4_2015.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_4_2015_donut_plot <- read.table("Palm_Beach_4_2015.csv", header=TRUE, sep=",")


Palm_Beach_4_2015_donut_plot_rounded <- Palm_Beach_4_2015_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_4_2015_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_4_2015_donut_plot_test <- cbind(Palm_Beach_4_2015_donut_plot_rounded,Legend)


Palm_Beach_4_2015_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 4 2015") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_4_2015.png", width = 6, height = 6)





Palm_Beach_4_2016 <- filter(Palm_Beach_4_plot, Year == 2016)
Palm_Beach_4_2016$Year <- NULL


### Donut Plot

## manipulate data

colnames(Palm_Beach_4_2016) <- c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_4_2016_t <- t(Palm_Beach_4_2016)

Palm_Beach_4_2016_donut <- data.frame(Palm_Beach_4_2016_t)
colnames(Palm_Beach_4_2016_donut) <- c("Value")
Palm_Beach_4_2016_donut <- Palm_Beach_4_2016_donut %>%
  rownames_to_column(var = "Category")


export(Palm_Beach_4_2016_donut,"Palm_Beach_4_2016.csv")


### import as csv (change category and value to the two column names)

Palm_Beach_4_2016_donut_plot <- read.table("Palm_Beach_4_2016.csv", header=TRUE, sep=",")


Palm_Beach_4_2016_donut_plot_rounded <- Palm_Beach_4_2016_donut_plot %>%
  mutate_if(is.numeric,round,digits = 0)
Palm_Beach_4_2016_donut_plot_rounded


# plot

## This allows the columns to be different colors and the legend variables

Legend = c("Macroalgae","Fish Biomass","Stony Coral")
Palm_Beach_4_2016_donut_plot_test <- cbind(Palm_Beach_4_2016_donut_plot_rounded,Legend)


Palm_Beach_4_2016_donut_plot_test %>%
  filter(!is.na(Value)) %>%
  arrange(Value) %>%
  tail(6) %>%
  mutate(Category=factor(Category, Category)) %>%
  ggplot( aes(x=Category, y=Value, fill = Legend) )+ ggtitle("Coral Health Index", subtitle = "Palm Beach 4 2016") +
  geom_bar(show.legend = TRUE, stat="identity") +
  scale_fill_manual("Legend", values = c("Macroalgae"="forestgreen","Fish Biomass"="dodgerblue","Stony Coral"="indianred1"))+
  geom_text(hjust = 1, size = 5, aes( y = 0, label = paste(Value,"%"))) +
  theme_ipsum() +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    legend.position="bottom",
    legend.background = element_blank(),
    legend.box.background = element_rect(colour = "black"),
    legend.text = element_text(size = 10),
    axis.text = element_blank()
  ) +
  xlab("") +
  ylab("") +
  coord_polar(theta = "y") +
  ylim(0,100)

ggsave ("plots/Palm_Beach_4_2016.png", width = 6, height = 6)




setwd("C:/Users/cestes/Documents/Spring_2020/CREMP_RVC/Donut/SEF/plots")


library(gridExtra)
library(png)
library(grid)

pdf('SEF.pdf')
lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  grid.newpage()
  grid.raster(img, interpolate = FALSE)
  
})
dev.off()

plots <- lapply(ll <- list.files(patt='.*[.]png'),function(x){
  img <- as.raster(readPNG(x))
  rasterGrob(img, interpolate = FALSE)
})

ggsave("SEF_combined.pdf", marrangeGrob(grobs=plots, nrow=2, ncol=4))


